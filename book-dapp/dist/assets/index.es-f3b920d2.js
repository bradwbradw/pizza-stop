import{g as Zn,d as ie,e as P_,w as Xl,f as Zl,h as Ac,t as vo,i as O_,a as ef,j as mi,D as R_,k as T_,N as ee,l as C_,m as hc,n as A_,V as $_,R as N_,F as Bh,K as D_,x as F_,L as j_,o as kh,$ as L_,p as q_,q as Kn,Z as Vh,J as M_,X as U_,_ as tf,s as Nr,u as z_,v as H_,y as cn,z as Nt,U as er,A as _i,B as cr,C as B_,E as un,G as rf,H as k_,I as V_,M as K_,O as nf,P as G_,Q as sf,S as of,T as ln,W as lc,Y as ho,a0 as fn,a1 as W_,a2 as lo,a3 as J_,a4 as Q_,a5 as Y_,a6 as oo,a7 as X_,a8 as Z_,a9 as Wa,aa as Kh,ab as em,ac as tm,ad as rm,ae as Gh,af as im,ag as nm,ah as sm,ai as om,aj as am,ak as cm,al as um,am as Bn,an as af,ao as Ja,ap as hm,aq as lm}from"./index-618ce91c.js";import{e as Pr,H as $c}from"./events-50bcbcca.js";var _o={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var fc=function(a,r){return fc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},fc(a,r)};function fm(a,r){fc(a,r);function t(){this.constructor=a}a.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var pc=function(){return pc=Object.assign||function(r){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(r[c]=t[c])}return r},pc.apply(this,arguments)};function pm(a,r){var t={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(t[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(a);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(a,n[s])&&(t[n[s]]=a[n[s]]);return t}function dm(a,r,t,n){var s=arguments.length,c=s<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,r,t,n);else for(var d=a.length-1;d>=0;d--)(l=a[d])&&(c=(s<3?l(c):s>3?l(r,t,c):l(r,t))||c);return s>3&&c&&Object.defineProperty(r,t,c),c}function gm(a,r){return function(t,n){r(t,n,a)}}function ym(a,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,r)}function vm(a,r,t,n){function s(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function d(S){try{y(n.next(S))}catch(L){l(L)}}function _(S){try{y(n.throw(S))}catch(L){l(L)}}function y(S){S.done?c(S.value):s(S.value).then(d,_)}y((n=n.apply(a,r||[])).next())})}function _m(a,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,l;return l={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function d(y){return function(S){return _([y,S])}}function _(y){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(c=y[0]&2?s.return:y[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,y[1])).done)return c;switch(s=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,s=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=r.call(a,t)}catch(S){y=[6,S],s=0}finally{n=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function mm(a,r,t,n){n===void 0&&(n=t),a[n]=r[t]}function wm(a,r){for(var t in a)t!=="default"&&!r.hasOwnProperty(t)&&(r[t]=a[t])}function dc(a){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&a[r],n=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function cf(a,r){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var n=t.call(a),s,c=[],l;try{for(;(r===void 0||r-- >0)&&!(s=n.next()).done;)c.push(s.value)}catch(d){l={error:d}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(l)throw l.error}}return c}function bm(){for(var a=[],r=0;r<arguments.length;r++)a=a.concat(cf(arguments[r]));return a}function Em(){for(var a=0,r=0,t=arguments.length;r<t;r++)a+=arguments[r].length;for(var n=Array(a),s=0,r=0;r<t;r++)for(var c=arguments[r],l=0,d=c.length;l<d;l++,s++)n[s]=c[l];return n}function Gn(a){return this instanceof Gn?(this.v=a,this):new Gn(a)}function xm(a,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(a,r||[]),s,c=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(R){n[R]&&(s[R]=function(F){return new Promise(function(H,K){c.push([R,F,H,K])>1||d(R,F)})})}function d(R,F){try{_(n[R](F))}catch(H){L(c[0][3],H)}}function _(R){R.value instanceof Gn?Promise.resolve(R.value.v).then(y,S):L(c[0][2],R)}function y(R){d("next",R)}function S(R){d("throw",R)}function L(R,F){R(F),c.shift(),c.length&&d(c[0][0],c[0][1])}}function Im(a){var r,t;return r={},n("next"),n("throw",function(s){throw s}),n("return"),r[Symbol.iterator]=function(){return this},r;function n(s,c){r[s]=a[s]?function(l){return(t=!t)?{value:Gn(a[s](l)),done:s==="return"}:c?c(l):l}:c}}function Sm(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a[Symbol.asyncIterator],t;return r?r.call(a):(a=typeof dc=="function"?dc(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(c){t[c]=a[c]&&function(l){return new Promise(function(d,_){l=a[c](l),s(d,_,l.done,l.value)})}}function s(c,l,d,_){Promise.resolve(_).then(function(y){c({value:y,done:d})},l)}}function Pm(a,r){return Object.defineProperty?Object.defineProperty(a,"raw",{value:r}):a.raw=r,a}function Om(a){if(a&&a.__esModule)return a;var r={};if(a!=null)for(var t in a)Object.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return r.default=a,r}function Rm(a){return a&&a.__esModule?a:{default:a}}function Tm(a,r){if(!r.has(a))throw new TypeError("attempted to get private field on non-instance");return r.get(a)}function Cm(a,r,t){if(!r.has(a))throw new TypeError("attempted to set private field on non-instance");return r.set(a,t),t}const Am=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return pc},__asyncDelegator:Im,__asyncGenerator:xm,__asyncValues:Sm,__await:Gn,__awaiter:vm,__classPrivateFieldGet:Tm,__classPrivateFieldSet:Cm,__createBinding:mm,__decorate:dm,__exportStar:wm,__extends:fm,__generator:_m,__importDefault:Rm,__importStar:Om,__makeTemplateObject:Pm,__metadata:ym,__param:gm,__read:cf,__rest:pm,__spread:bm,__spreadArrays:Em,__values:dc},Symbol.toStringTag,{value:"Module"})),uf=Zn(Am);var es={};Object.defineProperty(es,"__esModule",{value:!0});function $m(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return JSON.parse(a)}catch{return a}}es.safeJsonParse=$m;function Nm(a){return typeof a=="string"?a:JSON.stringify(a,(r,t)=>typeof t>"u"?null:t)}es.safeJsonStringify=Nm;var Nn={exports:{}},Wh;function Dm(){return Wh||(Wh=1,function(){let a;function r(){}a=r,a.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},a.prototype.setItem=function(t,n){this[t]=String(n)},a.prototype.removeItem=function(t){delete this[t]},a.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(n){t[n]=void 0,delete t[n]})},a.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},a.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof globalThis<"u"&&globalThis.localStorage?Nn.exports=globalThis.localStorage:typeof window<"u"&&window.localStorage?Nn.exports=window.localStorage:Nn.exports=new r}()),Nn.exports}var Qa={},Dn={},Jh;function Fm(){if(Jh)return Dn;Jh=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.IKeyValueStorage=void 0;class a{}return Dn.IKeyValueStorage=a,Dn}var Fn={},Qh;function jm(){if(Qh)return Fn;Qh=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.parseEntry=void 0;const a=es;function r(t){var n;return[t[0],a.safeJsonParse((n=t[1])!==null&&n!==void 0?n:"")]}return Fn.parseEntry=r,Fn}var Yh;function Lm(){return Yh||(Yh=1,function(a){Object.defineProperty(a,"__esModule",{value:!0});const r=uf;r.__exportStar(Fm(),a),r.__exportStar(jm(),a)}(Qa)),Qa}Object.defineProperty(_o,"__esModule",{value:!0});_o.KeyValueStorage=void 0;const hn=uf,Xh=es,qm=hn.__importDefault(Dm()),Mm=Lm();class hf{constructor(){this.localStorage=qm.default}getKeys(){return hn.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return hn.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Mm.parseEntry)})}getItem(r){return hn.__awaiter(this,void 0,void 0,function*(){const t=this.localStorage.getItem(r);if(t!==null)return Xh.safeJsonParse(t)})}setItem(r,t){return hn.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(r,Xh.safeJsonStringify(t))})}removeItem(r){return hn.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(r)})}}_o.KeyValueStorage=hf;var Um=_o.default=hf,pn={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var gc=function(a,r){return gc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},gc(a,r)};function zm(a,r){gc(a,r);function t(){this.constructor=a}a.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var yc=function(){return yc=Object.assign||function(r){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(r[c]=t[c])}return r},yc.apply(this,arguments)};function Hm(a,r){var t={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(t[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(a);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(a,n[s])&&(t[n[s]]=a[n[s]]);return t}function Bm(a,r,t,n){var s=arguments.length,c=s<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,r,t,n);else for(var d=a.length-1;d>=0;d--)(l=a[d])&&(c=(s<3?l(c):s>3?l(r,t,c):l(r,t))||c);return s>3&&c&&Object.defineProperty(r,t,c),c}function km(a,r){return function(t,n){r(t,n,a)}}function Vm(a,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,r)}function Km(a,r,t,n){function s(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function d(S){try{y(n.next(S))}catch(L){l(L)}}function _(S){try{y(n.throw(S))}catch(L){l(L)}}function y(S){S.done?c(S.value):s(S.value).then(d,_)}y((n=n.apply(a,r||[])).next())})}function Gm(a,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,l;return l={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function d(y){return function(S){return _([y,S])}}function _(y){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(c=y[0]&2?s.return:y[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,y[1])).done)return c;switch(s=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,s=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=r.call(a,t)}catch(S){y=[6,S],s=0}finally{n=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function Wm(a,r,t,n){n===void 0&&(n=t),a[n]=r[t]}function Jm(a,r){for(var t in a)t!=="default"&&!r.hasOwnProperty(t)&&(r[t]=a[t])}function vc(a){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&a[r],n=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function lf(a,r){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var n=t.call(a),s,c=[],l;try{for(;(r===void 0||r-- >0)&&!(s=n.next()).done;)c.push(s.value)}catch(d){l={error:d}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(l)throw l.error}}return c}function Qm(){for(var a=[],r=0;r<arguments.length;r++)a=a.concat(lf(arguments[r]));return a}function Ym(){for(var a=0,r=0,t=arguments.length;r<t;r++)a+=arguments[r].length;for(var n=Array(a),s=0,r=0;r<t;r++)for(var c=arguments[r],l=0,d=c.length;l<d;l++,s++)n[s]=c[l];return n}function Wn(a){return this instanceof Wn?(this.v=a,this):new Wn(a)}function Xm(a,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(a,r||[]),s,c=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(R){n[R]&&(s[R]=function(F){return new Promise(function(H,K){c.push([R,F,H,K])>1||d(R,F)})})}function d(R,F){try{_(n[R](F))}catch(H){L(c[0][3],H)}}function _(R){R.value instanceof Wn?Promise.resolve(R.value.v).then(y,S):L(c[0][2],R)}function y(R){d("next",R)}function S(R){d("throw",R)}function L(R,F){R(F),c.shift(),c.length&&d(c[0][0],c[0][1])}}function Zm(a){var r,t;return r={},n("next"),n("throw",function(s){throw s}),n("return"),r[Symbol.iterator]=function(){return this},r;function n(s,c){r[s]=a[s]?function(l){return(t=!t)?{value:Wn(a[s](l)),done:s==="return"}:c?c(l):l}:c}}function e1(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a[Symbol.asyncIterator],t;return r?r.call(a):(a=typeof vc=="function"?vc(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(c){t[c]=a[c]&&function(l){return new Promise(function(d,_){l=a[c](l),s(d,_,l.done,l.value)})}}function s(c,l,d,_){Promise.resolve(_).then(function(y){c({value:y,done:d})},l)}}function t1(a,r){return Object.defineProperty?Object.defineProperty(a,"raw",{value:r}):a.raw=r,a}function r1(a){if(a&&a.__esModule)return a;var r={};if(a!=null)for(var t in a)Object.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return r.default=a,r}function i1(a){return a&&a.__esModule?a:{default:a}}function n1(a,r){if(!r.has(a))throw new TypeError("attempted to get private field on non-instance");return r.get(a)}function s1(a,r,t){if(!r.has(a))throw new TypeError("attempted to set private field on non-instance");return r.set(a,t),t}const o1=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return yc},__asyncDelegator:Zm,__asyncGenerator:Xm,__asyncValues:e1,__await:Wn,__awaiter:Km,__classPrivateFieldGet:n1,__classPrivateFieldSet:s1,__createBinding:Wm,__decorate:Bm,__exportStar:Jm,__extends:zm,__generator:Gm,__importDefault:i1,__importStar:r1,__makeTemplateObject:t1,__metadata:Vm,__param:km,__read:lf,__rest:Hm,__spread:Qm,__spreadArrays:Ym,__values:vc},Symbol.toStringTag,{value:"Module"})),mo=Zn(o1);var jn={},Ya={},Ln={};let Mi=class{};const a1=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Mi},Symbol.toStringTag,{value:"Module"})),c1=Zn(a1);var Zh;function u1(){if(Zh)return Ln;Zh=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.IHeartBeat=void 0;const a=c1;class r extends a.IEvents{constructor(n){super()}}return Ln.IHeartBeat=r,Ln}var el;function ff(){return el||(el=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),mo.__exportStar(u1(),a)}(Ya)),Ya}var Xa={},Li={},tl;function h1(){if(tl)return Li;tl=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.HEARTBEAT_EVENTS=Li.HEARTBEAT_INTERVAL=void 0;const a=ie;return Li.HEARTBEAT_INTERVAL=a.FIVE_SECONDS,Li.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Li}var rl;function pf(){return rl||(rl=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),mo.__exportStar(h1(),a)}(Xa)),Xa}var il;function l1(){if(il)return jn;il=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.HeartBeat=void 0;const a=mo,r=Pr,t=ie,n=ff(),s=pf();class c extends n.IHeartBeat{constructor(d){super(d),this.events=new r.EventEmitter,this.interval=s.HEARTBEAT_INTERVAL,this.interval=(d==null?void 0:d.interval)||s.HEARTBEAT_INTERVAL}static init(d){return a.__awaiter(this,void 0,void 0,function*(){const _=new c(d);return yield _.init(),_})}init(){return a.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(d,_){this.events.on(d,_)}once(d,_){this.events.once(d,_)}off(d,_){this.events.off(d,_)}removeListener(d,_){this.events.removeListener(d,_)}initialize(){return a.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(s.HEARTBEAT_EVENTS.pulse)}}return jn.HeartBeat=c,jn}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const r=mo;r.__exportStar(l1(),a),r.__exportStar(ff(),a),r.__exportStar(pf(),a)})(pn);var $e={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var _c=function(a,r){return _c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},_c(a,r)};function f1(a,r){_c(a,r);function t(){this.constructor=a}a.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var mc=function(){return mc=Object.assign||function(r){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(r[c]=t[c])}return r},mc.apply(this,arguments)};function p1(a,r){var t={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(t[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(a);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(a,n[s])&&(t[n[s]]=a[n[s]]);return t}function d1(a,r,t,n){var s=arguments.length,c=s<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,r,t,n);else for(var d=a.length-1;d>=0;d--)(l=a[d])&&(c=(s<3?l(c):s>3?l(r,t,c):l(r,t))||c);return s>3&&c&&Object.defineProperty(r,t,c),c}function g1(a,r){return function(t,n){r(t,n,a)}}function y1(a,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,r)}function v1(a,r,t,n){function s(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function d(S){try{y(n.next(S))}catch(L){l(L)}}function _(S){try{y(n.throw(S))}catch(L){l(L)}}function y(S){S.done?c(S.value):s(S.value).then(d,_)}y((n=n.apply(a,r||[])).next())})}function _1(a,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,l;return l={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function d(y){return function(S){return _([y,S])}}function _(y){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(c=y[0]&2?s.return:y[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,y[1])).done)return c;switch(s=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,s=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=r.call(a,t)}catch(S){y=[6,S],s=0}finally{n=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function m1(a,r,t,n){n===void 0&&(n=t),a[n]=r[t]}function w1(a,r){for(var t in a)t!=="default"&&!r.hasOwnProperty(t)&&(r[t]=a[t])}function wc(a){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&a[r],n=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function df(a,r){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var n=t.call(a),s,c=[],l;try{for(;(r===void 0||r-- >0)&&!(s=n.next()).done;)c.push(s.value)}catch(d){l={error:d}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(l)throw l.error}}return c}function b1(){for(var a=[],r=0;r<arguments.length;r++)a=a.concat(df(arguments[r]));return a}function E1(){for(var a=0,r=0,t=arguments.length;r<t;r++)a+=arguments[r].length;for(var n=Array(a),s=0,r=0;r<t;r++)for(var c=arguments[r],l=0,d=c.length;l<d;l++,s++)n[s]=c[l];return n}function Jn(a){return this instanceof Jn?(this.v=a,this):new Jn(a)}function x1(a,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(a,r||[]),s,c=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(R){n[R]&&(s[R]=function(F){return new Promise(function(H,K){c.push([R,F,H,K])>1||d(R,F)})})}function d(R,F){try{_(n[R](F))}catch(H){L(c[0][3],H)}}function _(R){R.value instanceof Jn?Promise.resolve(R.value.v).then(y,S):L(c[0][2],R)}function y(R){d("next",R)}function S(R){d("throw",R)}function L(R,F){R(F),c.shift(),c.length&&d(c[0][0],c[0][1])}}function I1(a){var r,t;return r={},n("next"),n("throw",function(s){throw s}),n("return"),r[Symbol.iterator]=function(){return this},r;function n(s,c){r[s]=a[s]?function(l){return(t=!t)?{value:Jn(a[s](l)),done:s==="return"}:c?c(l):l}:c}}function S1(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a[Symbol.asyncIterator],t;return r?r.call(a):(a=typeof wc=="function"?wc(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(c){t[c]=a[c]&&function(l){return new Promise(function(d,_){l=a[c](l),s(d,_,l.done,l.value)})}}function s(c,l,d,_){Promise.resolve(_).then(function(y){c({value:y,done:d})},l)}}function P1(a,r){return Object.defineProperty?Object.defineProperty(a,"raw",{value:r}):a.raw=r,a}function O1(a){if(a&&a.__esModule)return a;var r={};if(a!=null)for(var t in a)Object.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return r.default=a,r}function R1(a){return a&&a.__esModule?a:{default:a}}function T1(a,r){if(!r.has(a))throw new TypeError("attempted to get private field on non-instance");return r.get(a)}function C1(a,r,t){if(!r.has(a))throw new TypeError("attempted to set private field on non-instance");return r.set(a,t),t}const A1=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return mc},__asyncDelegator:I1,__asyncGenerator:x1,__asyncValues:S1,__await:Jn,__awaiter:v1,__classPrivateFieldGet:T1,__classPrivateFieldSet:C1,__createBinding:m1,__decorate:d1,__exportStar:w1,__extends:f1,__generator:_1,__importDefault:R1,__importStar:O1,__makeTemplateObject:P1,__metadata:y1,__param:g1,__read:df,__rest:p1,__spread:b1,__spreadArrays:E1,__values:wc},Symbol.toStringTag,{value:"Module"})),$1=Zn(A1);var Za,nl;function N1(){if(nl)return Za;nl=1;function a(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}Za=r;function r(t,n,s){var c=s&&s.stringify||a,l=1;if(typeof t=="object"&&t!==null){var d=n.length+l;if(d===1)return t;var _=new Array(d);_[0]=c(t);for(var y=1;y<d;y++)_[y]=c(n[y]);return _.join(" ")}if(typeof t!="string")return t;var S=n.length;if(S===0)return t;for(var L="",R=1-l,F=-1,H=t&&t.length||0,K=0;K<H;){if(t.charCodeAt(K)===37&&K+1<H){switch(F=F>-1?F:0,t.charCodeAt(K+1)){case 100:case 102:if(R>=S||n[R]==null)break;F<K&&(L+=t.slice(F,K)),L+=Number(n[R]),F=K+2,K++;break;case 105:if(R>=S||n[R]==null)break;F<K&&(L+=t.slice(F,K)),L+=Math.floor(Number(n[R])),F=K+2,K++;break;case 79:case 111:case 106:if(R>=S||n[R]===void 0)break;F<K&&(L+=t.slice(F,K));var ne=typeof n[R];if(ne==="string"){L+="'"+n[R]+"'",F=K+2,K++;break}if(ne==="function"){L+=n[R].name||"<anonymous>",F=K+2,K++;break}L+=c(n[R]),F=K+2,K++;break;case 115:if(R>=S)break;F<K&&(L+=t.slice(F,K)),L+=String(n[R]),F=K+2,K++;break;case 37:F<K&&(L+=t.slice(F,K)),L+="%",F=K+2,K++,R--;break}++R}++K}return F===-1?t:(F<H&&(L+=t.slice(F)),L)}return Za}var ec,sl;function D1(){if(sl)return ec;sl=1;const a=N1();ec=s;const r=fe().console||{},t={mapHttpRequest:H,mapHttpResponse:H,wrapRequestSerializer:K,wrapResponseSerializer:K,wrapErrorSerializer:K,req:H,res:H,err:R};function n(D,U){return Array.isArray(D)?D.filter(function(ye){return ye!=="!stdSerializers.err"}):D===!0?Object.keys(U):!1}function s(D){D=D||{},D.browser=D.browser||{};const U=D.browser.transmit;if(U&&typeof U.send!="function")throw Error("pino: transmit option must have a send function");const Q=D.browser.write||r;D.browser.write&&(D.browser.asObject=!0);const ye=D.serializers||{},Z=n(D.browser.serialize,ye);let xe=D.browser.serialize;Array.isArray(D.browser.serialize)&&D.browser.serialize.indexOf("!stdSerializers.err")>-1&&(xe=!1);const Oe=["error","fatal","warn","info","debug","trace"];typeof Q=="function"&&(Q.error=Q.fatal=Q.warn=Q.info=Q.debug=Q.trace=Q),D.enabled===!1&&(D.level="silent");const T=D.level||"info",w=Object.create(Q);w.log||(w.log=ne),Object.defineProperty(w,"levelVal",{get:pe}),Object.defineProperty(w,"level",{get:oe,set:V});const C={transmit:U,serialize:Z,asObject:D.browser.asObject,levels:Oe,timestamp:F(D)};w.levels=s.levels,w.level=T,w.setMaxListeners=w.getMaxListeners=w.emit=w.addListener=w.on=w.prependListener=w.once=w.prependOnceListener=w.removeListener=w.removeAllListeners=w.listeners=w.listenerCount=w.eventNames=w.write=w.flush=ne,w.serializers=ye,w._serialize=Z,w._stdErrSerialize=xe,w.child=G,U&&(w._logEvent=L());function pe(){return this.level==="silent"?1/0:this.levels.values[this.level]}function oe(){return this._level}function V(k){if(k!=="silent"&&!this.levels.values[k])throw Error("unknown level "+k);this._level=k,c(C,w,"error","log"),c(C,w,"fatal","error"),c(C,w,"warn","error"),c(C,w,"info","log"),c(C,w,"debug","log"),c(C,w,"trace","log")}function G(k,W){if(!k)throw new Error("missing bindings for child Pino");W=W||{},Z&&k.serializers&&(W.serializers=k.serializers);const ct=W.serializers;if(Z&&ct){var Be=Object.assign({},ye,ct),Fr=D.browser.serialize===!0?Object.keys(Be):Z;delete k.serializers,_([k],Fr,Be,this._stdErrSerialize)}function Ie(xt){this._childLevel=(xt._childLevel|0)+1,this.error=y(xt,k,"error"),this.fatal=y(xt,k,"fatal"),this.warn=y(xt,k,"warn"),this.info=y(xt,k,"info"),this.debug=y(xt,k,"debug"),this.trace=y(xt,k,"trace"),Be&&(this.serializers=Be,this._serialize=Fr),U&&(this._logEvent=L([].concat(xt._logEvent.bindings,k)))}return Ie.prototype=this,new Ie(this)}return w}s.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},s.stdSerializers=t,s.stdTimeFunctions=Object.assign({},{nullTime:Ee,epochTime:ge,unixTime:le,isoTime:ue});function c(D,U,Q,ye){const Z=Object.getPrototypeOf(U);U[Q]=U.levelVal>U.levels.values[Q]?ne:Z[Q]?Z[Q]:r[Q]||r[ye]||ne,l(D,U,Q)}function l(D,U,Q){!D.transmit&&U[Q]===ne||(U[Q]=function(ye){return function(){const xe=D.timestamp(),Oe=new Array(arguments.length),T=Object.getPrototypeOf&&Object.getPrototypeOf(this)===r?r:this;for(var w=0;w<Oe.length;w++)Oe[w]=arguments[w];if(D.serialize&&!D.asObject&&_(Oe,this._serialize,this.serializers,this._stdErrSerialize),D.asObject?ye.call(T,d(this,Q,Oe,xe)):ye.apply(T,Oe),D.transmit){const C=D.transmit.level||U.level,pe=s.levels.values[C],oe=s.levels.values[Q];if(oe<pe)return;S(this,{ts:xe,methodLevel:Q,methodValue:oe,transmitLevel:C,transmitValue:s.levels.values[D.transmit.level||U.level],send:D.transmit.send,val:U.levelVal},Oe)}}}(U[Q]))}function d(D,U,Q,ye){D._serialize&&_(Q,D._serialize,D.serializers,D._stdErrSerialize);const Z=Q.slice();let xe=Z[0];const Oe={};ye&&(Oe.time=ye),Oe.level=s.levels.values[U];let T=(D._childLevel|0)+1;if(T<1&&(T=1),xe!==null&&typeof xe=="object"){for(;T--&&typeof Z[0]=="object";)Object.assign(Oe,Z.shift());xe=Z.length?a(Z.shift(),Z):void 0}else typeof xe=="string"&&(xe=a(Z.shift(),Z));return xe!==void 0&&(Oe.msg=xe),Oe}function _(D,U,Q,ye){for(const Z in D)if(ye&&D[Z]instanceof Error)D[Z]=s.stdSerializers.err(D[Z]);else if(typeof D[Z]=="object"&&!Array.isArray(D[Z]))for(const xe in D[Z])U&&U.indexOf(xe)>-1&&xe in Q&&(D[Z][xe]=Q[xe](D[Z][xe]))}function y(D,U,Q){return function(){const ye=new Array(1+arguments.length);ye[0]=U;for(var Z=1;Z<ye.length;Z++)ye[Z]=arguments[Z-1];return D[Q].apply(this,ye)}}function S(D,U,Q){const ye=U.send,Z=U.ts,xe=U.methodLevel,Oe=U.methodValue,T=U.val,w=D._logEvent.bindings;_(Q,D._serialize||Object.keys(D.serializers),D.serializers,D._stdErrSerialize===void 0?!0:D._stdErrSerialize),D._logEvent.ts=Z,D._logEvent.messages=Q.filter(function(C){return w.indexOf(C)===-1}),D._logEvent.level.label=xe,D._logEvent.level.value=Oe,ye(xe,D._logEvent,T),D._logEvent=L(w)}function L(D){return{ts:0,messages:[],bindings:D||[],level:{label:"",value:0}}}function R(D){const U={type:D.constructor.name,msg:D.message,stack:D.stack};for(const Q in D)U[Q]===void 0&&(U[Q]=D[Q]);return U}function F(D){return typeof D.timestamp=="function"?D.timestamp:D.timestamp===!1?Ee:ge}function H(){return{}}function K(D){return D}function ne(){}function Ee(){return!1}function ge(){return Date.now()}function le(){return Math.round(Date.now()/1e3)}function ue(){return new Date(Date.now()).toISOString()}function fe(){function D(U){return typeof U<"u"&&U}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return D(self)||D(window)||D(this)||{}}}return ec}var qi={},ol;function gf(){return ol||(ol=1,Object.defineProperty(qi,"__esModule",{value:!0}),qi.PINO_CUSTOM_CONTEXT_KEY=qi.PINO_LOGGER_DEFAULTS=void 0,qi.PINO_LOGGER_DEFAULTS={level:"info"},qi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),qi}var Zt={},al;function F1(){if(al)return Zt;al=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.generateChildLogger=Zt.formatChildLoggerContext=Zt.getLoggerContext=Zt.setBrowserLoggerContext=Zt.getBrowserLoggerContext=Zt.getDefaultLoggerOptions=void 0;const a=gf();function r(d){return Object.assign(Object.assign({},d),{level:(d==null?void 0:d.level)||a.PINO_LOGGER_DEFAULTS.level})}Zt.getDefaultLoggerOptions=r;function t(d,_=a.PINO_CUSTOM_CONTEXT_KEY){return d[_]||""}Zt.getBrowserLoggerContext=t;function n(d,_,y=a.PINO_CUSTOM_CONTEXT_KEY){return d[y]=_,d}Zt.setBrowserLoggerContext=n;function s(d,_=a.PINO_CUSTOM_CONTEXT_KEY){let y="";return typeof d.bindings>"u"?y=t(d,_):y=d.bindings().context||"",y}Zt.getLoggerContext=s;function c(d,_,y=a.PINO_CUSTOM_CONTEXT_KEY){const S=s(d,y);return S.trim()?`${S}/${_}`:_}Zt.formatChildLoggerContext=c;function l(d,_,y=a.PINO_CUSTOM_CONTEXT_KEY){const S=c(d,_,y),L=d.child({context:S});return n(L,S,y)}return Zt.generateChildLogger=l,Zt}(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.pino=void 0;const r=$1,t=r.__importDefault(D1());Object.defineProperty(a,"pino",{enumerable:!0,get:function(){return t.default}}),r.__exportStar(gf(),a),r.__exportStar(F1(),a)})($e);class j1 extends Mi{constructor(r){super(),this.opts=r,this.protocol="wc",this.version=2}}class L1 extends Mi{constructor(r,t){super(),this.core=r,this.logger=t,this.records=new Map}}class q1{constructor(r,t){this.logger=r,this.core=t}}let M1=class extends Mi{constructor(r,t){super(),this.relayer=r,this.logger=t}},U1=class extends Mi{constructor(r){super()}},z1=class{constructor(r,t,n,s){this.core=r,this.logger=t,this.name=n}};class H1 extends Mi{constructor(r,t){super(),this.relayer=r,this.logger=t}}let B1=class extends Mi{constructor(r,t){super(),this.core=r,this.logger=t}},k1=class{constructor(r,t){this.projectId=r,this.logger=t}},V1=class{constructor(r){this.opts=r,this.protocol="wc",this.version=2}},K1=class{constructor(r){this.client=r}};const G1=a=>JSON.stringify(a,(r,t)=>typeof t=="bigint"?t.toString()+"n":t),W1=a=>{const r=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=a.replace(r,'$1"$2n"$3');return JSON.parse(t,(n,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function Nc(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return W1(a)}catch{return a}}function Qn(a){return typeof a=="string"?a:G1(a)||""}var Dc={},yf={};(function(a){Object.defineProperty(a,"__esModule",{value:!0});var r=P_,t=Xl;a.DIGEST_LENGTH=64,a.BLOCK_SIZE=128;var n=function(){function d(){this.digestLength=a.DIGEST_LENGTH,this.blockSize=a.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return d.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},d.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},d.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},d.prototype.update=function(_,y){if(y===void 0&&(y=_.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var S=0;if(this._bytesHashed+=y,this._bufferLength>0){for(;this._bufferLength<a.BLOCK_SIZE&&y>0;)this._buffer[this._bufferLength++]=_[S++],y--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(y>=this.blockSize&&(S=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,_,S,y),y%=this.blockSize);y>0;)this._buffer[this._bufferLength++]=_[S++],y--;return this},d.prototype.finish=function(_){if(!this._finished){var y=this._bytesHashed,S=this._bufferLength,L=y/536870912|0,R=y<<3,F=y%128<112?128:256;this._buffer[S]=128;for(var H=S+1;H<F-8;H++)this._buffer[H]=0;r.writeUint32BE(L,this._buffer,F-8),r.writeUint32BE(R,this._buffer,F-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,F),this._finished=!0}for(var H=0;H<this.digestLength/8;H++)r.writeUint32BE(this._stateHi[H],_,H*8),r.writeUint32BE(this._stateLo[H],_,H*8+4);return this},d.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},d.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},d.prototype.restoreState=function(_){return this._stateHi.set(_.stateHi),this._stateLo.set(_.stateLo),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},d.prototype.cleanSavedState=function(_){t.wipe(_.stateHi),t.wipe(_.stateLo),_.buffer&&t.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},d}();a.SHA512=n;var s=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(d,_,y,S,L,R,F){for(var H=y[0],K=y[1],ne=y[2],Ee=y[3],ge=y[4],le=y[5],ue=y[6],fe=y[7],D=S[0],U=S[1],Q=S[2],ye=S[3],Z=S[4],xe=S[5],Oe=S[6],T=S[7],w,C,pe,oe,V,G,k,W;F>=128;){for(var ct=0;ct<16;ct++){var Be=8*ct+R;d[ct]=r.readUint32BE(L,Be),_[ct]=r.readUint32BE(L,Be+4)}for(var ct=0;ct<80;ct++){var Fr=H,Ie=K,xt=ne,N=Ee,$=ge,O=le,h=ue,E=fe,te=D,he=U,we=Q,Ne=ye,Fe=Z,Re=xe,It=Oe,vt=T;if(w=fe,C=T,V=C&65535,G=C>>>16,k=w&65535,W=w>>>16,w=(ge>>>14|Z<<32-14)^(ge>>>18|Z<<32-18)^(Z>>>41-32|ge<<32-(41-32)),C=(Z>>>14|ge<<32-14)^(Z>>>18|ge<<32-18)^(ge>>>41-32|Z<<32-(41-32)),V+=C&65535,G+=C>>>16,k+=w&65535,W+=w>>>16,w=ge&le^~ge&ue,C=Z&xe^~Z&Oe,V+=C&65535,G+=C>>>16,k+=w&65535,W+=w>>>16,w=s[ct*2],C=s[ct*2+1],V+=C&65535,G+=C>>>16,k+=w&65535,W+=w>>>16,w=d[ct%16],C=_[ct%16],V+=C&65535,G+=C>>>16,k+=w&65535,W+=w>>>16,G+=V>>>16,k+=G>>>16,W+=k>>>16,pe=k&65535|W<<16,oe=V&65535|G<<16,w=pe,C=oe,V=C&65535,G=C>>>16,k=w&65535,W=w>>>16,w=(H>>>28|D<<32-28)^(D>>>34-32|H<<32-(34-32))^(D>>>39-32|H<<32-(39-32)),C=(D>>>28|H<<32-28)^(H>>>34-32|D<<32-(34-32))^(H>>>39-32|D<<32-(39-32)),V+=C&65535,G+=C>>>16,k+=w&65535,W+=w>>>16,w=H&K^H&ne^K&ne,C=D&U^D&Q^U&Q,V+=C&65535,G+=C>>>16,k+=w&65535,W+=w>>>16,G+=V>>>16,k+=G>>>16,W+=k>>>16,E=k&65535|W<<16,vt=V&65535|G<<16,w=N,C=Ne,V=C&65535,G=C>>>16,k=w&65535,W=w>>>16,w=pe,C=oe,V+=C&65535,G+=C>>>16,k+=w&65535,W+=w>>>16,G+=V>>>16,k+=G>>>16,W+=k>>>16,N=k&65535|W<<16,Ne=V&65535|G<<16,K=Fr,ne=Ie,Ee=xt,ge=N,le=$,ue=O,fe=h,H=E,U=te,Q=he,ye=we,Z=Ne,xe=Fe,Oe=Re,T=It,D=vt,ct%16===15)for(var Be=0;Be<16;Be++)w=d[Be],C=_[Be],V=C&65535,G=C>>>16,k=w&65535,W=w>>>16,w=d[(Be+9)%16],C=_[(Be+9)%16],V+=C&65535,G+=C>>>16,k+=w&65535,W+=w>>>16,pe=d[(Be+1)%16],oe=_[(Be+1)%16],w=(pe>>>1|oe<<32-1)^(pe>>>8|oe<<32-8)^pe>>>7,C=(oe>>>1|pe<<32-1)^(oe>>>8|pe<<32-8)^(oe>>>7|pe<<32-7),V+=C&65535,G+=C>>>16,k+=w&65535,W+=w>>>16,pe=d[(Be+14)%16],oe=_[(Be+14)%16],w=(pe>>>19|oe<<32-19)^(oe>>>61-32|pe<<32-(61-32))^pe>>>6,C=(oe>>>19|pe<<32-19)^(pe>>>61-32|oe<<32-(61-32))^(oe>>>6|pe<<32-6),V+=C&65535,G+=C>>>16,k+=w&65535,W+=w>>>16,G+=V>>>16,k+=G>>>16,W+=k>>>16,d[Be]=k&65535|W<<16,_[Be]=V&65535|G<<16}w=H,C=D,V=C&65535,G=C>>>16,k=w&65535,W=w>>>16,w=y[0],C=S[0],V+=C&65535,G+=C>>>16,k+=w&65535,W+=w>>>16,G+=V>>>16,k+=G>>>16,W+=k>>>16,y[0]=H=k&65535|W<<16,S[0]=D=V&65535|G<<16,w=K,C=U,V=C&65535,G=C>>>16,k=w&65535,W=w>>>16,w=y[1],C=S[1],V+=C&65535,G+=C>>>16,k+=w&65535,W+=w>>>16,G+=V>>>16,k+=G>>>16,W+=k>>>16,y[1]=K=k&65535|W<<16,S[1]=U=V&65535|G<<16,w=ne,C=Q,V=C&65535,G=C>>>16,k=w&65535,W=w>>>16,w=y[2],C=S[2],V+=C&65535,G+=C>>>16,k+=w&65535,W+=w>>>16,G+=V>>>16,k+=G>>>16,W+=k>>>16,y[2]=ne=k&65535|W<<16,S[2]=Q=V&65535|G<<16,w=Ee,C=ye,V=C&65535,G=C>>>16,k=w&65535,W=w>>>16,w=y[3],C=S[3],V+=C&65535,G+=C>>>16,k+=w&65535,W+=w>>>16,G+=V>>>16,k+=G>>>16,W+=k>>>16,y[3]=Ee=k&65535|W<<16,S[3]=ye=V&65535|G<<16,w=ge,C=Z,V=C&65535,G=C>>>16,k=w&65535,W=w>>>16,w=y[4],C=S[4],V+=C&65535,G+=C>>>16,k+=w&65535,W+=w>>>16,G+=V>>>16,k+=G>>>16,W+=k>>>16,y[4]=ge=k&65535|W<<16,S[4]=Z=V&65535|G<<16,w=le,C=xe,V=C&65535,G=C>>>16,k=w&65535,W=w>>>16,w=y[5],C=S[5],V+=C&65535,G+=C>>>16,k+=w&65535,W+=w>>>16,G+=V>>>16,k+=G>>>16,W+=k>>>16,y[5]=le=k&65535|W<<16,S[5]=xe=V&65535|G<<16,w=ue,C=Oe,V=C&65535,G=C>>>16,k=w&65535,W=w>>>16,w=y[6],C=S[6],V+=C&65535,G+=C>>>16,k+=w&65535,W+=w>>>16,G+=V>>>16,k+=G>>>16,W+=k>>>16,y[6]=ue=k&65535|W<<16,S[6]=Oe=V&65535|G<<16,w=fe,C=T,V=C&65535,G=C>>>16,k=w&65535,W=w>>>16,w=y[7],C=S[7],V+=C&65535,G+=C>>>16,k+=w&65535,W+=w>>>16,G+=V>>>16,k+=G>>>16,W+=k>>>16,y[7]=fe=k&65535|W<<16,S[7]=T=V&65535|G<<16,R+=128,F-=128}return R}function l(d){var _=new n;_.update(d);var y=_.digest();return _.clean(),y}a.hash=l})(yf);(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.convertSecretKeyToX25519=a.convertPublicKeyToX25519=a.verify=a.sign=a.extractPublicKeyFromSecretKey=a.generateKeyPair=a.generateKeyPairFromSeed=a.SEED_LENGTH=a.SECRET_KEY_LENGTH=a.PUBLIC_KEY_LENGTH=a.SIGNATURE_LENGTH=void 0;const r=Zl,t=yf,n=Xl;a.SIGNATURE_LENGTH=64,a.PUBLIC_KEY_LENGTH=32,a.SECRET_KEY_LENGTH=64,a.SEED_LENGTH=32;function s(N){const $=new Float64Array(16);if(N)for(let O=0;O<N.length;O++)$[O]=N[O];return $}const c=new Uint8Array(32);c[0]=9;const l=s(),d=s([1]),_=s([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),y=s([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),S=s([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),L=s([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),R=s([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function F(N,$){for(let O=0;O<16;O++)N[O]=$[O]|0}function H(N){let $=1;for(let O=0;O<16;O++){let h=N[O]+$+65535;$=Math.floor(h/65536),N[O]=h-$*65536}N[0]+=$-1+37*($-1)}function K(N,$,O){const h=~(O-1);for(let E=0;E<16;E++){const te=h&(N[E]^$[E]);N[E]^=te,$[E]^=te}}function ne(N,$){const O=s(),h=s();for(let E=0;E<16;E++)h[E]=$[E];H(h),H(h),H(h);for(let E=0;E<2;E++){O[0]=h[0]-65517;for(let he=1;he<15;he++)O[he]=h[he]-65535-(O[he-1]>>16&1),O[he-1]&=65535;O[15]=h[15]-32767-(O[14]>>16&1);const te=O[15]>>16&1;O[14]&=65535,K(h,O,1-te)}for(let E=0;E<16;E++)N[2*E]=h[E]&255,N[2*E+1]=h[E]>>8}function Ee(N,$){let O=0;for(let h=0;h<32;h++)O|=N[h]^$[h];return(1&O-1>>>8)-1}function ge(N,$){const O=new Uint8Array(32),h=new Uint8Array(32);return ne(O,N),ne(h,$),Ee(O,h)}function le(N){const $=new Uint8Array(32);return ne($,N),$[0]&1}function ue(N,$){for(let O=0;O<16;O++)N[O]=$[2*O]+($[2*O+1]<<8);N[15]&=32767}function fe(N,$,O){for(let h=0;h<16;h++)N[h]=$[h]+O[h]}function D(N,$,O){for(let h=0;h<16;h++)N[h]=$[h]-O[h]}function U(N,$,O){let h,E,te=0,he=0,we=0,Ne=0,Fe=0,Re=0,It=0,vt=0,nt=0,Le=0,Qe=0,Ye=0,st=0,ze=0,Xe=0,De=0,ke=0,ut=0,Me=0,St=0,Dt=0,Ut=0,zt=0,Lt=0,Gt=0,tr=0,jr=0,Wt=0,kr=0,ai=0,xi=0,ht=O[0],tt=O[1],lt=O[2],ft=O[3],ot=O[4],rt=O[5],Pt=O[6],Ot=O[7],pt=O[8],Rt=O[9],dt=O[10],_t=O[11],gt=O[12],Je=O[13],Tt=O[14],Ct=O[15];h=$[0],te+=h*ht,he+=h*tt,we+=h*lt,Ne+=h*ft,Fe+=h*ot,Re+=h*rt,It+=h*Pt,vt+=h*Ot,nt+=h*pt,Le+=h*Rt,Qe+=h*dt,Ye+=h*_t,st+=h*gt,ze+=h*Je,Xe+=h*Tt,De+=h*Ct,h=$[1],he+=h*ht,we+=h*tt,Ne+=h*lt,Fe+=h*ft,Re+=h*ot,It+=h*rt,vt+=h*Pt,nt+=h*Ot,Le+=h*pt,Qe+=h*Rt,Ye+=h*dt,st+=h*_t,ze+=h*gt,Xe+=h*Je,De+=h*Tt,ke+=h*Ct,h=$[2],we+=h*ht,Ne+=h*tt,Fe+=h*lt,Re+=h*ft,It+=h*ot,vt+=h*rt,nt+=h*Pt,Le+=h*Ot,Qe+=h*pt,Ye+=h*Rt,st+=h*dt,ze+=h*_t,Xe+=h*gt,De+=h*Je,ke+=h*Tt,ut+=h*Ct,h=$[3],Ne+=h*ht,Fe+=h*tt,Re+=h*lt,It+=h*ft,vt+=h*ot,nt+=h*rt,Le+=h*Pt,Qe+=h*Ot,Ye+=h*pt,st+=h*Rt,ze+=h*dt,Xe+=h*_t,De+=h*gt,ke+=h*Je,ut+=h*Tt,Me+=h*Ct,h=$[4],Fe+=h*ht,Re+=h*tt,It+=h*lt,vt+=h*ft,nt+=h*ot,Le+=h*rt,Qe+=h*Pt,Ye+=h*Ot,st+=h*pt,ze+=h*Rt,Xe+=h*dt,De+=h*_t,ke+=h*gt,ut+=h*Je,Me+=h*Tt,St+=h*Ct,h=$[5],Re+=h*ht,It+=h*tt,vt+=h*lt,nt+=h*ft,Le+=h*ot,Qe+=h*rt,Ye+=h*Pt,st+=h*Ot,ze+=h*pt,Xe+=h*Rt,De+=h*dt,ke+=h*_t,ut+=h*gt,Me+=h*Je,St+=h*Tt,Dt+=h*Ct,h=$[6],It+=h*ht,vt+=h*tt,nt+=h*lt,Le+=h*ft,Qe+=h*ot,Ye+=h*rt,st+=h*Pt,ze+=h*Ot,Xe+=h*pt,De+=h*Rt,ke+=h*dt,ut+=h*_t,Me+=h*gt,St+=h*Je,Dt+=h*Tt,Ut+=h*Ct,h=$[7],vt+=h*ht,nt+=h*tt,Le+=h*lt,Qe+=h*ft,Ye+=h*ot,st+=h*rt,ze+=h*Pt,Xe+=h*Ot,De+=h*pt,ke+=h*Rt,ut+=h*dt,Me+=h*_t,St+=h*gt,Dt+=h*Je,Ut+=h*Tt,zt+=h*Ct,h=$[8],nt+=h*ht,Le+=h*tt,Qe+=h*lt,Ye+=h*ft,st+=h*ot,ze+=h*rt,Xe+=h*Pt,De+=h*Ot,ke+=h*pt,ut+=h*Rt,Me+=h*dt,St+=h*_t,Dt+=h*gt,Ut+=h*Je,zt+=h*Tt,Lt+=h*Ct,h=$[9],Le+=h*ht,Qe+=h*tt,Ye+=h*lt,st+=h*ft,ze+=h*ot,Xe+=h*rt,De+=h*Pt,ke+=h*Ot,ut+=h*pt,Me+=h*Rt,St+=h*dt,Dt+=h*_t,Ut+=h*gt,zt+=h*Je,Lt+=h*Tt,Gt+=h*Ct,h=$[10],Qe+=h*ht,Ye+=h*tt,st+=h*lt,ze+=h*ft,Xe+=h*ot,De+=h*rt,ke+=h*Pt,ut+=h*Ot,Me+=h*pt,St+=h*Rt,Dt+=h*dt,Ut+=h*_t,zt+=h*gt,Lt+=h*Je,Gt+=h*Tt,tr+=h*Ct,h=$[11],Ye+=h*ht,st+=h*tt,ze+=h*lt,Xe+=h*ft,De+=h*ot,ke+=h*rt,ut+=h*Pt,Me+=h*Ot,St+=h*pt,Dt+=h*Rt,Ut+=h*dt,zt+=h*_t,Lt+=h*gt,Gt+=h*Je,tr+=h*Tt,jr+=h*Ct,h=$[12],st+=h*ht,ze+=h*tt,Xe+=h*lt,De+=h*ft,ke+=h*ot,ut+=h*rt,Me+=h*Pt,St+=h*Ot,Dt+=h*pt,Ut+=h*Rt,zt+=h*dt,Lt+=h*_t,Gt+=h*gt,tr+=h*Je,jr+=h*Tt,Wt+=h*Ct,h=$[13],ze+=h*ht,Xe+=h*tt,De+=h*lt,ke+=h*ft,ut+=h*ot,Me+=h*rt,St+=h*Pt,Dt+=h*Ot,Ut+=h*pt,zt+=h*Rt,Lt+=h*dt,Gt+=h*_t,tr+=h*gt,jr+=h*Je,Wt+=h*Tt,kr+=h*Ct,h=$[14],Xe+=h*ht,De+=h*tt,ke+=h*lt,ut+=h*ft,Me+=h*ot,St+=h*rt,Dt+=h*Pt,Ut+=h*Ot,zt+=h*pt,Lt+=h*Rt,Gt+=h*dt,tr+=h*_t,jr+=h*gt,Wt+=h*Je,kr+=h*Tt,ai+=h*Ct,h=$[15],De+=h*ht,ke+=h*tt,ut+=h*lt,Me+=h*ft,St+=h*ot,Dt+=h*rt,Ut+=h*Pt,zt+=h*Ot,Lt+=h*pt,Gt+=h*Rt,tr+=h*dt,jr+=h*_t,Wt+=h*gt,kr+=h*Je,ai+=h*Tt,xi+=h*Ct,te+=38*ke,he+=38*ut,we+=38*Me,Ne+=38*St,Fe+=38*Dt,Re+=38*Ut,It+=38*zt,vt+=38*Lt,nt+=38*Gt,Le+=38*tr,Qe+=38*jr,Ye+=38*Wt,st+=38*kr,ze+=38*ai,Xe+=38*xi,E=1,h=te+E+65535,E=Math.floor(h/65536),te=h-E*65536,h=he+E+65535,E=Math.floor(h/65536),he=h-E*65536,h=we+E+65535,E=Math.floor(h/65536),we=h-E*65536,h=Ne+E+65535,E=Math.floor(h/65536),Ne=h-E*65536,h=Fe+E+65535,E=Math.floor(h/65536),Fe=h-E*65536,h=Re+E+65535,E=Math.floor(h/65536),Re=h-E*65536,h=It+E+65535,E=Math.floor(h/65536),It=h-E*65536,h=vt+E+65535,E=Math.floor(h/65536),vt=h-E*65536,h=nt+E+65535,E=Math.floor(h/65536),nt=h-E*65536,h=Le+E+65535,E=Math.floor(h/65536),Le=h-E*65536,h=Qe+E+65535,E=Math.floor(h/65536),Qe=h-E*65536,h=Ye+E+65535,E=Math.floor(h/65536),Ye=h-E*65536,h=st+E+65535,E=Math.floor(h/65536),st=h-E*65536,h=ze+E+65535,E=Math.floor(h/65536),ze=h-E*65536,h=Xe+E+65535,E=Math.floor(h/65536),Xe=h-E*65536,h=De+E+65535,E=Math.floor(h/65536),De=h-E*65536,te+=E-1+37*(E-1),E=1,h=te+E+65535,E=Math.floor(h/65536),te=h-E*65536,h=he+E+65535,E=Math.floor(h/65536),he=h-E*65536,h=we+E+65535,E=Math.floor(h/65536),we=h-E*65536,h=Ne+E+65535,E=Math.floor(h/65536),Ne=h-E*65536,h=Fe+E+65535,E=Math.floor(h/65536),Fe=h-E*65536,h=Re+E+65535,E=Math.floor(h/65536),Re=h-E*65536,h=It+E+65535,E=Math.floor(h/65536),It=h-E*65536,h=vt+E+65535,E=Math.floor(h/65536),vt=h-E*65536,h=nt+E+65535,E=Math.floor(h/65536),nt=h-E*65536,h=Le+E+65535,E=Math.floor(h/65536),Le=h-E*65536,h=Qe+E+65535,E=Math.floor(h/65536),Qe=h-E*65536,h=Ye+E+65535,E=Math.floor(h/65536),Ye=h-E*65536,h=st+E+65535,E=Math.floor(h/65536),st=h-E*65536,h=ze+E+65535,E=Math.floor(h/65536),ze=h-E*65536,h=Xe+E+65535,E=Math.floor(h/65536),Xe=h-E*65536,h=De+E+65535,E=Math.floor(h/65536),De=h-E*65536,te+=E-1+37*(E-1),N[0]=te,N[1]=he,N[2]=we,N[3]=Ne,N[4]=Fe,N[5]=Re,N[6]=It,N[7]=vt,N[8]=nt,N[9]=Le,N[10]=Qe,N[11]=Ye,N[12]=st,N[13]=ze,N[14]=Xe,N[15]=De}function Q(N,$){U(N,$,$)}function ye(N,$){const O=s();let h;for(h=0;h<16;h++)O[h]=$[h];for(h=253;h>=0;h--)Q(O,O),h!==2&&h!==4&&U(O,O,$);for(h=0;h<16;h++)N[h]=O[h]}function Z(N,$){const O=s();let h;for(h=0;h<16;h++)O[h]=$[h];for(h=250;h>=0;h--)Q(O,O),h!==1&&U(O,O,$);for(h=0;h<16;h++)N[h]=O[h]}function xe(N,$){const O=s(),h=s(),E=s(),te=s(),he=s(),we=s(),Ne=s(),Fe=s(),Re=s();D(O,N[1],N[0]),D(Re,$[1],$[0]),U(O,O,Re),fe(h,N[0],N[1]),fe(Re,$[0],$[1]),U(h,h,Re),U(E,N[3],$[3]),U(E,E,y),U(te,N[2],$[2]),fe(te,te,te),D(he,h,O),D(we,te,E),fe(Ne,te,E),fe(Fe,h,O),U(N[0],he,we),U(N[1],Fe,Ne),U(N[2],Ne,we),U(N[3],he,Fe)}function Oe(N,$,O){for(let h=0;h<4;h++)K(N[h],$[h],O)}function T(N,$){const O=s(),h=s(),E=s();ye(E,$[2]),U(O,$[0],E),U(h,$[1],E),ne(N,h),N[31]^=le(O)<<7}function w(N,$,O){F(N[0],l),F(N[1],d),F(N[2],d),F(N[3],l);for(let h=255;h>=0;--h){const E=O[h/8|0]>>(h&7)&1;Oe(N,$,E),xe($,N),xe(N,N),Oe(N,$,E)}}function C(N,$){const O=[s(),s(),s(),s()];F(O[0],S),F(O[1],L),F(O[2],d),U(O[3],S,L),w(N,O,$)}function pe(N){if(N.length!==a.SEED_LENGTH)throw new Error(`ed25519: seed must be ${a.SEED_LENGTH} bytes`);const $=(0,t.hash)(N);$[0]&=248,$[31]&=127,$[31]|=64;const O=new Uint8Array(32),h=[s(),s(),s(),s()];C(h,$),T(O,h);const E=new Uint8Array(64);return E.set(N),E.set(O,32),{publicKey:O,secretKey:E}}a.generateKeyPairFromSeed=pe;function oe(N){const $=(0,r.randomBytes)(32,N),O=pe($);return(0,n.wipe)($),O}a.generateKeyPair=oe;function V(N){if(N.length!==a.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${a.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(N.subarray(32))}a.extractPublicKeyFromSecretKey=V;const G=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function k(N,$){let O,h,E,te;for(h=63;h>=32;--h){for(O=0,E=h-32,te=h-12;E<te;++E)$[E]+=O-16*$[h]*G[E-(h-32)],O=Math.floor(($[E]+128)/256),$[E]-=O*256;$[E]+=O,$[h]=0}for(O=0,E=0;E<32;E++)$[E]+=O-($[31]>>4)*G[E],O=$[E]>>8,$[E]&=255;for(E=0;E<32;E++)$[E]-=O*G[E];for(h=0;h<32;h++)$[h+1]+=$[h]>>8,N[h]=$[h]&255}function W(N){const $=new Float64Array(64);for(let O=0;O<64;O++)$[O]=N[O];for(let O=0;O<64;O++)N[O]=0;k(N,$)}function ct(N,$){const O=new Float64Array(64),h=[s(),s(),s(),s()],E=(0,t.hash)(N.subarray(0,32));E[0]&=248,E[31]&=127,E[31]|=64;const te=new Uint8Array(64);te.set(E.subarray(32),32);const he=new t.SHA512;he.update(te.subarray(32)),he.update($);const we=he.digest();he.clean(),W(we),C(h,we),T(te,h),he.reset(),he.update(te.subarray(0,32)),he.update(N.subarray(32)),he.update($);const Ne=he.digest();W(Ne);for(let Fe=0;Fe<32;Fe++)O[Fe]=we[Fe];for(let Fe=0;Fe<32;Fe++)for(let Re=0;Re<32;Re++)O[Fe+Re]+=Ne[Fe]*E[Re];return k(te.subarray(32),O),te}a.sign=ct;function Be(N,$){const O=s(),h=s(),E=s(),te=s(),he=s(),we=s(),Ne=s();return F(N[2],d),ue(N[1],$),Q(E,N[1]),U(te,E,_),D(E,E,N[2]),fe(te,N[2],te),Q(he,te),Q(we,he),U(Ne,we,he),U(O,Ne,E),U(O,O,te),Z(O,O),U(O,O,E),U(O,O,te),U(O,O,te),U(N[0],O,te),Q(h,N[0]),U(h,h,te),ge(h,E)&&U(N[0],N[0],R),Q(h,N[0]),U(h,h,te),ge(h,E)?-1:(le(N[0])===$[31]>>7&&D(N[0],l,N[0]),U(N[3],N[0],N[1]),0)}function Fr(N,$,O){const h=new Uint8Array(32),E=[s(),s(),s(),s()],te=[s(),s(),s(),s()];if(O.length!==a.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${a.SIGNATURE_LENGTH} bytes`);if(Be(te,N))return!1;const he=new t.SHA512;he.update(O.subarray(0,32)),he.update(N),he.update($);const we=he.digest();return W(we),w(E,te,we),C(te,O.subarray(32)),xe(E,te),T(h,E),!Ee(O,h)}a.verify=Fr;function Ie(N){let $=[s(),s(),s(),s()];if(Be($,N))throw new Error("Ed25519: invalid public key");let O=s(),h=s(),E=$[1];fe(O,d,E),D(h,d,E),ye(h,h),U(O,O,h);let te=new Uint8Array(32);return ne(te,O),te}a.convertPublicKeyToX25519=Ie;function xt(N){const $=(0,t.hash)(N.subarray(0,32));$[0]&=248,$[31]&=127,$[31]|=64;const O=new Uint8Array($.subarray(0,32));return(0,n.wipe)($),O}a.convertSecretKeyToX25519=xt})(Dc);const J1="EdDSA",Q1="JWT",vf=".",_f="base64url",Y1="utf8",X1="utf8",Z1=":",ew="did",tw="key",cl="base58btc",rw="z",iw="K36",nw=32;function po(a){return vo(Ac(Qn(a),Y1),_f)}function mf(a){const r=Ac(iw,cl),t=rw+vo(O_([r,a]),cl);return[ew,tw,t].join(Z1)}function sw(a){return vo(a,_f)}function ow(a){return Ac([po(a.header),po(a.payload)].join(vf),X1)}function aw(a){return[po(a.header),po(a.payload),sw(a.signature)].join(vf)}function ul(a=Zl.randomBytes(nw)){return Dc.generateKeyPairFromSeed(a)}async function cw(a,r,t,n,s=ie.fromMiliseconds(Date.now())){const c={alg:J1,typ:Q1},l=mf(n.publicKey),d=s+t,_={iss:l,sub:a,aud:r,iat:s,exp:d},y=ow({header:c,payload:_}),S=Dc.sign(n.secretKey,y);return aw({header:c,payload:_,signature:S})}const uw="PARSE_ERROR",hw="INVALID_REQUEST",lw="METHOD_NOT_FOUND",fw="INVALID_PARAMS",wf="INTERNAL_ERROR",Fc="SERVER_ERROR",pw=[-32700,-32600,-32601,-32602,-32603],Vn={[uw]:{code:-32700,message:"Parse error"},[hw]:{code:-32600,message:"Invalid Request"},[lw]:{code:-32601,message:"Method not found"},[fw]:{code:-32602,message:"Invalid params"},[wf]:{code:-32603,message:"Internal error"},[Fc]:{code:-32e3,message:"Server error"}},bf=Fc;function dw(a){return pw.includes(a)}function hl(a){return Object.keys(Vn).includes(a)?Vn[a]:Vn[bf]}function gw(a){const r=Object.values(Vn).find(t=>t.code===a);return r||Vn[bf]}function Ef(a,r,t){return a.message.includes("getaddrinfo ENOTFOUND")||a.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${r}`):a}var xf={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var bc=function(a,r){return bc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},bc(a,r)};function yw(a,r){bc(a,r);function t(){this.constructor=a}a.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var Ec=function(){return Ec=Object.assign||function(r){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(r[c]=t[c])}return r},Ec.apply(this,arguments)};function vw(a,r){var t={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(t[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(a);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(a,n[s])&&(t[n[s]]=a[n[s]]);return t}function _w(a,r,t,n){var s=arguments.length,c=s<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,r,t,n);else for(var d=a.length-1;d>=0;d--)(l=a[d])&&(c=(s<3?l(c):s>3?l(r,t,c):l(r,t))||c);return s>3&&c&&Object.defineProperty(r,t,c),c}function mw(a,r){return function(t,n){r(t,n,a)}}function ww(a,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,r)}function bw(a,r,t,n){function s(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function d(S){try{y(n.next(S))}catch(L){l(L)}}function _(S){try{y(n.throw(S))}catch(L){l(L)}}function y(S){S.done?c(S.value):s(S.value).then(d,_)}y((n=n.apply(a,r||[])).next())})}function Ew(a,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,l;return l={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function d(y){return function(S){return _([y,S])}}function _(y){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(c=y[0]&2?s.return:y[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,y[1])).done)return c;switch(s=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,s=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=r.call(a,t)}catch(S){y=[6,S],s=0}finally{n=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function xw(a,r,t,n){n===void 0&&(n=t),a[n]=r[t]}function Iw(a,r){for(var t in a)t!=="default"&&!r.hasOwnProperty(t)&&(r[t]=a[t])}function xc(a){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&a[r],n=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function If(a,r){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var n=t.call(a),s,c=[],l;try{for(;(r===void 0||r-- >0)&&!(s=n.next()).done;)c.push(s.value)}catch(d){l={error:d}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(l)throw l.error}}return c}function Sw(){for(var a=[],r=0;r<arguments.length;r++)a=a.concat(If(arguments[r]));return a}function Pw(){for(var a=0,r=0,t=arguments.length;r<t;r++)a+=arguments[r].length;for(var n=Array(a),s=0,r=0;r<t;r++)for(var c=arguments[r],l=0,d=c.length;l<d;l++,s++)n[s]=c[l];return n}function Yn(a){return this instanceof Yn?(this.v=a,this):new Yn(a)}function Ow(a,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(a,r||[]),s,c=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(R){n[R]&&(s[R]=function(F){return new Promise(function(H,K){c.push([R,F,H,K])>1||d(R,F)})})}function d(R,F){try{_(n[R](F))}catch(H){L(c[0][3],H)}}function _(R){R.value instanceof Yn?Promise.resolve(R.value.v).then(y,S):L(c[0][2],R)}function y(R){d("next",R)}function S(R){d("throw",R)}function L(R,F){R(F),c.shift(),c.length&&d(c[0][0],c[0][1])}}function Rw(a){var r,t;return r={},n("next"),n("throw",function(s){throw s}),n("return"),r[Symbol.iterator]=function(){return this},r;function n(s,c){r[s]=a[s]?function(l){return(t=!t)?{value:Yn(a[s](l)),done:s==="return"}:c?c(l):l}:c}}function Tw(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a[Symbol.asyncIterator],t;return r?r.call(a):(a=typeof xc=="function"?xc(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(c){t[c]=a[c]&&function(l){return new Promise(function(d,_){l=a[c](l),s(d,_,l.done,l.value)})}}function s(c,l,d,_){Promise.resolve(_).then(function(y){c({value:y,done:d})},l)}}function Cw(a,r){return Object.defineProperty?Object.defineProperty(a,"raw",{value:r}):a.raw=r,a}function Aw(a){if(a&&a.__esModule)return a;var r={};if(a!=null)for(var t in a)Object.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return r.default=a,r}function $w(a){return a&&a.__esModule?a:{default:a}}function Nw(a,r){if(!r.has(a))throw new TypeError("attempted to get private field on non-instance");return r.get(a)}function Dw(a,r,t){if(!r.has(a))throw new TypeError("attempted to set private field on non-instance");return r.set(a,t),t}const Fw=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Ec},__asyncDelegator:Rw,__asyncGenerator:Ow,__asyncValues:Tw,__await:Yn,__awaiter:bw,__classPrivateFieldGet:Nw,__classPrivateFieldSet:Dw,__createBinding:xw,__decorate:_w,__exportStar:Iw,__extends:yw,__generator:Ew,__importDefault:$w,__importStar:Aw,__makeTemplateObject:Cw,__metadata:ww,__param:mw,__read:If,__rest:vw,__spread:Sw,__spreadArrays:Pw,__values:xc},Symbol.toStringTag,{value:"Module"})),jw=Zn(Fw);var ri={},ll;function Lw(){if(ll)return ri;ll=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.isBrowserCryptoAvailable=ri.getSubtleCrypto=ri.getBrowerCrypto=void 0;function a(){return(globalThis==null?void 0:globalThis.crypto)||(globalThis==null?void 0:globalThis.msCrypto)||{}}ri.getBrowerCrypto=a;function r(){const n=a();return n.subtle||n.webkitSubtle}ri.getSubtleCrypto=r;function t(){return!!a()&&!!r()}return ri.isBrowserCryptoAvailable=t,ri}var ii={},fl;function qw(){if(fl)return ii;fl=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.isBrowser=ii.isNode=ii.isReactNative=void 0;function a(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}ii.isReactNative=a;function r(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}ii.isNode=r;function t(){return!a()&&!r()}return ii.isBrowser=t,ii}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const r=jw;r.__exportStar(Lw(),a),r.__exportStar(qw(),a)})(xf);function jc(a=3){const r=Date.now()*Math.pow(10,a),t=Math.floor(Math.random()*Math.pow(10,a));return r+t}function Sf(a=6){return BigInt(jc(a))}function Xn(a,r,t){return{id:t||jc(),jsonrpc:"2.0",method:a,params:r}}function Lc(a,r){return{id:a,jsonrpc:"2.0",result:r}}function wo(a,r,t){return{id:a,jsonrpc:"2.0",error:Mw(r,t)}}function Mw(a,r){return typeof a>"u"?hl(wf):(typeof a=="string"&&(a=Object.assign(Object.assign({},hl(Fc)),{message:a})),typeof r<"u"&&(a.data=r),dw(a.code)&&(a=gw(a.code)),a)}class Uw{}class zw extends Uw{constructor(){super()}}class Hw extends zw{constructor(r){super()}}const Bw="^https?:",kw="^wss?:";function Vw(a){const r=a.match(new RegExp(/^\w+:/,"gi"));if(!(!r||!r.length))return r[0]}function Pf(a,r){const t=Vw(a);return typeof t>"u"?!1:new RegExp(r).test(t)}function pl(a){return Pf(a,Bw)}function dl(a){return Pf(a,kw)}function Kw(a){return new RegExp("wss?://localhost(:d{2,5})?").test(a)}function Of(a){return typeof a=="object"&&"id"in a&&"jsonrpc"in a&&a.jsonrpc==="2.0"}function qc(a){return Of(a)&&"method"in a}function bo(a){return Of(a)&&(oi(a)||Dr(a))}function oi(a){return"result"in a}function Dr(a){return"error"in a}class bi extends Hw{constructor(r){super(r),this.events=new Pr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(r),this.connection.connected&&this.registerEventListeners()}async connect(r=this.connection){await this.open(r)}async disconnect(){await this.close()}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}off(r,t){this.events.off(r,t)}removeListener(r,t){this.events.removeListener(r,t)}async request(r,t){return this.requestStrict(Xn(r.method,r.params||[],r.id||Sf().toString()),t)}async requestStrict(r,t){return new Promise(async(n,s)=>{if(!this.connection.connected)try{await this.open()}catch(c){s(c)}this.events.on(`${r.id}`,c=>{Dr(c)?s(c.error):n(c.result)});try{await this.connection.send(r,t)}catch(c){s(c)}})}setConnection(r=this.connection){return r}onPayload(r){this.events.emit("payload",r),bo(r)?this.events.emit(`${r.id}`,r):this.events.emit("message",{type:r.method,data:r.params})}onClose(r){r&&r.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${r.code} ${r.reason?`(${r.reason})`:""}`)),this.events.emit("disconnect")}async open(r=this.connection){this.connection===r&&this.connection.connected||(this.connection.connected&&this.close(),typeof r=="string"&&(await this.connection.open(r),r=this.connection),this.connection=this.setConnection(r),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",r=>this.onPayload(r)),this.connection.on("close",r=>this.onClose(r)),this.connection.on("error",r=>this.events.emit("error",r)),this.connection.on("register_error",r=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Gw=()=>typeof WebSocket<"u"?WebSocket:typeof globalThis<"u"&&typeof globalThis.WebSocket<"u"?globalThis.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),Ww=()=>typeof WebSocket<"u"||typeof globalThis<"u"&&typeof globalThis.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",gl=a=>a.split("?")[0],yl=10,Jw=Gw();class Qw{constructor(r){if(this.url=r,this.events=new Pr.EventEmitter,this.registering=!1,!dl(r))throw new Error(`Provided URL is not compatible with WebSocket connection: ${r}`);this.url=r}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}off(r,t){this.events.off(r,t)}removeListener(r,t){this.events.removeListener(r,t)}async open(r=this.url){await this.register(r)}async close(){return new Promise((r,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),r()},this.socket.close()})}async send(r,t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Qn(r))}catch(n){this.onError(r.id,n)}}register(r=this.url){if(!dl(r))throw new Error(`Provided URL is not compatible with WebSocket connection: ${r}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,s)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),s(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=r,this.registering=!0,new Promise((t,n)=>{const s=xf.isReactNative()?void 0:{rejectUnauthorized:!Kw(r)},c=new Jw(r,[],s);Ww()?c.onerror=l=>{const d=l;n(this.emitError(d.error))}:c.on("error",l=>{n(this.emitError(l))}),c.onopen=()=>{this.onOpen(c),t(c)}})}onOpen(r){r.onmessage=t=>this.onPayload(t),r.onclose=t=>this.onClose(t),this.socket=r,this.registering=!1,this.events.emit("open")}onClose(r){this.socket=void 0,this.registering=!1,this.events.emit("close",r)}onPayload(r){if(typeof r.data>"u")return;const t=typeof r.data=="string"?Nc(r.data):r.data;this.events.emit("payload",t)}onError(r,t){const n=this.parseError(t),s=n.message||n.toString(),c=wo(r,s);this.events.emit("payload",c)}parseError(r,t=this.url){return Ef(r,gl(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>yl&&this.events.setMaxListeners(yl)}emitError(r){const t=this.parseError(new Error((r==null?void 0:r.message)||`WebSocket connection failed for host: ${gl(this.url)}`));return this.events.emit("register_error",t),t}}var go={exports:{}};go.exports;(function(a,r){var t=200,n="__lodash_hash_undefined__",s=1,c=2,l=9007199254740991,d="[object Arguments]",_="[object Array]",y="[object AsyncFunction]",S="[object Boolean]",L="[object Date]",R="[object Error]",F="[object Function]",H="[object GeneratorFunction]",K="[object Map]",ne="[object Number]",Ee="[object Null]",ge="[object Object]",le="[object Promise]",ue="[object Proxy]",fe="[object RegExp]",D="[object Set]",U="[object String]",Q="[object Symbol]",ye="[object Undefined]",Z="[object WeakMap]",xe="[object ArrayBuffer]",Oe="[object DataView]",T="[object Float32Array]",w="[object Float64Array]",C="[object Int8Array]",pe="[object Int16Array]",oe="[object Int32Array]",V="[object Uint8Array]",G="[object Uint8ClampedArray]",k="[object Uint16Array]",W="[object Uint32Array]",ct=/[\\^$.*+?()[\]{}|]/g,Be=/^\[object .+?Constructor\]$/,Fr=/^(?:0|[1-9]\d*)$/,Ie={};Ie[T]=Ie[w]=Ie[C]=Ie[pe]=Ie[oe]=Ie[V]=Ie[G]=Ie[k]=Ie[W]=!0,Ie[d]=Ie[_]=Ie[xe]=Ie[S]=Ie[Oe]=Ie[L]=Ie[R]=Ie[F]=Ie[K]=Ie[ne]=Ie[ge]=Ie[fe]=Ie[D]=Ie[U]=Ie[Z]=!1;var xt=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,N=typeof self=="object"&&self&&self.Object===Object&&self,$=xt||N||Function("return this")(),O=r&&!r.nodeType&&r,h=O&&!0&&a&&!a.nodeType&&a,E=h&&h.exports===O,te=E&&xt.process,he=function(){try{return te&&te.binding&&te.binding("util")}catch{}}(),we=he&&he.isTypedArray;function Ne(v,x){for(var z=-1,Y=v==null?0:v.length,Ke=0,ve=[];++z<Y;){var Ze=v[z];x(Ze,z,v)&&(ve[Ke++]=Ze)}return ve}function Fe(v,x){for(var z=-1,Y=x.length,Ke=v.length;++z<Y;)v[Ke+z]=x[z];return v}function Re(v,x){for(var z=-1,Y=v==null?0:v.length;++z<Y;)if(x(v[z],z,v))return!0;return!1}function It(v,x){for(var z=-1,Y=Array(v);++z<v;)Y[z]=x(z);return Y}function vt(v){return function(x){return v(x)}}function nt(v,x){return v.has(x)}function Le(v,x){return v==null?void 0:v[x]}function Qe(v){var x=-1,z=Array(v.size);return v.forEach(function(Y,Ke){z[++x]=[Ke,Y]}),z}function Ye(v,x){return function(z){return v(x(z))}}function st(v){var x=-1,z=Array(v.size);return v.forEach(function(Y){z[++x]=Y}),z}var ze=Array.prototype,Xe=Function.prototype,De=Object.prototype,ke=$["__core-js_shared__"],ut=Xe.toString,Me=De.hasOwnProperty,St=function(){var v=/[^.]+$/.exec(ke&&ke.keys&&ke.keys.IE_PROTO||"");return v?"Symbol(src)_1."+v:""}(),Dt=De.toString,Ut=RegExp("^"+ut.call(Me).replace(ct,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zt=E?$.Buffer:void 0,Lt=$.Symbol,Gt=$.Uint8Array,tr=De.propertyIsEnumerable,jr=ze.splice,Wt=Lt?Lt.toStringTag:void 0,kr=Object.getOwnPropertySymbols,ai=zt?zt.isBuffer:void 0,xi=Ye(Object.keys,Object),ht=ur($,"DataView"),tt=ur($,"Map"),lt=ur($,"Promise"),ft=ur($,"Set"),ot=ur($,"WeakMap"),rt=ur(Object,"create"),Pt=Kr(ht),Ot=Kr(tt),pt=Kr(lt),Rt=Kr(ft),dt=Kr(ot),_t=Lt?Lt.prototype:void 0,gt=_t?_t.valueOf:void 0;function Je(v){var x=-1,z=v==null?0:v.length;for(this.clear();++x<z;){var Y=v[x];this.set(Y[0],Y[1])}}function Tt(){this.__data__=rt?rt(null):{},this.size=0}function Ct(v){var x=this.has(v)&&delete this.__data__[v];return this.size-=x?1:0,x}function Io(v){var x=this.__data__;if(rt){var z=x[v];return z===n?void 0:z}return Me.call(x,v)?x[v]:void 0}function So(v){var x=this.__data__;return rt?x[v]!==void 0:Me.call(x,v)}function Po(v,x){var z=this.__data__;return this.size+=this.has(v)?0:1,z[v]=rt&&x===void 0?n:x,this}Je.prototype.clear=Tt,Je.prototype.delete=Ct,Je.prototype.get=Io,Je.prototype.has=So,Je.prototype.set=Po;function gr(v){var x=-1,z=v==null?0:v.length;for(this.clear();++x<z;){var Y=v[x];this.set(Y[0],Y[1])}}function Oo(){this.__data__=[],this.size=0}function Ro(v){var x=this.__data__,z=Ii(x,v);if(z<0)return!1;var Y=x.length-1;return z==Y?x.pop():jr.call(x,z,1),--this.size,!0}function To(v){var x=this.__data__,z=Ii(x,v);return z<0?void 0:x[z][1]}function Co(v){return Ii(this.__data__,v)>-1}function Ao(v,x){var z=this.__data__,Y=Ii(z,v);return Y<0?(++this.size,z.push([v,x])):z[Y][1]=x,this}gr.prototype.clear=Oo,gr.prototype.delete=Ro,gr.prototype.get=To,gr.prototype.has=Co,gr.prototype.set=Ao;function Vr(v){var x=-1,z=v==null?0:v.length;for(this.clear();++x<z;){var Y=v[x];this.set(Y[0],Y[1])}}function zi(){this.size=0,this.__data__={hash:new Je,map:new(tt||gr),string:new Je}}function $o(v){var x=ci(this,v).delete(v);return this.size-=x?1:0,x}function Hi(v){return ci(this,v).get(v)}function No(v){return ci(this,v).has(v)}function Do(v,x){var z=ci(this,v),Y=z.size;return z.set(v,x),this.size+=z.size==Y?0:1,this}Vr.prototype.clear=zi,Vr.prototype.delete=$o,Vr.prototype.get=Hi,Vr.prototype.has=No,Vr.prototype.set=Do;function Bi(v){var x=-1,z=v==null?0:v.length;for(this.__data__=new Vr;++x<z;)this.add(v[x])}function rs(v){return this.__data__.set(v,n),this}function is(v){return this.__data__.has(v)}Bi.prototype.add=Bi.prototype.push=rs,Bi.prototype.has=is;function Or(v){var x=this.__data__=new gr(v);this.size=x.size}function Fo(){this.__data__=new gr,this.size=0}function jo(v){var x=this.__data__,z=x.delete(v);return this.size=x.size,z}function Lo(v){return this.__data__.get(v)}function qo(v){return this.__data__.has(v)}function ns(v,x){var z=this.__data__;if(z instanceof gr){var Y=z.__data__;if(!tt||Y.length<t-1)return Y.push([v,x]),this.size=++z.size,this;z=this.__data__=new Vr(Y)}return z.set(v,x),this.size=z.size,this}Or.prototype.clear=Fo,Or.prototype.delete=jo,Or.prototype.get=Lo,Or.prototype.has=qo,Or.prototype.set=ns;function ss(v,x){var z=Ki(v),Y=!z&&vs(v),Ke=!z&&!Y&&yn(v),ve=!z&&!Y&&!Ke&&ws(v),Ze=z||Y||Ke||ve,At=Ze?It(v.length,String):[],Ce=At.length;for(var Ge in v)(x||Me.call(v,Ge))&&!(Ze&&(Ge=="length"||Ke&&(Ge=="offset"||Ge=="parent")||ve&&(Ge=="buffer"||Ge=="byteLength"||Ge=="byteOffset")||fs(Ge,Ce)))&&At.push(Ge);return At}function Ii(v,x){for(var z=v.length;z--;)if(ys(v[z][0],x))return z;return-1}function dn(v,x,z){var Y=x(v);return Ki(v)?Y:Fe(Y,z(v))}function Si(v){return v==null?v===void 0?ye:Ee:Wt&&Wt in Object(v)?hs(v):zo(v)}function gn(v){return Oi(v)&&Si(v)==d}function Pi(v,x,z,Y,Ke){return v===x?!0:v==null||x==null||!Oi(v)&&!Oi(x)?v!==v&&x!==x:os(v,x,z,Y,Pi,Ke)}function os(v,x,z,Y,Ke,ve){var Ze=Ki(v),At=Ki(x),Ce=Ze?_:Lr(v),Ge=At?_:Lr(x);Ce=Ce==d?ge:Ce,Ge=Ge==d?ge:Ge;var mt=Ce==ge,rr=Ge==ge,$t=Ce==Ge;if($t&&yn(v)){if(!yn(x))return!1;Ze=!0,mt=!1}if($t&&!mt)return ve||(ve=new Or),Ze||ws(v)?ki(v,x,z,Y,Ke,ve):Uo(v,x,Ce,z,Y,Ke,ve);if(!(z&s)){var et=mt&&Me.call(v,"__wrapped__"),Jt=rr&&Me.call(x,"__wrapped__");if(et||Jt){var Rr=et?v.value():v,yr=Jt?x.value():x;return ve||(ve=new Or),Ke(Rr,yr,z,Y,ve)}}return $t?(ve||(ve=new Or),us(v,x,z,Y,Ke,ve)):!1}function Mo(v){if(!ms(v)||ds(v))return!1;var x=Gi(v)?Ut:Be;return x.test(Kr(v))}function as(v){return Oi(v)&&_s(v.length)&&!!Ie[Si(v)]}function cs(v){if(!gs(v))return xi(v);var x=[];for(var z in Object(v))Me.call(v,z)&&z!="constructor"&&x.push(z);return x}function ki(v,x,z,Y,Ke,ve){var Ze=z&s,At=v.length,Ce=x.length;if(At!=Ce&&!(Ze&&Ce>At))return!1;var Ge=ve.get(v);if(Ge&&ve.get(x))return Ge==x;var mt=-1,rr=!0,$t=z&c?new Bi:void 0;for(ve.set(v,x),ve.set(x,v);++mt<At;){var et=v[mt],Jt=x[mt];if(Y)var Rr=Ze?Y(Jt,et,mt,x,v,ve):Y(et,Jt,mt,v,x,ve);if(Rr!==void 0){if(Rr)continue;rr=!1;break}if($t){if(!Re(x,function(yr,qr){if(!nt($t,qr)&&(et===yr||Ke(et,yr,z,Y,ve)))return $t.push(qr)})){rr=!1;break}}else if(!(et===Jt||Ke(et,Jt,z,Y,ve))){rr=!1;break}}return ve.delete(v),ve.delete(x),rr}function Uo(v,x,z,Y,Ke,ve,Ze){switch(z){case Oe:if(v.byteLength!=x.byteLength||v.byteOffset!=x.byteOffset)return!1;v=v.buffer,x=x.buffer;case xe:return!(v.byteLength!=x.byteLength||!ve(new Gt(v),new Gt(x)));case S:case L:case ne:return ys(+v,+x);case R:return v.name==x.name&&v.message==x.message;case fe:case U:return v==x+"";case K:var At=Qe;case D:var Ce=Y&s;if(At||(At=st),v.size!=x.size&&!Ce)return!1;var Ge=Ze.get(v);if(Ge)return Ge==x;Y|=c,Ze.set(v,x);var mt=ki(At(v),At(x),Y,Ke,ve,Ze);return Ze.delete(v),mt;case Q:if(gt)return gt.call(v)==gt.call(x)}return!1}function us(v,x,z,Y,Ke,ve){var Ze=z&s,At=Vi(v),Ce=At.length,Ge=Vi(x),mt=Ge.length;if(Ce!=mt&&!Ze)return!1;for(var rr=Ce;rr--;){var $t=At[rr];if(!(Ze?$t in x:Me.call(x,$t)))return!1}var et=ve.get(v);if(et&&ve.get(x))return et==x;var Jt=!0;ve.set(v,x),ve.set(x,v);for(var Rr=Ze;++rr<Ce;){$t=At[rr];var yr=v[$t],qr=x[$t];if(Y)var vn=Ze?Y(qr,yr,$t,x,v,ve):Y(yr,qr,$t,v,x,ve);if(!(vn===void 0?yr===qr||Ke(yr,qr,z,Y,ve):vn)){Jt=!1;break}Rr||(Rr=$t=="constructor")}if(Jt&&!Rr){var Ri=v.constructor,qt=x.constructor;Ri!=qt&&"constructor"in v&&"constructor"in x&&!(typeof Ri=="function"&&Ri instanceof Ri&&typeof qt=="function"&&qt instanceof qt)&&(Jt=!1)}return ve.delete(v),ve.delete(x),Jt}function Vi(v){return dn(v,ko,ls)}function ci(v,x){var z=v.__data__;return ps(x)?z[typeof x=="string"?"string":"hash"]:z.map}function ur(v,x){var z=Le(v,x);return Mo(z)?z:void 0}function hs(v){var x=Me.call(v,Wt),z=v[Wt];try{v[Wt]=void 0;var Y=!0}catch{}var Ke=Dt.call(v);return Y&&(x?v[Wt]=z:delete v[Wt]),Ke}var ls=kr?function(v){return v==null?[]:(v=Object(v),Ne(kr(v),function(x){return tr.call(v,x)}))}:Ve,Lr=Si;(ht&&Lr(new ht(new ArrayBuffer(1)))!=Oe||tt&&Lr(new tt)!=K||lt&&Lr(lt.resolve())!=le||ft&&Lr(new ft)!=D||ot&&Lr(new ot)!=Z)&&(Lr=function(v){var x=Si(v),z=x==ge?v.constructor:void 0,Y=z?Kr(z):"";if(Y)switch(Y){case Pt:return Oe;case Ot:return K;case pt:return le;case Rt:return D;case dt:return Z}return x});function fs(v,x){return x=x??l,!!x&&(typeof v=="number"||Fr.test(v))&&v>-1&&v%1==0&&v<x}function ps(v){var x=typeof v;return x=="string"||x=="number"||x=="symbol"||x=="boolean"?v!=="__proto__":v===null}function ds(v){return!!St&&St in v}function gs(v){var x=v&&v.constructor,z=typeof x=="function"&&x.prototype||De;return v===z}function zo(v){return Dt.call(v)}function Kr(v){if(v!=null){try{return ut.call(v)}catch{}try{return v+""}catch{}}return""}function ys(v,x){return v===x||v!==v&&x!==x}var vs=gn(function(){return arguments}())?gn:function(v){return Oi(v)&&Me.call(v,"callee")&&!tr.call(v,"callee")},Ki=Array.isArray;function Ho(v){return v!=null&&_s(v.length)&&!Gi(v)}var yn=ai||He;function Bo(v,x){return Pi(v,x)}function Gi(v){if(!ms(v))return!1;var x=Si(v);return x==F||x==H||x==y||x==ue}function _s(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=l}function ms(v){var x=typeof v;return v!=null&&(x=="object"||x=="function")}function Oi(v){return v!=null&&typeof v=="object"}var ws=we?vt(we):as;function ko(v){return Ho(v)?ss(v):cs(v)}function Ve(){return[]}function He(){return!1}a.exports=Bo})(go,go.exports);var Yw=go.exports;const Xw=ef(Yw);function Zw(a,r){if(a.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<a.length;s++){var c=a.charAt(s),l=c.charCodeAt(0);if(t[l]!==255)throw new TypeError(c+" is ambiguous");t[l]=s}var d=a.length,_=a.charAt(0),y=Math.log(d)/Math.log(256),S=Math.log(256)/Math.log(d);function L(H){if(H instanceof Uint8Array||(ArrayBuffer.isView(H)?H=new Uint8Array(H.buffer,H.byteOffset,H.byteLength):Array.isArray(H)&&(H=Uint8Array.from(H))),!(H instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(H.length===0)return"";for(var K=0,ne=0,Ee=0,ge=H.length;Ee!==ge&&H[Ee]===0;)Ee++,K++;for(var le=(ge-Ee)*S+1>>>0,ue=new Uint8Array(le);Ee!==ge;){for(var fe=H[Ee],D=0,U=le-1;(fe!==0||D<ne)&&U!==-1;U--,D++)fe+=256*ue[U]>>>0,ue[U]=fe%d>>>0,fe=fe/d>>>0;if(fe!==0)throw new Error("Non-zero carry");ne=D,Ee++}for(var Q=le-ne;Q!==le&&ue[Q]===0;)Q++;for(var ye=_.repeat(K);Q<le;++Q)ye+=a.charAt(ue[Q]);return ye}function R(H){if(typeof H!="string")throw new TypeError("Expected String");if(H.length===0)return new Uint8Array;var K=0;if(H[K]!==" "){for(var ne=0,Ee=0;H[K]===_;)ne++,K++;for(var ge=(H.length-K)*y+1>>>0,le=new Uint8Array(ge);H[K];){var ue=t[H.charCodeAt(K)];if(ue===255)return;for(var fe=0,D=ge-1;(ue!==0||fe<Ee)&&D!==-1;D--,fe++)ue+=d*le[D]>>>0,le[D]=ue%256>>>0,ue=ue/256>>>0;if(ue!==0)throw new Error("Non-zero carry");Ee=fe,K++}if(H[K]!==" "){for(var U=ge-Ee;U!==ge&&le[U]===0;)U++;for(var Q=new Uint8Array(ne+(ge-U)),ye=ne;U!==ge;)Q[ye++]=le[U++];return Q}}}function F(H){var K=R(H);if(K)return K;throw new Error(`Non-${r} character`)}return{encode:L,decodeUnsafe:R,decode:F}}var eb=Zw,tb=eb;const Rf=a=>{if(a instanceof Uint8Array&&a.constructor.name==="Uint8Array")return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw new Error("Unknown type, must be binary type")},rb=a=>new TextEncoder().encode(a),ib=a=>new TextDecoder().decode(a);class nb{constructor(r,t,n){this.name=r,this.prefix=t,this.baseEncode=n}encode(r){if(r instanceof Uint8Array)return`${this.prefix}${this.baseEncode(r)}`;throw Error("Unknown type, must be binary type")}}class sb{constructor(r,t,n){if(this.name=r,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(r){if(typeof r=="string"){if(r.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(r)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(r.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(r){return Tf(this,r)}}class ob{constructor(r){this.decoders=r}or(r){return Tf(this,r)}decode(r){const t=r[0],n=this.decoders[t];if(n)return n.decode(r);throw RangeError(`Unable to decode multibase string ${JSON.stringify(r)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Tf=(a,r)=>new ob({...a.decoders||{[a.prefix]:a},...r.decoders||{[r.prefix]:r}});class ab{constructor(r,t,n,s){this.name=r,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new nb(r,t,n),this.decoder=new sb(r,t,s)}encode(r){return this.encoder.encode(r)}decode(r){return this.decoder.decode(r)}}const Eo=({name:a,prefix:r,encode:t,decode:n})=>new ab(a,r,t,n),ts=({prefix:a,name:r,alphabet:t})=>{const{encode:n,decode:s}=tb(t,r);return Eo({prefix:a,name:r,encode:n,decode:c=>Rf(s(c))})},cb=(a,r,t,n)=>{const s={};for(let S=0;S<r.length;++S)s[r[S]]=S;let c=a.length;for(;a[c-1]==="=";)--c;const l=new Uint8Array(c*t/8|0);let d=0,_=0,y=0;for(let S=0;S<c;++S){const L=s[a[S]];if(L===void 0)throw new SyntaxError(`Non-${n} character`);_=_<<t|L,d+=t,d>=8&&(d-=8,l[y++]=255&_>>d)}if(d>=t||255&_<<8-d)throw new SyntaxError("Unexpected end of data");return l},ub=(a,r,t)=>{const n=r[r.length-1]==="=",s=(1<<t)-1;let c="",l=0,d=0;for(let _=0;_<a.length;++_)for(d=d<<8|a[_],l+=8;l>t;)l-=t,c+=r[s&d>>l];if(l&&(c+=r[s&d<<t-l]),n)for(;c.length*t&7;)c+="=";return c},Bt=({name:a,prefix:r,bitsPerChar:t,alphabet:n})=>Eo({prefix:r,name:a,encode(s){return ub(s,n,t)},decode(s){return cb(s,n,t,a)}}),hb=Eo({prefix:"\0",name:"identity",encode:a=>ib(a),decode:a=>rb(a)});var lb=Object.freeze({__proto__:null,identity:hb});const fb=Bt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var pb=Object.freeze({__proto__:null,base2:fb});const db=Bt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var gb=Object.freeze({__proto__:null,base8:db});const yb=ts({prefix:"9",name:"base10",alphabet:"0123456789"});var vb=Object.freeze({__proto__:null,base10:yb});const _b=Bt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),mb=Bt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var wb=Object.freeze({__proto__:null,base16:_b,base16upper:mb});const bb=Bt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Eb=Bt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),xb=Bt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ib=Bt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Sb=Bt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Pb=Bt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ob=Bt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Rb=Bt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Tb=Bt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Cb=Object.freeze({__proto__:null,base32:bb,base32upper:Eb,base32pad:xb,base32padupper:Ib,base32hex:Sb,base32hexupper:Pb,base32hexpad:Ob,base32hexpadupper:Rb,base32z:Tb});const Ab=ts({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),$b=ts({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Nb=Object.freeze({__proto__:null,base36:Ab,base36upper:$b});const Db=ts({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Fb=ts({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var jb=Object.freeze({__proto__:null,base58btc:Db,base58flickr:Fb});const Lb=Bt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),qb=Bt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Mb=Bt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ub=Bt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var zb=Object.freeze({__proto__:null,base64:Lb,base64pad:qb,base64url:Mb,base64urlpad:Ub});const Cf=Array.from(""),Hb=Cf.reduce((a,r,t)=>(a[t]=r,a),[]),Bb=Cf.reduce((a,r,t)=>(a[r.codePointAt(0)]=t,a),[]);function kb(a){return a.reduce((r,t)=>(r+=Hb[t],r),"")}function Vb(a){const r=[];for(const t of a){const n=Bb[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);r.push(n)}return new Uint8Array(r)}const Kb=Eo({prefix:"",name:"base256emoji",encode:kb,decode:Vb});var Gb=Object.freeze({__proto__:null,base256emoji:Kb}),Wb=Af,vl=128,Jb=127,Qb=~Jb,Yb=Math.pow(2,31);function Af(a,r,t){r=r||[],t=t||0;for(var n=t;a>=Yb;)r[t++]=a&255|vl,a/=128;for(;a&Qb;)r[t++]=a&255|vl,a>>>=7;return r[t]=a|0,Af.bytes=t-n+1,r}var Xb=Ic,Zb=128,_l=127;function Ic(a,n){var t=0,n=n||0,s=0,c=n,l,d=a.length;do{if(c>=d)throw Ic.bytes=0,new RangeError("Could not decode varint");l=a[c++],t+=s<28?(l&_l)<<s:(l&_l)*Math.pow(2,s),s+=7}while(l>=Zb);return Ic.bytes=c-n,t}var eE=Math.pow(2,7),tE=Math.pow(2,14),rE=Math.pow(2,21),iE=Math.pow(2,28),nE=Math.pow(2,35),sE=Math.pow(2,42),oE=Math.pow(2,49),aE=Math.pow(2,56),cE=Math.pow(2,63),uE=function(a){return a<eE?1:a<tE?2:a<rE?3:a<iE?4:a<nE?5:a<sE?6:a<oE?7:a<aE?8:a<cE?9:10},hE={encode:Wb,decode:Xb,encodingLength:uE},$f=hE;const ml=(a,r,t=0)=>($f.encode(a,r,t),r),wl=a=>$f.encodingLength(a),Sc=(a,r)=>{const t=r.byteLength,n=wl(a),s=n+wl(t),c=new Uint8Array(s+t);return ml(a,c,0),ml(t,c,n),c.set(r,s),new lE(a,t,r,c)};class lE{constructor(r,t,n,s){this.code=r,this.size=t,this.digest=n,this.bytes=s}}const Nf=({name:a,code:r,encode:t})=>new fE(a,r,t);class fE{constructor(r,t,n){this.name=r,this.code=t,this.encode=n}digest(r){if(r instanceof Uint8Array){const t=this.encode(r);return t instanceof Uint8Array?Sc(this.code,t):t.then(n=>Sc(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Df=a=>async r=>new Uint8Array(await crypto.subtle.digest(a,r)),pE=Nf({name:"sha2-256",code:18,encode:Df("SHA-256")}),dE=Nf({name:"sha2-512",code:19,encode:Df("SHA-512")});var gE=Object.freeze({__proto__:null,sha256:pE,sha512:dE});const Ff=0,yE="identity",jf=Rf,vE=a=>Sc(Ff,jf(a)),_E={code:Ff,name:yE,encode:jf,digest:vE};var mE=Object.freeze({__proto__:null,identity:_E});new TextEncoder,new TextDecoder;const bl={...lb,...pb,...gb,...vb,...wb,...Cb,...Nb,...jb,...zb,...Gb};({...gE,...mE});function Lf(a){return globalThis.Buffer!=null?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function wE(a=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Lf(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}function qf(a,r,t,n){return{name:a,prefix:r,encoder:{name:a,prefix:r,encode:t},decoder:{decode:n}}}const El=qf("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),tc=qf("ascii","a",a=>{let r="a";for(let t=0;t<a.length;t++)r+=String.fromCharCode(a[t]);return r},a=>{a=a.substring(1);const r=wE(a.length);for(let t=0;t<a.length;t++)r[t]=a.charCodeAt(t);return r}),bE={utf8:El,"utf-8":El,hex:bl.base16,latin1:tc,ascii:tc,binary:tc,...bl};function EE(a,r="utf8"){const t=bE[r];if(!t)throw new Error(`Unsupported encoding "${r}"`);return(r==="utf8"||r==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Lf(globalThis.Buffer.from(a,"utf-8")):t.decoder.decode(`${t.prefix}${a}`)}const Mf="wc",xE=2,Mc="core",wi=`${Mf}@2:${Mc}:`,IE={name:Mc,logger:"error"},SE={database:":memory:"},PE="crypto",xl="client_ed25519_seed",OE=ie.ONE_DAY,RE="keychain",TE="0.3",CE="messages",AE="0.3",$E=ie.SIX_HOURS,NE="publisher",Uf="irn",DE="error",zf="wss://relay.walletconnect.com",Il="wss://relay.walletconnect.org",FE="relayer",Kt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},jE="_subscription",ni={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},LE=ie.ONE_SECOND,qE="2.10.0",ME=1e4,UE="0.3",zE="WALLETCONNECT_CLIENT_ID",Br={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},HE="subscription",BE="0.3",kE=ie.FIVE_SECONDS*1e3,VE="pairing",KE="0.3",qn={wc_pairingDelete:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:0},res:{ttl:ie.ONE_DAY,prompt:!1,tag:0}}},Hr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},GE="history",WE="0.3",JE="expirer",Ir={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},QE="0.3",rc="verify-api",fo="https://verify.walletconnect.com",Sl="https://verify.walletconnect.org";class YE{constructor(r,t){this.core=r,this.logger=t,this.keychain=new Map,this.name=RE,this.version=TE,this.initialized=!1,this.storagePrefix=wi,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,s)=>{this.isInitialized(),this.keychain.set(n,s),await this.persist()},this.get=n=>{this.isInitialized();const s=this.keychain.get(n);if(typeof s>"u"){const{message:c}=ee("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(c)}return s},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=r,this.logger=$e.generateChildLogger(t,this.name)}get context(){return $e.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(r){await this.core.storage.setItem(this.storageKey,sf(r))}async getKeyChain(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?of(r):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:r}=ee("NOT_INITIALIZED",this.name);throw new Error(r)}}}class XE{constructor(r,t,n){this.core=r,this.logger=t,this.name=PE,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=s=>(this.isInitialized(),this.keychain.has(s)),this.getClientId=async()=>{this.isInitialized();const s=await this.getClientSeed(),c=ul(s);return mf(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const s=C_();return this.setPrivateKey(s.publicKey,s.privateKey)},this.signJWT=async s=>{this.isInitialized();const c=await this.getClientSeed(),l=ul(c),d=hc();return await cw(d,s,OE,l)},this.generateSharedKey=(s,c,l)=>{this.isInitialized();const d=this.getPrivateKey(s),_=A_(d,c);return this.setSymKey(_,l)},this.setSymKey=async(s,c)=>{this.isInitialized();const l=c||$_(s);return await this.keychain.set(l,s),l},this.deleteKeyPair=async s=>{this.isInitialized(),await this.keychain.del(s)},this.deleteSymKey=async s=>{this.isInitialized(),await this.keychain.del(s)},this.encode=async(s,c,l)=>{this.isInitialized();const d=N_(l),_=Qn(c);if(Bh(d)){const R=d.senderPublicKey,F=d.receiverPublicKey;s=await this.generateSharedKey(R,F)}const y=this.getSymKey(s),{type:S,senderPublicKey:L}=d;return D_({type:S,symKey:y,message:_,senderPublicKey:L})},this.decode=async(s,c,l)=>{this.isInitialized();const d=F_(c,l);if(Bh(d)){const _=d.receiverPublicKey,y=d.senderPublicKey;s=await this.generateSharedKey(_,y)}try{const _=this.getSymKey(s),y=j_({symKey:_,encoded:c});return Nc(y)}catch(_){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(_)}},this.getPayloadType=s=>{const c=kh(s);return L_(c.type)},this.getPayloadSenderPublicKey=s=>{const c=kh(s);return c.senderPublicKey?vo(c.senderPublicKey,q_):void 0},this.core=r,this.logger=$e.generateChildLogger(t,this.name),this.keychain=n||new YE(this.core,this.logger)}get context(){return $e.getLoggerContext(this.logger)}async setPrivateKey(r,t){return await this.keychain.set(r,t),r}getPrivateKey(r){return this.keychain.get(r)}async getClientSeed(){let r="";try{r=this.keychain.get(xl)}catch{r=hc(),await this.keychain.set(xl,r)}return EE(r,"base16")}getSymKey(r){return this.keychain.get(r)}isInitialized(){if(!this.initialized){const{message:r}=ee("NOT_INITIALIZED",this.name);throw new Error(r)}}}class ZE extends q1{constructor(r,t){super(r,t),this.logger=r,this.core=t,this.messages=new Map,this.name=CE,this.version=AE,this.initialized=!1,this.storagePrefix=wi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,s)=>{this.isInitialized();const c=ln(s);let l=this.messages.get(n);return typeof l>"u"&&(l={}),typeof l[c]<"u"||(l[c]=s,this.messages.set(n,l),await this.persist()),c},this.get=n=>{this.isInitialized();let s=this.messages.get(n);return typeof s>"u"&&(s={}),s},this.has=(n,s)=>{this.isInitialized();const c=this.get(n),l=ln(s);return typeof c[l]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=$e.generateChildLogger(r,this.name),this.core=t}get context(){return $e.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(r){await this.core.storage.setItem(this.storageKey,sf(r))}async getRelayerMessages(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?of(r):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:r}=ee("NOT_INITIALIZED",this.name);throw new Error(r)}}}class ex extends M1{constructor(r,t){super(r,t),this.relayer=r,this.logger=t,this.events=new Pr.EventEmitter,this.name=NE,this.queue=new Map,this.publishTimeout=ie.toMiliseconds(ie.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,s,c)=>{var l;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:c}});try{const d=(c==null?void 0:c.ttl)||$E,_=lc(c),y=(c==null?void 0:c.prompt)||!1,S=(c==null?void 0:c.tag)||0,L=(c==null?void 0:c.id)||Sf().toString(),R={topic:n,message:s,opts:{ttl:d,relay:_,prompt:y,tag:S,id:L}},F=setTimeout(()=>this.queue.set(L,R),this.publishTimeout);try{await await Kn(this.rpcPublish(n,s,d,_,y,S,L),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(L),this.relayer.events.emit(Kt.publish,R)}catch(H){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(l=c==null?void 0:c.internal)!=null&&l.throwOnFailedPublish)throw this.removeRequestFromQueue(L),H;return}finally{clearTimeout(F)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:c}})}catch(d){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(d),d}},this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.relayer=r,this.logger=$e.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return $e.getLoggerContext(this.logger)}rpcPublish(r,t,n,s,c,l,d){var _,y,S,L;const R={method:ho(s.protocol).publish,params:{topic:r,message:t,ttl:n,prompt:c,tag:l},id:d};return mi((_=R.params)==null?void 0:_.prompt)&&((y=R.params)==null||delete y.prompt),mi((S=R.params)==null?void 0:S.tag)&&((L=R.params)==null||delete L.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:R}),this.relayer.request(R)}removeRequestFromQueue(r){this.queue.delete(r)}checkQueue(){this.queue.forEach(async r=>{const{topic:t,message:n,opts:s}=r;await this.publish(t,n,s)})}registerEventListeners(){this.relayer.core.heartbeat.on(pn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Kt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Kt.message_ack,r=>{this.removeRequestFromQueue(r.id.toString())})}}class tx{constructor(){this.map=new Map,this.set=(r,t)=>{const n=this.get(r);this.exists(r,t)||this.map.set(r,[...n,t])},this.get=r=>this.map.get(r)||[],this.exists=(r,t)=>this.get(r).includes(t),this.delete=(r,t)=>{if(typeof t>"u"){this.map.delete(r);return}if(!this.map.has(r))return;const n=this.get(r);if(!this.exists(r,t))return;const s=n.filter(c=>c!==t);if(!s.length){this.map.delete(r);return}this.map.set(r,s)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var rx=Object.defineProperty,ix=Object.defineProperties,nx=Object.getOwnPropertyDescriptors,Pl=Object.getOwnPropertySymbols,sx=Object.prototype.hasOwnProperty,ox=Object.prototype.propertyIsEnumerable,Ol=(a,r,t)=>r in a?rx(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,Mn=(a,r)=>{for(var t in r||(r={}))sx.call(r,t)&&Ol(a,t,r[t]);if(Pl)for(var t of Pl(r))ox.call(r,t)&&Ol(a,t,r[t]);return a},ic=(a,r)=>ix(a,nx(r));class ax extends H1{constructor(r,t){super(r,t),this.relayer=r,this.logger=t,this.subscriptions=new Map,this.topicMap=new tx,this.events=new Pr.EventEmitter,this.name=HE,this.version=BE,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=wi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,s)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}});try{const c=lc(s),l={topic:n,relay:c};this.pending.set(n,l);const d=await this.rpcSubscribe(n,c);return this.onSubscribe(d,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}}),d}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(n,s)=>{await this.restartToComplete(),this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(n,s.id,s):await this.unsubscribeByTopic(n,s)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((s,c)=>{const l=new ie.Watch;l.start(this.pendingSubscriptionWatchLabel);const d=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(d),l.stop(this.pendingSubscriptionWatchLabel),s(!0)),l.elapsed(this.pendingSubscriptionWatchLabel)>=kE&&(clearInterval(d),l.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=r,this.logger=$e.generateChildLogger(t,this.name),this.clientId=""}get context(){return $e.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(r,t){let n=!1;try{n=this.getSubscription(r).topic===t}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(r,t){const n=this.topicMap.get(r);await Promise.all(n.map(async s=>await this.unsubscribeById(r,s,t)))}async unsubscribeById(r,t,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:t,opts:n}});try{const s=lc(n);await this.rpcUnsubscribe(r,t,s);const c=er("USER_DISCONNECTED",`${this.name}, ${r}`);await this.onUnsubscribe(r,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:t,opts:n}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(r,t){const n={method:ho(t.protocol).subscribe,params:{topic:r}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Kn(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Kt.connection_stalled)}return ln(r+this.clientId)}async rpcBatchSubscribe(r){if(!r.length)return;const t=r[0].relay,n={method:ho(t.protocol).batchSubscribe,params:{topics:r.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await Kn(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Kt.connection_stalled)}}rpcUnsubscribe(r,t,n){const s={method:ho(n.protocol).unsubscribe,params:{topic:r,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(r,t){this.setSubscription(r,ic(Mn({},t),{id:r})),this.pending.delete(t.topic)}onBatchSubscribe(r){r.length&&r.forEach(t=>{this.setSubscription(t.id,Mn({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(r,t,n){this.events.removeAllListeners(t),this.hasSubscription(t,r)&&this.deleteSubscription(t,n),await this.relayer.messages.del(r)}async setRelayerSubscriptions(r){await this.relayer.core.storage.setItem(this.storageKey,r)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(r,t){this.subscriptions.has(r)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:r,subscription:t}),this.addSubscription(r,t))}addSubscription(r,t){this.subscriptions.set(r,Mn({},t)),this.topicMap.set(t.topic,r),this.events.emit(Br.created,t)}getSubscription(r){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:r});const t=this.subscriptions.get(r);if(!t){const{message:n}=ee("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return t}deleteSubscription(r,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:r,reason:t});const n=this.getSubscription(r);this.subscriptions.delete(r),this.topicMap.delete(n.topic,r),this.events.emit(Br.deleted,ic(Mn({},n),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Br.sync)}async reset(){if(this.cached.length){const r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<r;t++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Br.resubscribed)}async restore(){try{const r=await this.getRelayerSubscriptions();if(typeof r>"u"||!r.length)return;if(this.subscriptions.size){const{message:t}=ee("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=r,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(r){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(r)}}async batchSubscribe(r){if(!r.length)return;const t=await this.rpcBatchSubscribe(r);fn(t)&&this.onBatchSubscribe(t.map((n,s)=>ic(Mn({},r[s]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const r=[];this.pending.forEach(t=>{r.push(t)}),await this.batchSubscribe(r)}registerEventListeners(){this.relayer.core.heartbeat.on(pn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Kt.connect,async()=>{await this.onConnect()}),this.relayer.on(Kt.disconnect,()=>{this.onDisconnect()}),this.events.on(Br.created,async r=>{const t=Br.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),await this.persist()}),this.events.on(Br.deleted,async r=>{const t=Br.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=ee("NOT_INITIALIZED",this.name);throw new Error(r)}}async restartToComplete(){this.restartInProgress&&await new Promise(r=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),r())},this.pollingInterval)})}}var cx=Object.defineProperty,Rl=Object.getOwnPropertySymbols,ux=Object.prototype.hasOwnProperty,hx=Object.prototype.propertyIsEnumerable,Tl=(a,r,t)=>r in a?cx(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,lx=(a,r)=>{for(var t in r||(r={}))ux.call(r,t)&&Tl(a,t,r[t]);if(Rl)for(var t of Rl(r))hx.call(r,t)&&Tl(a,t,r[t]);return a};class fx extends U1{constructor(r){super(r),this.protocol="wc",this.version=2,this.events=new Pr.EventEmitter,this.name=FE,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async t=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(t)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=t=>{this.onProviderPayload(t)},this.onConnectHandler=()=>{this.events.emit(Kt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(Kt.error,t)},this.registerProviderListeners=()=>{this.provider.on(ni.payload,this.onPayloadHandler),this.provider.on(ni.connect,this.onConnectHandler),this.provider.on(ni.disconnect,this.onDisconnectHandler),this.provider.on(ni.error,this.onProviderErrorHandler)},this.core=r.core,this.logger=typeof r.logger<"u"&&typeof r.logger!="string"?$e.generateChildLogger(r.logger,this.name):$e.pino($e.getDefaultLoggerOptions({level:r.logger||DE})),this.messages=new ZE(this.logger,r.core),this.subscriber=new ax(this,this.logger),this.publisher=new ex(this,this.logger),this.relayUrl=(r==null?void 0:r.relayUrl)||zf,this.projectId=r.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Il}...`),await this.restartTransport(Il)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},ME)}get context(){return $e.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(r,t,n){this.isInitialized(),await this.publisher.publish(r,t,n),await this.recordMessageEvent({topic:r,message:t,publishedAt:Date.now()})}async subscribe(r,t){var n;this.isInitialized();let s=((n=this.subscriber.topicMap.get(r))==null?void 0:n[0])||"";return s||(await Promise.all([new Promise(c=>{this.subscriber.once(Br.created,l=>{l.topic===r&&c()})}),new Promise(async c=>{s=await this.subscriber.subscribe(r,t),c()})]),s)}async unsubscribe(r,t){this.isInitialized(),await this.subscriber.unsubscribe(r,t)}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}off(r,t){this.events.off(r,t)}removeListener(r,t){this.events.removeListener(r,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Kn(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(r){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){r&&r!==this.relayUrl&&(this.relayUrl=r,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(t=>{if(!this.initialized)return t();this.subscriber.once(Br.resubscribed,()=>{t()})}),new Promise(async(t,n)=>{try{await Kn(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(s){n(s);return}t()})])}catch(t){this.logger.error(t);const n=t;if(!this.isConnectionStalled(n.message))throw t;this.provider.events.emit(ni.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(r){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=r||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Vh())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(r){return this.staleConnectionErrors.some(t=>r.includes(t))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const r=await this.core.crypto.signJWT(this.relayUrl);this.provider=new bi(new Qw(M_({sdkVersion:qE,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:r,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(r){const{topic:t,message:n}=r;await this.messages.set(t,n)}async shouldIgnoreMessageEvent(r){const{topic:t,message:n}=r;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const s=this.messages.has(t,n);return s&&this.logger.debug(`Ignoring duplicate message: ${n}`),s}async onProviderPayload(r){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:r}),qc(r)){if(!r.method.endsWith(jE))return;const t=r.params,{topic:n,message:s,publishedAt:c}=t.data,l={topic:n,message:s,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(lx({type:"event",event:t.id},l)),this.events.emit(t.id,l),await this.acknowledgePayload(r),await this.onMessageEvent(l)}else bo(r)&&this.events.emit(Kt.message_ack,r)}async onMessageEvent(r){await this.shouldIgnoreMessageEvent(r)||(this.events.emit(Kt.message,r),await this.recordMessageEvent(r))}async acknowledgePayload(r){const t=Lc(r.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(ni.payload,this.onPayloadHandler),this.provider.off(ni.connect,this.onConnectHandler),this.provider.off(ni.disconnect,this.onDisconnectHandler),this.provider.off(ni.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Kt.connection_stalled,()=>{this.restartTransport().catch(t=>this.logger.error(t))});let r=await Vh();U_(async t=>{this.initialized&&r!==t&&(r=t,t?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(Kt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(r=>this.logger.error(r))},ie.toMiliseconds(LE)))}isInitialized(){if(!this.initialized){const{message:r}=ee("NOT_INITIALIZED",this.name);throw new Error(r)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(r=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),r())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var px=Object.defineProperty,Cl=Object.getOwnPropertySymbols,dx=Object.prototype.hasOwnProperty,gx=Object.prototype.propertyIsEnumerable,Al=(a,r,t)=>r in a?px(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,$l=(a,r)=>{for(var t in r||(r={}))dx.call(r,t)&&Al(a,t,r[t]);if(Cl)for(var t of Cl(r))gx.call(r,t)&&Al(a,t,r[t]);return a};class xo extends z1{constructor(r,t,n,s=wi,c=void 0){super(r,t,n,s),this.core=r,this.logger=t,this.name=n,this.map=new Map,this.version=UE,this.cached=[],this.initialized=!1,this.storagePrefix=wi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{this.getKey&&l!==null&&!mi(l)?this.map.set(this.getKey(l),l):R_(l)?this.map.set(l.id,l):T_(l)&&this.map.set(l.topic,l)}),this.cached=[],this.initialized=!0)},this.set=async(l,d)=>{this.isInitialized(),this.map.has(l)?await this.update(l,d):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:d}),this.map.set(l,d),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(d=>Object.keys(l).every(_=>Xw(d[_],l[_]))):this.values),this.update=async(l,d)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:d});const _=$l($l({},this.getData(l)),d);this.map.set(l,_),await this.persist()},this.delete=async(l,d)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:d}),this.map.delete(l),await this.persist())},this.logger=$e.generateChildLogger(t,this.name),this.storagePrefix=s,this.getKey=c}get context(){return $e.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(r){await this.core.storage.setItem(this.storageKey,r)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(r){const t=this.map.get(r);if(!t){const{message:n}=ee("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(n),new Error(n)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const r=await this.getDataStore();if(typeof r>"u"||!r.length)return;if(this.map.size){const{message:t}=ee("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=r,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(r){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(r)}}isInitialized(){if(!this.initialized){const{message:r}=ee("NOT_INITIALIZED",this.name);throw new Error(r)}}}class yx{constructor(r,t){this.core=r,this.logger=t,this.name=VE,this.version=KE,this.events=new $c,this.initialized=!1,this.storagePrefix=wi,this.ignoredPayloadTypes=[tf],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=hc(),s=await this.core.crypto.setSymKey(n),c=Nr(ie.FIVE_MINUTES),l={protocol:Uf},d={topic:s,expiry:c,relay:l,active:!1},_=z_({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:n,relay:l});return await this.pairings.set(s,d),await this.core.relayer.subscribe(s),this.core.expirer.set(s,c),{topic:s,uri:_}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:s,symKey:c,relay:l}=H_(n.uri);if(this.pairings.keys.includes(s))throw new Error(`Pairing already exists: ${s}`);if(this.core.crypto.hasKeys(s))throw new Error(`Keychain already exists: ${s}`);const d=Nr(ie.FIVE_MINUTES),_={topic:s,relay:l,expiry:d,active:!1};return await this.pairings.set(s,_),await this.core.crypto.setSymKey(c,s),await this.core.relayer.subscribe(s,{relay:l}),this.core.expirer.set(s,d),n.activatePairing&&await this.activate({topic:s}),_},this.activate=async({topic:n})=>{this.isInitialized();const s=Nr(ie.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:s}),this.core.expirer.set(n,s)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:s}=n;if(this.pairings.keys.includes(s)){const c=await this.sendRequest(s,"wc_pairingPing",{}),{done:l,resolve:d,reject:_}=cn();this.events.once(Nt("pairing_ping",c),({error:y})=>{y?_(y):d()}),await l()}},this.updateExpiry=async({topic:n,expiry:s})=>{this.isInitialized(),await this.pairings.update(n,{expiry:s})},this.updateMetadata=async({topic:n,metadata:s})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:s})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:s}=n;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",er("USER_DISCONNECTED")),await this.deletePairing(s))},this.sendRequest=async(n,s,c)=>{const l=Xn(s,c),d=await this.core.crypto.encode(n,l),_=qn[s].req;return this.core.history.set(n,l),this.core.relayer.publish(n,d,_),l.id},this.sendResult=async(n,s,c)=>{const l=Lc(n,c),d=await this.core.crypto.encode(s,l),_=await this.core.history.get(s,n),y=qn[_.request.method].res;await this.core.relayer.publish(s,d,y),await this.core.history.resolve(l)},this.sendError=async(n,s,c)=>{const l=wo(n,c),d=await this.core.crypto.encode(s,l),_=await this.core.history.get(s,n),y=qn[_.request.method]?qn[_.request.method].res:qn.unregistered_method.res;await this.core.relayer.publish(s,d,y),await this.core.history.resolve(l)},this.deletePairing=async(n,s)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,er("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),s?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(s=>_i(s.expiry));await Promise.all(n.map(s=>this.deletePairing(s.topic)))},this.onRelayEventRequest=n=>{const{topic:s,payload:c}=n;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(s,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(s,c);default:return this.onUnknownRpcMethodRequest(s,c)}},this.onRelayEventResponse=async n=>{const{topic:s,payload:c}=n,l=(await this.core.history.get(s,c.id)).request.method;switch(l){case"wc_pairingPing":return this.onPairingPingResponse(s,c);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(n,s)=>{const{id:c}=s;try{this.isValidPing({topic:n}),await this.sendResult(c,n,!0),this.events.emit("pairing_ping",{id:c,topic:n})}catch(l){await this.sendError(c,n,l),this.logger.error(l)}},this.onPairingPingResponse=(n,s)=>{const{id:c}=s;setTimeout(()=>{oi(s)?this.events.emit(Nt("pairing_ping",c),{}):Dr(s)&&this.events.emit(Nt("pairing_ping",c),{error:s.error})},500)},this.onPairingDeleteRequest=async(n,s)=>{const{id:c}=s;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit("pairing_delete",{id:c,topic:n})}catch(l){await this.sendError(c,n,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(n,s)=>{const{id:c,method:l}=s;try{if(this.registeredMethods.includes(l))return;const d=er("WC_METHOD_UNSUPPORTED",l);await this.sendError(c,n,d),this.logger.error(d)}catch(d){await this.sendError(c,n,d),this.logger.error(d)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(er("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!cr(n)){const{message:s}=ee("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(s)}if(!B_(n.uri)){const{message:s}=ee("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(s)}},this.isValidPing=async n=>{if(!cr(n)){const{message:c}=ee("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(c)}const{topic:s}=n;await this.isValidPairingTopic(s)},this.isValidDisconnect=async n=>{if(!cr(n)){const{message:c}=ee("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(c)}const{topic:s}=n;await this.isValidPairingTopic(s)},this.isValidPairingTopic=async n=>{if(!un(n,!1)){const{message:s}=ee("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(s)}if(!this.pairings.keys.includes(n)){const{message:s}=ee("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(s)}if(_i(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:s}=ee("EXPIRED",`pairing topic: ${n}`);throw new Error(s)}},this.core=r,this.logger=$e.generateChildLogger(t,this.name),this.pairings=new xo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return $e.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:r}=ee("NOT_INITIALIZED",this.name);throw new Error(r)}}registerRelayerEvents(){this.core.relayer.on(Kt.message,async r=>{const{topic:t,message:n}=r;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const s=await this.core.crypto.decode(t,n);try{qc(s)?(this.core.history.set(t,s),this.onRelayEventRequest({topic:t,payload:s})):bo(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:t,payload:s}),this.core.history.delete(t,s.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Ir.expired,async r=>{const{topic:t}=rf(r.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))})}}class vx extends L1{constructor(r,t){super(r,t),this.core=r,this.logger=t,this.records=new Map,this.events=new Pr.EventEmitter,this.name=GE,this.version=WE,this.cached=[],this.initialized=!1,this.storagePrefix=wi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,s,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:s,chainId:c}),this.records.has(s.id))return;const l={id:s.id,topic:n,request:{method:s.method,params:s.params||null},chainId:c,expiry:Nr(ie.THIRTY_DAYS)};this.records.set(l.id,l),this.events.emit(Hr.created,l)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const s=await this.getRecord(n.id);typeof s.response>"u"&&(s.response=Dr(n)?{error:n.error}:{result:n.result},this.records.set(s.id,s),this.events.emit(Hr.updated,s))},this.get=async(n,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:s}),await this.getRecord(s)),this.delete=(n,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(c=>{if(c.topic===n){if(typeof s<"u"&&c.id!==s)return;this.records.delete(c.id),this.events.emit(Hr.deleted,c)}})},this.exists=async(n,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===n:!1),this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.logger=$e.generateChildLogger(t,this.name)}get context(){return $e.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const r=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const n={topic:t.topic,request:Xn(t.request.method,t.request.params,t.id),chainId:t.chainId};return r.push(n)}),r}async setJsonRpcRecords(r){await this.core.storage.setItem(this.storageKey,r)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(r){this.isInitialized();const t=this.records.get(r);if(!t){const{message:n}=ee("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Hr.sync)}async restore(){try{const r=await this.getJsonRpcRecords();if(typeof r>"u"||!r.length)return;if(this.records.size){const{message:t}=ee("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=r,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}}registerEventListeners(){this.events.on(Hr.created,r=>{const t=Hr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:r}),this.persist()}),this.events.on(Hr.updated,r=>{const t=Hr.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:r}),this.persist()}),this.events.on(Hr.deleted,r=>{const t=Hr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:r}),this.persist()}),this.core.heartbeat.on(pn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(r=>{ie.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.delete(r.topic,r.id))})}catch(r){this.logger.warn(r)}}isInitialized(){if(!this.initialized){const{message:r}=ee("NOT_INITIALIZED",this.name);throw new Error(r)}}}class _x extends B1{constructor(r,t){super(r,t),this.core=r,this.logger=t,this.expirations=new Map,this.events=new Pr.EventEmitter,this.name=JE,this.version=QE,this.cached=[],this.initialized=!1,this.storagePrefix=wi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const s=this.formatTarget(n);return typeof this.getExpiration(s)<"u"}catch{return!1}},this.set=(n,s)=>{this.isInitialized();const c=this.formatTarget(n),l={target:c,expiry:s};this.expirations.set(c,l),this.checkExpiry(c,l),this.events.emit(Ir.created,{target:c,expiration:l})},this.get=n=>{this.isInitialized();const s=this.formatTarget(n);return this.getExpiration(s)},this.del=n=>{if(this.isInitialized(),this.has(n)){const s=this.formatTarget(n),c=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Ir.deleted,{target:s,expiration:c})}},this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.logger=$e.generateChildLogger(t,this.name)}get context(){return $e.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(r){if(typeof r=="string")return k_(r);if(typeof r=="number")return V_(r);const{message:t}=ee("UNKNOWN_TYPE",`Target type: ${typeof r}`);throw new Error(t)}async setExpirations(r){await this.core.storage.setItem(this.storageKey,r)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Ir.sync)}async restore(){try{const r=await this.getExpirations();if(typeof r>"u"||!r.length)return;if(this.expirations.size){const{message:t}=ee("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=r,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(r){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(r)}}getExpiration(r){const t=this.expirations.get(r);if(!t){const{message:n}=ee("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(n),new Error(n)}return t}checkExpiry(r,t){const{expiry:n}=t;ie.toMiliseconds(n)-Date.now()<=0&&this.expire(r,t)}expire(r,t){this.expirations.delete(r),this.events.emit(Ir.expired,{target:r,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((r,t)=>this.checkExpiry(t,r))}registerEventListeners(){this.core.heartbeat.on(pn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Ir.created,r=>{const t=Ir.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),this.persist()}),this.events.on(Ir.expired,r=>{const t=Ir.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),this.persist()}),this.events.on(Ir.deleted,r=>{const t=Ir.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=ee("NOT_INITIALIZED",this.name);throw new Error(r)}}}class mx extends k1{constructor(r,t){super(r,t),this.projectId=r,this.logger=t,this.name=rc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async n=>{if(this.verifyDisabled||K_()||!nf())return;const s=(n==null?void 0:n.verifyUrl)||fo;this.verifyUrl!==s&&this.removeIframe(),this.verifyUrl=s;try{await this.createIframe()}catch(c){this.logger.warn(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.warn(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Sl;try{await this.createIframe()}catch(c){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(c),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const s=(n==null?void 0:n.verifyUrl)||fo;let c="";try{c=await this.fetchAttestation(n.attestationId,s)}catch(l){this.logger.warn(`failed to resolve attestation: ${n.attestationId} from url: ${s}`),this.logger.warn(l),c=await this.fetchAttestation(n.attestationId,Sl)}return c},this.fetchAttestation=async(n,s)=>{var c;this.logger.info(`resolving attestation: ${n} from url: ${s}`);const l=this.startAbortTimer(ie.ONE_SECOND*2),d=await fetch(`${s}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(l),d.status===200?(c=await d.json())==null?void 0:c.origin:""},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var s;try{if(!this.iframe)return;(s=this.iframe.contentWindow)==null||s.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const s=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",s),n())};await Promise.race([new Promise(c=>{if(document.getElementById(rc))return c();window.addEventListener("message",s);const l=document.createElement("iframe");l.id=rc,l.src=`${this.verifyUrl}/${this.projectId}`,l.style.display="none",document.body.append(l),this.iframe=l,n=c}),new Promise((c,l)=>setTimeout(()=>{window.removeEventListener("message",s),l("verify iframe load timeout")},ie.toMiliseconds(ie.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=$e.generateChildLogger(t,this.name),this.verifyUrl=fo,this.abortController=new AbortController,this.isDevEnv=G_()&&{}.IS_VITEST}get context(){return $e.getLoggerContext(this.logger)}startAbortTimer(r){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ie.toMiliseconds(r))}}var wx=Object.defineProperty,Nl=Object.getOwnPropertySymbols,bx=Object.prototype.hasOwnProperty,Ex=Object.prototype.propertyIsEnumerable,Dl=(a,r,t)=>r in a?wx(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,Fl=(a,r)=>{for(var t in r||(r={}))bx.call(r,t)&&Dl(a,t,r[t]);if(Nl)for(var t of Nl(r))Ex.call(r,t)&&Dl(a,t,r[t]);return a};class Uc extends j1{constructor(r){super(r),this.protocol=Mf,this.version=xE,this.name=Mc,this.events=new Pr.EventEmitter,this.initialized=!1,this.on=(n,s)=>this.events.on(n,s),this.once=(n,s)=>this.events.once(n,s),this.off=(n,s)=>this.events.off(n,s),this.removeListener=(n,s)=>this.events.removeListener(n,s),this.projectId=r==null?void 0:r.projectId,this.relayUrl=(r==null?void 0:r.relayUrl)||zf;const t=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:$e.pino($e.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||IE.logger}));this.logger=$e.generateChildLogger(t,this.name),this.heartbeat=new pn.HeartBeat,this.crypto=new XE(this,this.logger,r==null?void 0:r.keychain),this.history=new vx(this,this.logger),this.expirer=new _x(this,this.logger),this.storage=r!=null&&r.storage?r.storage:new Um(Fl(Fl({},SE),r==null?void 0:r.storageOptions)),this.relayer=new fx({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new yx(this,this.logger),this.verify=new mx(this.projectId||"",this.logger)}static async init(r){const t=new Uc(r);await t.initialize();const n=await t.crypto.getClientId();return await t.storage.setItem(zE,n),t}get context(){return $e.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(r){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,r),this.logger.error(r.message),r}}}const xx=Uc,Hf="wc",Bf=2,kf="client",zc=`${Hf}@${Bf}:${kf}:`,nc={name:kf,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},jl="WALLETCONNECT_DEEPLINK_CHOICE",Ix="proposal",Vf="Proposal expired",Sx="session",ao=ie.SEVEN_DAYS,Px="engine",Un={wc_sessionPropose:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1115}}},sc={min:ie.FIVE_MINUTES,max:ie.SEVEN_DAYS},si={idle:"IDLE",active:"ACTIVE"},Ox="request",Rx=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Tx=Object.defineProperty,Cx=Object.defineProperties,Ax=Object.getOwnPropertyDescriptors,Ll=Object.getOwnPropertySymbols,$x=Object.prototype.hasOwnProperty,Nx=Object.prototype.propertyIsEnumerable,ql=(a,r,t)=>r in a?Tx(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,ar=(a,r)=>{for(var t in r||(r={}))$x.call(r,t)&&ql(a,t,r[t]);if(Ll)for(var t of Ll(r))Nx.call(r,t)&&ql(a,t,r[t]);return a},zn=(a,r)=>Cx(a,Ax(r));class Dx extends K1{constructor(r){super(r),this.name=Px,this.events=new $c,this.initialized=!1,this.ignoredPayloadTypes=[tf],this.requestQueue={state:si.idle,queue:[]},this.sessionRequestQueue={state:si.idle,queue:[]},this.requestQueueDelay=ie.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Un)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ie.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{await this.isInitialized();const n=zn(ar({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:s,requiredNamespaces:c,optionalNamespaces:l,sessionProperties:d,relays:_}=n;let y=s,S,L=!1;if(y&&(L=this.client.core.pairing.pairings.get(y).active),!y||!L){const{topic:le,uri:ue}=await this.client.core.pairing.create();y=le,S=ue}const R=await this.client.core.crypto.generateKeyPair(),F=ar({requiredNamespaces:c,optionalNamespaces:l,relays:_??[{protocol:Uf}],proposer:{publicKey:R,metadata:this.client.metadata}},d&&{sessionProperties:d}),{reject:H,resolve:K,done:ne}=cn(ie.FIVE_MINUTES,Vf);if(this.events.once(Nt("session_connect"),async({error:le,session:ue})=>{if(le)H(le);else if(ue){ue.self.publicKey=R;const fe=zn(ar({},ue),{requiredNamespaces:ue.requiredNamespaces,optionalNamespaces:ue.optionalNamespaces});await this.client.session.set(ue.topic,fe),await this.setExpiry(ue.topic,ue.expiry),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:ue.peer.metadata}),K(fe)}}),!y){const{message:le}=ee("NO_MATCHING_KEY",`connect() pairing topic: ${y}`);throw new Error(le)}const Ee=await this.sendRequest({topic:y,method:"wc_sessionPropose",params:F}),ge=Nr(ie.FIVE_MINUTES);return await this.setProposal(Ee,ar({id:Ee,expiry:ge},F)),{uri:S,approval:ne}},this.pair=async t=>(await this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{await this.isInitialized(),await this.isValidApprove(t);const{id:n,relayProtocol:s,namespaces:c,sessionProperties:l}=t,d=this.client.proposal.get(n);let{pairingTopic:_,proposer:y,requiredNamespaces:S,optionalNamespaces:L}=d;_=_||"",lo(S)||(S=J_(c,"approve()"));const R=await this.client.core.crypto.generateKeyPair(),F=y.publicKey,H=await this.client.core.crypto.generateSharedKey(R,F);_&&n&&(await this.client.core.pairing.updateMetadata({topic:_,metadata:y.metadata}),await this.sendResult({id:n,topic:_,result:{relay:{protocol:s??"irn"},responderPublicKey:R}}),await this.client.proposal.delete(n,er("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:_}));const K=ar({relay:{protocol:s??"irn"},namespaces:c,requiredNamespaces:S,optionalNamespaces:L,pairingTopic:_,controller:{publicKey:R,metadata:this.client.metadata},expiry:Nr(ao)},l&&{sessionProperties:l});await this.client.core.relayer.subscribe(H),await this.sendRequest({topic:H,method:"wc_sessionSettle",params:K,throwOnFailedPublish:!0});const ne=zn(ar({},K),{topic:H,pairingTopic:_,acknowledged:!1,self:K.controller,peer:{publicKey:y.publicKey,metadata:y.metadata},controller:R});return await this.client.session.set(H,ne),await this.setExpiry(H,Nr(ao)),{topic:H,acknowledged:()=>new Promise(Ee=>setTimeout(()=>Ee(this.client.session.get(H)),500))}},this.reject=async t=>{await this.isInitialized(),await this.isValidReject(t);const{id:n,reason:s}=t,{pairingTopic:c}=this.client.proposal.get(n);c&&(await this.sendError(n,c,s),await this.client.proposal.delete(n,er("USER_DISCONNECTED")))},this.update=async t=>{await this.isInitialized(),await this.isValidUpdate(t);const{topic:n,namespaces:s}=t,c=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:s}}),{done:l,resolve:d,reject:_}=cn();return this.events.once(Nt("session_update",c),({error:y})=>{y?_(y):d()}),await this.client.session.update(n,{namespaces:s}),{acknowledged:l}},this.extend=async t=>{await this.isInitialized(),await this.isValidExtend(t);const{topic:n}=t,s=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:c,resolve:l,reject:d}=cn();return this.events.once(Nt("session_extend",s),({error:_})=>{_?d(_):l()}),await this.setExpiry(n,Nr(ao)),{acknowledged:c}},this.request=async t=>{await this.isInitialized(),await this.isValidRequest(t);const{chainId:n,request:s,topic:c,expiry:l}=t,d=jc(),{done:_,resolve:y,reject:S}=cn(l);return this.events.once(Nt("session_request",d),({error:L,result:R})=>{L?S(L):y(R)}),await Promise.all([new Promise(async L=>{await this.sendRequest({clientRpcId:d,topic:c,method:"wc_sessionRequest",params:{request:s,chainId:n},expiry:l,throwOnFailedPublish:!0}).catch(R=>S(R)),this.client.events.emit("session_request_sent",{topic:c,request:s,chainId:n,id:d}),L()}),new Promise(async L=>{const R=await this.client.core.storage.getItem(jl);Q_({id:d,topic:c,wcDeepLink:R}),L()}),_()]).then(L=>L[2])},this.respond=async t=>{await this.isInitialized(),await this.isValidRespond(t);const{topic:n,response:s}=t,{id:c}=s;oi(s)?await this.sendResult({id:c,topic:n,result:s.result,throwOnFailedPublish:!0}):Dr(s)&&await this.sendError(c,n,s.error),this.cleanupAfterResponse(t)},this.ping=async t=>{await this.isInitialized(),await this.isValidPing(t);const{topic:n}=t;if(this.client.session.keys.includes(n)){const s=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:c,resolve:l,reject:d}=cn();this.events.once(Nt("session_ping",s),({error:_})=>{_?d(_):l()}),await c()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async t=>{await this.isInitialized(),await this.isValidEmit(t);const{topic:n,event:s,chainId:c}=t;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:s,chainId:c}})},this.disconnect=async t=>{await this.isInitialized(),await this.isValidDisconnect(t);const{topic:n}=t;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:er("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(n=>Y_(n,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const n=this.client.core.pairing.pairings.get(t.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(c=>{var l,d;return((l=c.peerMetadata)==null?void 0:l.url)&&((d=c.peerMetadata)==null?void 0:d.url)===t.peer.metadata.url&&c.topic&&c.topic!==n.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(t,n)=>{const{self:s}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),this.client.session.delete(t,er("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(s.publicKey)&&await this.client.core.crypto.deleteKeyPair(s.publicKey),this.client.core.crypto.keychain.has(t)&&await this.client.core.crypto.deleteSymKey(t),n||this.client.core.expirer.del(t),this.client.core.storage.removeItem(jl).catch(c=>this.client.logger.warn(c))},this.deleteProposal=async(t,n)=>{await Promise.all([this.client.proposal.delete(t,er("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,n,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,n),s?Promise.resolve():this.client.core.expirer.del(t)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==t),s&&(this.sessionRequestQueue.state=si.idle)},this.setExpiry=async(t,n)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:n}),this.client.core.expirer.set(t,n)},this.setProposal=async(t,n)=>{await this.client.proposal.set(t,n),this.client.core.expirer.set(t,n.expiry)},this.setPendingSessionRequest=async t=>{const n=Un.wc_sessionRequest.req.ttl,{id:s,topic:c,params:l}=t;await this.client.pendingRequest.set(s,{id:s,topic:c,params:l}),n&&this.client.core.expirer.set(s,Nr(n))},this.sendRequest=async t=>{const{topic:n,method:s,params:c,expiry:l,relayRpcId:d,clientRpcId:_,throwOnFailedPublish:y}=t,S=Xn(s,c,_);if(nf()&&Rx.includes(s)){const F=ln(JSON.stringify(S));this.client.core.verify.register({attestationId:F})}const L=await this.client.core.crypto.encode(n,S),R=Un[s].req;return l&&(R.ttl=l),d&&(R.id=d),this.client.core.history.set(n,S),y?(R.internal=zn(ar({},R.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,L,R)):this.client.core.relayer.publish(n,L,R).catch(F=>this.client.logger.error(F)),S.id},this.sendResult=async t=>{const{id:n,topic:s,result:c,throwOnFailedPublish:l}=t,d=Lc(n,c),_=await this.client.core.crypto.encode(s,d),y=await this.client.core.history.get(s,n),S=Un[y.request.method].res;l?(S.internal=zn(ar({},S.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,_,S)):this.client.core.relayer.publish(s,_,S).catch(L=>this.client.logger.error(L)),await this.client.core.history.resolve(d)},this.sendError=async(t,n,s)=>{const c=wo(t,s),l=await this.client.core.crypto.encode(n,c),d=await this.client.core.history.get(n,t),_=Un[d.request.method].res;this.client.core.relayer.publish(n,l,_),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],n=[];this.client.session.getAll().forEach(s=>{_i(s.expiry)&&t.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{_i(s.expiry)&&n.push(s.id)}),await Promise.all([...t.map(s=>this.deleteSession(s)),...n.map(s=>this.deleteProposal(s))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===si.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=si.active;const t=this.requestQueue.queue.shift();if(t)try{this.processRequest(t),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=si.idle},this.processRequest=t=>{const{topic:n,payload:s}=t,c=s.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(n,s);case"wc_sessionSettle":return this.onSessionSettleRequest(n,s);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,s);case"wc_sessionExtend":return this.onSessionExtendRequest(n,s);case"wc_sessionPing":return this.onSessionPingRequest(n,s);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,s);case"wc_sessionRequest":return this.onSessionRequest(n,s);case"wc_sessionEvent":return this.onSessionEventRequest(n,s);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:n,payload:s}=t,c=(await this.client.core.history.get(n,s.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(n,s);case"wc_sessionSettle":return this.onSessionSettleResponse(n,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,s);case"wc_sessionExtend":return this.onSessionExtendResponse(n,s);case"wc_sessionPing":return this.onSessionPingResponse(n,s);case"wc_sessionRequest":return this.onSessionRequestResponse(n,s);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:n}=t,{message:s}=ee("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)},this.onSessionProposeRequest=async(t,n)=>{const{params:s,id:c}=n;try{this.isValidConnect(ar({},n.params));const l=Nr(ie.FIVE_MINUTES),d=ar({id:c,pairingTopic:t,expiry:l},s);await this.setProposal(c,d);const _=ln(JSON.stringify(n)),y=await this.getVerifyContext(_,d.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:y})}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(t,n)=>{const{id:s}=n;if(oi(n)){const{result:c}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const l=this.client.proposal.get(s);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const d=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:d});const _=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:_});const y=await this.client.core.crypto.generateSharedKey(d,_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:y});const S=await this.client.core.relayer.subscribe(y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:S}),await this.client.core.pairing.activate({topic:t})}else Dr(n)&&(await this.client.proposal.delete(s,er("USER_DISCONNECTED")),this.events.emit(Nt("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(t,n)=>{const{id:s,params:c}=n;try{this.isValidSessionSettleRequest(c);const{relay:l,controller:d,expiry:_,namespaces:y,requiredNamespaces:S,optionalNamespaces:L,sessionProperties:R,pairingTopic:F}=n.params,H=ar({topic:t,relay:l,expiry:_,namespaces:y,acknowledged:!0,pairingTopic:F,requiredNamespaces:S,optionalNamespaces:L,controller:d.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:d.publicKey,metadata:d.metadata}},R&&{sessionProperties:R});await this.sendResult({id:n.id,topic:t,result:!0}),this.events.emit(Nt("session_connect"),{session:H}),this.cleanupDuplicatePairings(H)}catch(l){await this.sendError(s,t,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(t,n)=>{const{id:s}=n;oi(n)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Nt("session_approve",s),{})):Dr(n)&&(await this.client.session.delete(t,er("USER_DISCONNECTED")),this.events.emit(Nt("session_approve",s),{error:n.error}))},this.onSessionUpdateRequest=async(t,n)=>{const{params:s,id:c}=n;try{const l=`${t}_session_update`,d=oo.get(l);if(d&&this.isRequestOutOfSync(d,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(ar({topic:t},s)),await this.client.session.update(t,{namespaces:s.namespaces}),await this.sendResult({id:c,topic:t,result:!0}),this.client.events.emit("session_update",{id:c,topic:t,params:s}),oo.set(l,c)}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.isRequestOutOfSync=(t,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,n)=>{const{id:s}=n;oi(n)?this.events.emit(Nt("session_update",s),{}):Dr(n)&&this.events.emit(Nt("session_update",s),{error:n.error})},this.onSessionExtendRequest=async(t,n)=>{const{id:s}=n;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Nr(ao)),await this.sendResult({id:s,topic:t,result:!0}),this.client.events.emit("session_extend",{id:s,topic:t})}catch(c){await this.sendError(s,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,n)=>{const{id:s}=n;oi(n)?this.events.emit(Nt("session_extend",s),{}):Dr(n)&&this.events.emit(Nt("session_extend",s),{error:n.error})},this.onSessionPingRequest=async(t,n)=>{const{id:s}=n;try{this.isValidPing({topic:t}),await this.sendResult({id:s,topic:t,result:!0}),this.client.events.emit("session_ping",{id:s,topic:t})}catch(c){await this.sendError(s,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,n)=>{const{id:s}=n;setTimeout(()=>{oi(n)?this.events.emit(Nt("session_ping",s),{}):Dr(n)&&this.events.emit(Nt("session_ping",s),{error:n.error})},500)},this.onSessionDeleteRequest=async(t,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:t,reason:n.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(Kt.publish,async()=>{c(await this.deleteSession(t))})}),this.sendResult({id:s,topic:t,result:!0})]),this.client.events.emit("session_delete",{id:s,topic:t})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,n)=>{const{id:s,params:c}=n;try{this.isValidRequest(ar({topic:t},c)),await this.setPendingSessionRequest({id:s,topic:t,params:c}),this.addSessionRequestToSessionRequestQueue({id:s,topic:t,params:c}),await this.processSessionRequestQueue()}catch(l){await this.sendError(s,t,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(t,n)=>{const{id:s}=n;oi(n)?this.events.emit(Nt("session_request",s),{result:n.result}):Dr(n)&&this.events.emit(Nt("session_request",s),{error:n.error})},this.onSessionEventRequest=async(t,n)=>{const{id:s,params:c}=n;try{const l=`${t}_session_event_${c.event.name}`,d=oo.get(l);if(d&&this.isRequestOutOfSync(d,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(ar({topic:t},c)),this.client.events.emit("session_event",{id:s,topic:t,params:c}),oo.set(l,s)}catch(l){await this.sendError(s,t,l),this.client.logger.error(l)}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=si.idle,this.processSessionRequestQueue()},ie.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=async()=>{if(this.sessionRequestQueue.state===si.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{const{id:n,topic:s,params:c}=t,l=ln(JSON.stringify(Xn("wc_sessionRequest",c,n))),d=this.client.session.get(s),_=await this.getVerifyContext(l,d.peer.metadata);this.sessionRequestQueue.state=si.active,this.client.events.emit("session_request",{id:n,topic:s,params:c,verifyContext:_})}catch(n){this.client.logger.error(n)}},this.isValidConnect=async t=>{if(!cr(t)){const{message:_}=ee("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(_)}const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:c,sessionProperties:l,relays:d}=t;if(mi(n)||await this.isValidPairingTopic(n),!X_(d,!0)){const{message:_}=ee("MISSING_OR_INVALID",`connect() relays: ${d}`);throw new Error(_)}!mi(s)&&lo(s)!==0&&this.validateNamespaces(s,"requiredNamespaces"),!mi(c)&&lo(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),mi(l)||this.validateSessionProps(l,"sessionProperties")},this.validateNamespaces=(t,n)=>{const s=Z_(t,"connect()",n);if(s)throw new Error(s.message)},this.isValidApprove=async t=>{if(!cr(t))throw new Error(ee("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:n,namespaces:s,relayProtocol:c,sessionProperties:l}=t;await this.isValidProposalId(n);const d=this.client.proposal.get(n),_=Wa(s,"approve()");if(_)throw new Error(_.message);const y=Kh(d.requiredNamespaces,s,"approve()");if(y)throw new Error(y.message);if(!un(c,!0)){const{message:S}=ee("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(S)}mi(l)||this.validateSessionProps(l,"sessionProperties")},this.isValidReject=async t=>{if(!cr(t)){const{message:c}=ee("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:n,reason:s}=t;if(await this.isValidProposalId(n),!em(s)){const{message:c}=ee("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!cr(t)){const{message:y}=ee("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(y)}const{relay:n,controller:s,namespaces:c,expiry:l}=t;if(!tm(n)){const{message:y}=ee("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(y)}const d=rm(s,"onSessionSettleRequest()");if(d)throw new Error(d.message);const _=Wa(c,"onSessionSettleRequest()");if(_)throw new Error(_.message);if(_i(l)){const{message:y}=ee("EXPIRED","onSessionSettleRequest()");throw new Error(y)}},this.isValidUpdate=async t=>{if(!cr(t)){const{message:_}=ee("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(_)}const{topic:n,namespaces:s}=t;await this.isValidSessionTopic(n);const c=this.client.session.get(n),l=Wa(s,"update()");if(l)throw new Error(l.message);const d=Kh(c.requiredNamespaces,s,"update()");if(d)throw new Error(d.message)},this.isValidExtend=async t=>{if(!cr(t)){const{message:s}=ee("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionTopic(n)},this.isValidRequest=async t=>{if(!cr(t)){const{message:_}=ee("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(_)}const{topic:n,request:s,chainId:c,expiry:l}=t;await this.isValidSessionTopic(n);const{namespaces:d}=this.client.session.get(n);if(!Gh(d,c)){const{message:_}=ee("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(_)}if(!im(s)){const{message:_}=ee("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(_)}if(!nm(d,c,s.method)){const{message:_}=ee("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(_)}if(l&&!sm(l,sc)){const{message:_}=ee("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${sc.min} and ${sc.max}`);throw new Error(_)}},this.isValidRespond=async t=>{if(!cr(t)){const{message:c}=ee("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(c)}const{topic:n,response:s}=t;if(await this.isValidSessionTopic(n),!om(s)){const{message:c}=ee("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(s)}`);throw new Error(c)}},this.isValidPing=async t=>{if(!cr(t)){const{message:s}=ee("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async t=>{if(!cr(t)){const{message:d}=ee("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(d)}const{topic:n,event:s,chainId:c}=t;await this.isValidSessionTopic(n);const{namespaces:l}=this.client.session.get(n);if(!Gh(l,c)){const{message:d}=ee("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(d)}if(!am(s)){const{message:d}=ee("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(d)}if(!cm(l,c,s.name)){const{message:d}=ee("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(d)}},this.isValidDisconnect=async t=>{if(!cr(t)){const{message:s}=ee("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(t,n)=>{const s={verified:{verifyUrl:n.verifyUrl||fo,validation:"UNKNOWN",origin:n.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:n.verifyUrl});c&&(s.verified.origin=c,s.verified.validation=c===new URL(n.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.error(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(s)}`),s},this.validateSessionProps=(t,n)=>{Object.values(t).forEach(s=>{if(!un(s,!1)){const{message:c}=ee("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(s)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:r}=ee("NOT_INITIALIZED",this.name);throw new Error(r)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Kt.message,async r=>{const{topic:t,message:n}=r;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const s=await this.client.core.crypto.decode(t,n);try{qc(s)?(this.client.core.history.set(t,s),this.onRelayEventRequest({topic:t,payload:s})):bo(s)?(await this.client.core.history.resolve(s),await this.onRelayEventResponse({topic:t,payload:s}),this.client.core.history.delete(t,s.id)):this.onRelayEventUnknownPayload({topic:t,payload:s})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Ir.expired,async r=>{const{topic:t,id:n}=rf(r.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,ee("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}isValidPairingTopic(r){if(!un(r,!1)){const{message:t}=ee("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(r)){const{message:t}=ee("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(t)}if(_i(this.client.core.pairing.pairings.get(r).expiry)){const{message:t}=ee("EXPIRED",`pairing topic: ${r}`);throw new Error(t)}}async isValidSessionTopic(r){if(!un(r,!1)){const{message:t}=ee("MISSING_OR_INVALID",`session topic should be a string: ${r}`);throw new Error(t)}if(!this.client.session.keys.includes(r)){const{message:t}=ee("NO_MATCHING_KEY",`session topic doesn't exist: ${r}`);throw new Error(t)}if(_i(this.client.session.get(r).expiry)){await this.deleteSession(r);const{message:t}=ee("EXPIRED",`session topic: ${r}`);throw new Error(t)}}async isValidSessionOrPairingTopic(r){if(this.client.session.keys.includes(r))await this.isValidSessionTopic(r);else if(this.client.core.pairing.pairings.keys.includes(r))this.isValidPairingTopic(r);else if(un(r,!1)){const{message:t}=ee("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${r}`);throw new Error(t)}else{const{message:t}=ee("MISSING_OR_INVALID",`session or pairing topic should be a string: ${r}`);throw new Error(t)}}async isValidProposalId(r){if(!um(r)){const{message:t}=ee("MISSING_OR_INVALID",`proposal id should be a number: ${r}`);throw new Error(t)}if(!this.client.proposal.keys.includes(r)){const{message:t}=ee("NO_MATCHING_KEY",`proposal id doesn't exist: ${r}`);throw new Error(t)}if(_i(this.client.proposal.get(r).expiry)){await this.deleteProposal(r);const{message:t}=ee("EXPIRED",`proposal id: ${r}`);throw new Error(t)}}}class Fx extends xo{constructor(r,t){super(r,t,Ix,zc),this.core=r,this.logger=t}}class jx extends xo{constructor(r,t){super(r,t,Sx,zc),this.core=r,this.logger=t}}class Lx extends xo{constructor(r,t){super(r,t,Ox,zc,n=>n.id),this.core=r,this.logger=t}}let qx=class Kf extends V1{constructor(r){super(r),this.protocol=Hf,this.version=Bf,this.name=nc.name,this.events=new Pr.EventEmitter,this.on=(n,s)=>this.events.on(n,s),this.once=(n,s)=>this.events.once(n,s),this.off=(n,s)=>this.events.off(n,s),this.removeListener=(n,s)=>this.events.removeListener(n,s),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(s){throw this.logger.error(s.message),s}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(s){throw this.logger.error(s.message),s}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(s){throw this.logger.error(s.message),s}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(s){throw this.logger.error(s.message),s}},this.update=async n=>{try{return await this.engine.update(n)}catch(s){throw this.logger.error(s.message),s}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(s){throw this.logger.error(s.message),s}},this.request=async n=>{try{return await this.engine.request(n)}catch(s){throw this.logger.error(s.message),s}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(s){throw this.logger.error(s.message),s}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(s){throw this.logger.error(s.message),s}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(s){throw this.logger.error(s.message),s}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(s){throw this.logger.error(s.message),s}},this.find=n=>{try{return this.engine.find(n)}catch(s){throw this.logger.error(s.message),s}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(r==null?void 0:r.name)||nc.name,this.metadata=(r==null?void 0:r.metadata)||W_();const t=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:$e.pino($e.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||nc.logger}));this.core=(r==null?void 0:r.core)||new xx(r),this.logger=$e.generateChildLogger(t,this.name),this.session=new jx(this.core,this.logger),this.proposal=new Fx(this.core,this.logger),this.pendingRequest=new Lx(this.core,this.logger),this.engine=new Dx(this)}static async init(r){const t=new Kf(r);return await t.initialize(),t}get context(){return $e.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(r){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(r.message),r}}};var Pc={exports:{}};(function(a,r){var t=function(){function s(){this.fetch=!1,this.DOMException=globalThis.DOMException}return s.prototype=globalThis,new s}();(function(s){(function(c){var l={searchParams:"URLSearchParams"in s,iterable:"Symbol"in s&&"iterator"in Symbol,blob:"FileReader"in s&&"Blob"in s&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in s,arrayBuffer:"ArrayBuffer"in s};function d(T){return T&&DataView.prototype.isPrototypeOf(T)}if(l.arrayBuffer)var _=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],y=ArrayBuffer.isView||function(T){return T&&_.indexOf(Object.prototype.toString.call(T))>-1};function S(T){if(typeof T!="string"&&(T=String(T)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(T))throw new TypeError("Invalid character in header field name");return T.toLowerCase()}function L(T){return typeof T!="string"&&(T=String(T)),T}function R(T){var w={next:function(){var C=T.shift();return{done:C===void 0,value:C}}};return l.iterable&&(w[Symbol.iterator]=function(){return w}),w}function F(T){this.map={},T instanceof F?T.forEach(function(w,C){this.append(C,w)},this):Array.isArray(T)?T.forEach(function(w){this.append(w[0],w[1])},this):T&&Object.getOwnPropertyNames(T).forEach(function(w){this.append(w,T[w])},this)}F.prototype.append=function(T,w){T=S(T),w=L(w);var C=this.map[T];this.map[T]=C?C+", "+w:w},F.prototype.delete=function(T){delete this.map[S(T)]},F.prototype.get=function(T){return T=S(T),this.has(T)?this.map[T]:null},F.prototype.has=function(T){return this.map.hasOwnProperty(S(T))},F.prototype.set=function(T,w){this.map[S(T)]=L(w)},F.prototype.forEach=function(T,w){for(var C in this.map)this.map.hasOwnProperty(C)&&T.call(w,this.map[C],C,this)},F.prototype.keys=function(){var T=[];return this.forEach(function(w,C){T.push(C)}),R(T)},F.prototype.values=function(){var T=[];return this.forEach(function(w){T.push(w)}),R(T)},F.prototype.entries=function(){var T=[];return this.forEach(function(w,C){T.push([C,w])}),R(T)},l.iterable&&(F.prototype[Symbol.iterator]=F.prototype.entries);function H(T){if(T.bodyUsed)return Promise.reject(new TypeError("Already read"));T.bodyUsed=!0}function K(T){return new Promise(function(w,C){T.onload=function(){w(T.result)},T.onerror=function(){C(T.error)}})}function ne(T){var w=new FileReader,C=K(w);return w.readAsArrayBuffer(T),C}function Ee(T){var w=new FileReader,C=K(w);return w.readAsText(T),C}function ge(T){for(var w=new Uint8Array(T),C=new Array(w.length),pe=0;pe<w.length;pe++)C[pe]=String.fromCharCode(w[pe]);return C.join("")}function le(T){if(T.slice)return T.slice(0);var w=new Uint8Array(T.byteLength);return w.set(new Uint8Array(T)),w.buffer}function ue(){return this.bodyUsed=!1,this._initBody=function(T){this._bodyInit=T,T?typeof T=="string"?this._bodyText=T:l.blob&&Blob.prototype.isPrototypeOf(T)?this._bodyBlob=T:l.formData&&FormData.prototype.isPrototypeOf(T)?this._bodyFormData=T:l.searchParams&&URLSearchParams.prototype.isPrototypeOf(T)?this._bodyText=T.toString():l.arrayBuffer&&l.blob&&d(T)?(this._bodyArrayBuffer=le(T.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):l.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(T)||y(T))?this._bodyArrayBuffer=le(T):this._bodyText=T=Object.prototype.toString.call(T):this._bodyText="",this.headers.get("content-type")||(typeof T=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):l.searchParams&&URLSearchParams.prototype.isPrototypeOf(T)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},l.blob&&(this.blob=function(){var T=H(this);if(T)return T;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?H(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ne)}),this.text=function(){var T=H(this);if(T)return T;if(this._bodyBlob)return Ee(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(ge(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},l.formData&&(this.formData=function(){return this.text().then(Q)}),this.json=function(){return this.text().then(JSON.parse)},this}var fe=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function D(T){var w=T.toUpperCase();return fe.indexOf(w)>-1?w:T}function U(T,w){w=w||{};var C=w.body;if(T instanceof U){if(T.bodyUsed)throw new TypeError("Already read");this.url=T.url,this.credentials=T.credentials,w.headers||(this.headers=new F(T.headers)),this.method=T.method,this.mode=T.mode,this.signal=T.signal,!C&&T._bodyInit!=null&&(C=T._bodyInit,T.bodyUsed=!0)}else this.url=String(T);if(this.credentials=w.credentials||this.credentials||"same-origin",(w.headers||!this.headers)&&(this.headers=new F(w.headers)),this.method=D(w.method||this.method||"GET"),this.mode=w.mode||this.mode||null,this.signal=w.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&C)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(C)}U.prototype.clone=function(){return new U(this,{body:this._bodyInit})};function Q(T){var w=new FormData;return T.trim().split("&").forEach(function(C){if(C){var pe=C.split("="),oe=pe.shift().replace(/\+/g," "),V=pe.join("=").replace(/\+/g," ");w.append(decodeURIComponent(oe),decodeURIComponent(V))}}),w}function ye(T){var w=new F,C=T.replace(/\r?\n[\t ]+/g," ");return C.split(/\r?\n/).forEach(function(pe){var oe=pe.split(":"),V=oe.shift().trim();if(V){var G=oe.join(":").trim();w.append(V,G)}}),w}ue.call(U.prototype);function Z(T,w){w||(w={}),this.type="default",this.status=w.status===void 0?200:w.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in w?w.statusText:"OK",this.headers=new F(w.headers),this.url=w.url||"",this._initBody(T)}ue.call(Z.prototype),Z.prototype.clone=function(){return new Z(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new F(this.headers),url:this.url})},Z.error=function(){var T=new Z(null,{status:0,statusText:""});return T.type="error",T};var xe=[301,302,303,307,308];Z.redirect=function(T,w){if(xe.indexOf(w)===-1)throw new RangeError("Invalid status code");return new Z(null,{status:w,headers:{location:T}})},c.DOMException=s.DOMException;try{new c.DOMException}catch{c.DOMException=function(w,C){this.message=w,this.name=C;var pe=Error(w);this.stack=pe.stack},c.DOMException.prototype=Object.create(Error.prototype),c.DOMException.prototype.constructor=c.DOMException}function Oe(T,w){return new Promise(function(C,pe){var oe=new U(T,w);if(oe.signal&&oe.signal.aborted)return pe(new c.DOMException("Aborted","AbortError"));var V=new XMLHttpRequest;function G(){V.abort()}V.onload=function(){var k={status:V.status,statusText:V.statusText,headers:ye(V.getAllResponseHeaders()||"")};k.url="responseURL"in V?V.responseURL:k.headers.get("X-Request-URL");var W="response"in V?V.response:V.responseText;C(new Z(W,k))},V.onerror=function(){pe(new TypeError("Network request failed"))},V.ontimeout=function(){pe(new TypeError("Network request failed"))},V.onabort=function(){pe(new c.DOMException("Aborted","AbortError"))},V.open(oe.method,oe.url,!0),oe.credentials==="include"?V.withCredentials=!0:oe.credentials==="omit"&&(V.withCredentials=!1),"responseType"in V&&l.blob&&(V.responseType="blob"),oe.headers.forEach(function(k,W){V.setRequestHeader(W,k)}),oe.signal&&(oe.signal.addEventListener("abort",G),V.onreadystatechange=function(){V.readyState===4&&oe.signal.removeEventListener("abort",G)}),V.send(typeof oe._bodyInit>"u"?null:oe._bodyInit)})}return Oe.polyfill=!0,s.fetch||(s.fetch=Oe,s.Headers=F,s.Request=U,s.Response=Z),c.Headers=F,c.Request=U,c.Response=Z,c.fetch=Oe,Object.defineProperty(c,"__esModule",{value:!0}),c})({})})(t),t.fetch.ponyfill=!0,delete t.fetch.polyfill;var n=t;r=n.fetch,r.default=n.fetch,r.fetch=n.fetch,r.Headers=n.Headers,r.Request=n.Request,r.Response=n.Response,a.exports=r})(Pc,Pc.exports);var Mx=Pc.exports;const Ml=ef(Mx),Ux={Accept:"application/json","Content-Type":"application/json"},zx="POST",Ul={headers:Ux,method:zx},zl=10;class Ui{constructor(r,t=!1){if(this.url=r,this.disableProviderPing=t,this.events=new Pr.EventEmitter,this.isAvailable=!1,this.registering=!1,!pl(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);this.url=r,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}off(r,t){this.events.off(r,t)}removeListener(r,t){this.events.removeListener(r,t)}async open(r=this.url){await this.register(r)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(r,t){this.isAvailable||await this.register();try{const n=Qn(r),c=await(await Ml(this.url,Object.assign(Object.assign({},Ul),{body:n}))).json();this.onPayload({data:c})}catch(n){this.onError(r.id,n)}}async register(r=this.url){if(!pl(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,s)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),s(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));n()})})}this.url=r,this.registering=!0;try{if(!this.disableProviderPing){const t=Qn({id:1,jsonrpc:"2.0",method:"test",params:[]});await Ml(r,Object.assign(Object.assign({},Ul),{body:t}))}this.onOpen()}catch(t){const n=this.parseError(t);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(r){if(typeof r.data>"u")return;const t=typeof r.data=="string"?Nc(r.data):r.data;this.events.emit("payload",t)}onError(r,t){const n=this.parseError(t),s=n.message||n.toString(),c=wo(r,s);this.events.emit("payload",c)}parseError(r,t=this.url){return Ef(r,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>zl&&this.events.setMaxListeners(zl)}}const Hl="error",Hx="wss://relay.walletconnect.com",Bx="wc",kx="universal_provider",Bl=`${Bx}@2:${kx}:`,Vx="https://rpc.walletconnect.com/v1",Ei={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Hn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},Oc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(a,r){(function(){var t,n="4.17.21",s=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",d="Invalid `variable` option passed into `_.template`",_="__lodash_hash_undefined__",y=500,S="__lodash_placeholder__",L=1,R=2,F=4,H=1,K=2,ne=1,Ee=2,ge=4,le=8,ue=16,fe=32,D=64,U=128,Q=256,ye=512,Z=30,xe="...",Oe=800,T=16,w=1,C=2,pe=3,oe=1/0,V=9007199254740991,G=17976931348623157e292,k=0/0,W=4294967295,ct=W-1,Be=W>>>1,Fr=[["ary",U],["bind",ne],["bindKey",Ee],["curry",le],["curryRight",ue],["flip",ye],["partial",fe],["partialRight",D],["rearg",Q]],Ie="[object Arguments]",xt="[object Array]",N="[object AsyncFunction]",$="[object Boolean]",O="[object Date]",h="[object DOMException]",E="[object Error]",te="[object Function]",he="[object GeneratorFunction]",we="[object Map]",Ne="[object Number]",Fe="[object Null]",Re="[object Object]",It="[object Promise]",vt="[object Proxy]",nt="[object RegExp]",Le="[object Set]",Qe="[object String]",Ye="[object Symbol]",st="[object Undefined]",ze="[object WeakMap]",Xe="[object WeakSet]",De="[object ArrayBuffer]",ke="[object DataView]",ut="[object Float32Array]",Me="[object Float64Array]",St="[object Int8Array]",Dt="[object Int16Array]",Ut="[object Int32Array]",zt="[object Uint8Array]",Lt="[object Uint8ClampedArray]",Gt="[object Uint16Array]",tr="[object Uint32Array]",jr=/\b__p \+= '';/g,Wt=/\b(__p \+=) '' \+/g,kr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ai=/&(?:amp|lt|gt|quot|#39);/g,xi=/[&<>"']/g,ht=RegExp(ai.source),tt=RegExp(xi.source),lt=/<%-([\s\S]+?)%>/g,ft=/<%([\s\S]+?)%>/g,ot=/<%=([\s\S]+?)%>/g,rt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Pt=/^\w*$/,Ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,pt=/[\\^$.*+?()[\]{}|]/g,Rt=RegExp(pt.source),dt=/^\s+/,_t=/\s/,gt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Je=/\{\n\/\* \[wrapped with (.+)\] \*/,Tt=/,? & /,Ct=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Io=/[()=,{}\[\]\/\s]/,So=/\\(\\)?/g,Po=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,gr=/\w*$/,Oo=/^[-+]0x[0-9a-f]+$/i,Ro=/^0b[01]+$/i,To=/^\[object .+?Constructor\]$/,Co=/^0o[0-7]+$/i,Ao=/^(?:0|[1-9]\d*)$/,Vr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,zi=/($^)/,$o=/['\n\r\u2028\u2029\\]/g,Hi="\\ud800-\\udfff",No="\\u0300-\\u036f",Do="\\ufe20-\\ufe2f",Bi="\\u20d0-\\u20ff",rs=No+Do+Bi,is="\\u2700-\\u27bf",Or="a-z\\xdf-\\xf6\\xf8-\\xff",Fo="\\xac\\xb1\\xd7\\xf7",jo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Lo="\\u2000-\\u206f",qo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ns="A-Z\\xc0-\\xd6\\xd8-\\xde",ss="\\ufe0e\\ufe0f",Ii=Fo+jo+Lo+qo,dn="[']",Si="["+Hi+"]",gn="["+Ii+"]",Pi="["+rs+"]",os="\\d+",Mo="["+is+"]",as="["+Or+"]",cs="[^"+Hi+Ii+os+is+Or+ns+"]",ki="\\ud83c[\\udffb-\\udfff]",Uo="(?:"+Pi+"|"+ki+")",us="[^"+Hi+"]",Vi="(?:\\ud83c[\\udde6-\\uddff]){2}",ci="[\\ud800-\\udbff][\\udc00-\\udfff]",ur="["+ns+"]",hs="\\u200d",ls="(?:"+as+"|"+cs+")",Lr="(?:"+ur+"|"+cs+")",fs="(?:"+dn+"(?:d|ll|m|re|s|t|ve))?",ps="(?:"+dn+"(?:D|LL|M|RE|S|T|VE))?",ds=Uo+"?",gs="["+ss+"]?",zo="(?:"+hs+"(?:"+[us,Vi,ci].join("|")+")"+gs+ds+")*",Kr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ys="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",vs=gs+ds+zo,Ki="(?:"+[Mo,Vi,ci].join("|")+")"+vs,Ho="(?:"+[us+Pi+"?",Pi,Vi,ci,Si].join("|")+")",yn=RegExp(dn,"g"),Bo=RegExp(Pi,"g"),Gi=RegExp(ki+"(?="+ki+")|"+Ho+vs,"g"),_s=RegExp([ur+"?"+as+"+"+fs+"(?="+[gn,ur,"$"].join("|")+")",Lr+"+"+ps+"(?="+[gn,ur+ls,"$"].join("|")+")",ur+"?"+ls+"+"+fs,ur+"+"+ps,ys,Kr,os,Ki].join("|"),"g"),ms=RegExp("["+hs+Hi+rs+ss+"]"),Oi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ws=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ko=-1,Ve={};Ve[ut]=Ve[Me]=Ve[St]=Ve[Dt]=Ve[Ut]=Ve[zt]=Ve[Lt]=Ve[Gt]=Ve[tr]=!0,Ve[Ie]=Ve[xt]=Ve[De]=Ve[$]=Ve[ke]=Ve[O]=Ve[E]=Ve[te]=Ve[we]=Ve[Ne]=Ve[Re]=Ve[nt]=Ve[Le]=Ve[Qe]=Ve[ze]=!1;var He={};He[Ie]=He[xt]=He[De]=He[ke]=He[$]=He[O]=He[ut]=He[Me]=He[St]=He[Dt]=He[Ut]=He[we]=He[Ne]=He[Re]=He[nt]=He[Le]=He[Qe]=He[Ye]=He[zt]=He[Lt]=He[Gt]=He[tr]=!0,He[E]=He[te]=He[ze]=!1;var v={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},x={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},z={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Y={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ke=parseFloat,ve=parseInt,Ze=typeof Hn=="object"&&Hn&&Hn.Object===Object&&Hn,At=typeof self=="object"&&self&&self.Object===Object&&self,Ce=Ze||At||Function("return this")(),Ge=r&&!r.nodeType&&r,mt=Ge&&!0&&a&&!a.nodeType&&a,rr=mt&&mt.exports===Ge,$t=rr&&Ze.process,et=function(){try{var I=mt&&mt.require&&mt.require("util").types;return I||$t&&$t.binding&&$t.binding("util")}catch{}}(),Jt=et&&et.isArrayBuffer,Rr=et&&et.isDate,yr=et&&et.isMap,qr=et&&et.isRegExp,vn=et&&et.isSet,Ri=et&&et.isTypedArray;function qt(I,j,A){switch(A.length){case 0:return I.call(j);case 1:return I.call(j,A[0]);case 2:return I.call(j,A[0],A[1]);case 3:return I.call(j,A[0],A[1],A[2])}return I.apply(j,A)}function Jf(I,j,A,X){for(var de=-1,je=I==null?0:I.length;++de<je;){var Ft=I[de];j(X,Ft,A(Ft),I)}return X}function vr(I,j){for(var A=-1,X=I==null?0:I.length;++A<X&&j(I[A],A,I)!==!1;);return I}function Qf(I,j){for(var A=I==null?0:I.length;A--&&j(I[A],A,I)!==!1;);return I}function kc(I,j){for(var A=-1,X=I==null?0:I.length;++A<X;)if(!j(I[A],A,I))return!1;return!0}function ui(I,j){for(var A=-1,X=I==null?0:I.length,de=0,je=[];++A<X;){var Ft=I[A];j(Ft,A,I)&&(je[de++]=Ft)}return je}function bs(I,j){var A=I==null?0:I.length;return!!A&&Wi(I,j,0)>-1}function Vo(I,j,A){for(var X=-1,de=I==null?0:I.length;++X<de;)if(A(j,I[X]))return!0;return!1}function it(I,j){for(var A=-1,X=I==null?0:I.length,de=Array(X);++A<X;)de[A]=j(I[A],A,I);return de}function hi(I,j){for(var A=-1,X=j.length,de=I.length;++A<X;)I[de+A]=j[A];return I}function Ko(I,j,A,X){var de=-1,je=I==null?0:I.length;for(X&&je&&(A=I[++de]);++de<je;)A=j(A,I[de],de,I);return A}function Yf(I,j,A,X){var de=I==null?0:I.length;for(X&&de&&(A=I[--de]);de--;)A=j(A,I[de],de,I);return A}function Go(I,j){for(var A=-1,X=I==null?0:I.length;++A<X;)if(j(I[A],A,I))return!0;return!1}var Xf=Wo("length");function Zf(I){return I.split("")}function ep(I){return I.match(Ct)||[]}function Vc(I,j,A){var X;return A(I,function(de,je,Ft){if(j(de,je,Ft))return X=je,!1}),X}function Es(I,j,A,X){for(var de=I.length,je=A+(X?1:-1);X?je--:++je<de;)if(j(I[je],je,I))return je;return-1}function Wi(I,j,A){return j===j?fp(I,j,A):Es(I,Kc,A)}function tp(I,j,A,X){for(var de=A-1,je=I.length;++de<je;)if(X(I[de],j))return de;return-1}function Kc(I){return I!==I}function Gc(I,j){var A=I==null?0:I.length;return A?Qo(I,j)/A:k}function Wo(I){return function(j){return j==null?t:j[I]}}function Jo(I){return function(j){return I==null?t:I[j]}}function Wc(I,j,A,X,de){return de(I,function(je,Ft,We){A=X?(X=!1,je):j(A,je,Ft,We)}),A}function rp(I,j){var A=I.length;for(I.sort(j);A--;)I[A]=I[A].value;return I}function Qo(I,j){for(var A,X=-1,de=I.length;++X<de;){var je=j(I[X]);je!==t&&(A=A===t?je:A+je)}return A}function Yo(I,j){for(var A=-1,X=Array(I);++A<I;)X[A]=j(A);return X}function ip(I,j){return it(j,function(A){return[A,I[A]]})}function Jc(I){return I&&I.slice(0,Zc(I)+1).replace(dt,"")}function hr(I){return function(j){return I(j)}}function Xo(I,j){return it(j,function(A){return I[A]})}function _n(I,j){return I.has(j)}function Qc(I,j){for(var A=-1,X=I.length;++A<X&&Wi(j,I[A],0)>-1;);return A}function Yc(I,j){for(var A=I.length;A--&&Wi(j,I[A],0)>-1;);return A}function np(I,j){for(var A=I.length,X=0;A--;)I[A]===j&&++X;return X}var sp=Jo(v),op=Jo(x);function ap(I){return"\\"+Y[I]}function cp(I,j){return I==null?t:I[j]}function Ji(I){return ms.test(I)}function up(I){return Oi.test(I)}function hp(I){for(var j,A=[];!(j=I.next()).done;)A.push(j.value);return A}function Zo(I){var j=-1,A=Array(I.size);return I.forEach(function(X,de){A[++j]=[de,X]}),A}function Xc(I,j){return function(A){return I(j(A))}}function li(I,j){for(var A=-1,X=I.length,de=0,je=[];++A<X;){var Ft=I[A];(Ft===j||Ft===S)&&(I[A]=S,je[de++]=A)}return je}function xs(I){var j=-1,A=Array(I.size);return I.forEach(function(X){A[++j]=X}),A}function lp(I){var j=-1,A=Array(I.size);return I.forEach(function(X){A[++j]=[X,X]}),A}function fp(I,j,A){for(var X=A-1,de=I.length;++X<de;)if(I[X]===j)return X;return-1}function pp(I,j,A){for(var X=A+1;X--;)if(I[X]===j)return X;return X}function Qi(I){return Ji(I)?gp(I):Xf(I)}function Tr(I){return Ji(I)?yp(I):Zf(I)}function Zc(I){for(var j=I.length;j--&&_t.test(I.charAt(j)););return j}var dp=Jo(z);function gp(I){for(var j=Gi.lastIndex=0;Gi.test(I);)++j;return j}function yp(I){return I.match(Gi)||[]}function vp(I){return I.match(_s)||[]}var _p=function I(j){j=j==null?Ce:Yi.defaults(Ce.Object(),j,Yi.pick(Ce,ws));var A=j.Array,X=j.Date,de=j.Error,je=j.Function,Ft=j.Math,We=j.Object,ea=j.RegExp,mp=j.String,_r=j.TypeError,Is=A.prototype,wp=je.prototype,Xi=We.prototype,Ss=j["__core-js_shared__"],Ps=wp.toString,Ue=Xi.hasOwnProperty,bp=0,eu=function(){var e=/[^.]+$/.exec(Ss&&Ss.keys&&Ss.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Os=Xi.toString,Ep=Ps.call(We),xp=Ce._,Ip=ea("^"+Ps.call(Ue).replace(pt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Rs=rr?j.Buffer:t,fi=j.Symbol,Ts=j.Uint8Array,tu=Rs?Rs.allocUnsafe:t,Cs=Xc(We.getPrototypeOf,We),ru=We.create,iu=Xi.propertyIsEnumerable,As=Is.splice,nu=fi?fi.isConcatSpreadable:t,mn=fi?fi.iterator:t,Ti=fi?fi.toStringTag:t,$s=function(){try{var e=Di(We,"defineProperty");return e({},"",{}),e}catch{}}(),Sp=j.clearTimeout!==Ce.clearTimeout&&j.clearTimeout,Pp=X&&X.now!==Ce.Date.now&&X.now,Op=j.setTimeout!==Ce.setTimeout&&j.setTimeout,Ns=Ft.ceil,Ds=Ft.floor,ta=We.getOwnPropertySymbols,Rp=Rs?Rs.isBuffer:t,su=j.isFinite,Tp=Is.join,Cp=Xc(We.keys,We),jt=Ft.max,kt=Ft.min,Ap=X.now,$p=j.parseInt,ou=Ft.random,Np=Is.reverse,ra=Di(j,"DataView"),wn=Di(j,"Map"),ia=Di(j,"Promise"),Zi=Di(j,"Set"),bn=Di(j,"WeakMap"),En=Di(We,"create"),Fs=bn&&new bn,en={},Dp=Fi(ra),Fp=Fi(wn),jp=Fi(ia),Lp=Fi(Zi),qp=Fi(bn),js=fi?fi.prototype:t,xn=js?js.valueOf:t,au=js?js.toString:t;function p(e){if(yt(e)&&!_e(e)&&!(e instanceof Te)){if(e instanceof mr)return e;if(Ue.call(e,"__wrapped__"))return ch(e)}return new mr(e)}var tn=function(){function e(){}return function(i){if(!at(i))return{};if(ru)return ru(i);e.prototype=i;var o=new e;return e.prototype=t,o}}();function Ls(){}function mr(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=t}p.templateSettings={escape:lt,evaluate:ft,interpolate:ot,variable:"",imports:{_:p}},p.prototype=Ls.prototype,p.prototype.constructor=p,mr.prototype=tn(Ls.prototype),mr.prototype.constructor=mr;function Te(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=W,this.__views__=[]}function Mp(){var e=new Te(this.__wrapped__);return e.__actions__=ir(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=ir(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=ir(this.__views__),e}function Up(){if(this.__filtered__){var e=new Te(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function zp(){var e=this.__wrapped__.value(),i=this.__dir__,o=_e(e),u=i<0,f=o?e.length:0,g=Zd(0,f,this.__views__),m=g.start,b=g.end,P=b-m,q=u?b:m-1,M=this.__iteratees__,B=M.length,J=0,re=kt(P,this.__takeCount__);if(!o||!u&&f==P&&re==P)return Au(e,this.__actions__);var ae=[];e:for(;P--&&J<re;){q+=i;for(var be=-1,ce=e[q];++be<B;){var Pe=M[be],Ae=Pe.iteratee,pr=Pe.type,Xt=Ae(ce);if(pr==C)ce=Xt;else if(!Xt){if(pr==w)continue e;break e}}ae[J++]=ce}return ae}Te.prototype=tn(Ls.prototype),Te.prototype.constructor=Te;function Ci(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function Hp(){this.__data__=En?En(null):{},this.size=0}function Bp(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function kp(e){var i=this.__data__;if(En){var o=i[e];return o===_?t:o}return Ue.call(i,e)?i[e]:t}function Vp(e){var i=this.__data__;return En?i[e]!==t:Ue.call(i,e)}function Kp(e,i){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=En&&i===t?_:i,this}Ci.prototype.clear=Hp,Ci.prototype.delete=Bp,Ci.prototype.get=kp,Ci.prototype.has=Vp,Ci.prototype.set=Kp;function Gr(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function Gp(){this.__data__=[],this.size=0}function Wp(e){var i=this.__data__,o=qs(i,e);if(o<0)return!1;var u=i.length-1;return o==u?i.pop():As.call(i,o,1),--this.size,!0}function Jp(e){var i=this.__data__,o=qs(i,e);return o<0?t:i[o][1]}function Qp(e){return qs(this.__data__,e)>-1}function Yp(e,i){var o=this.__data__,u=qs(o,e);return u<0?(++this.size,o.push([e,i])):o[u][1]=i,this}Gr.prototype.clear=Gp,Gr.prototype.delete=Wp,Gr.prototype.get=Jp,Gr.prototype.has=Qp,Gr.prototype.set=Yp;function Wr(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function Xp(){this.size=0,this.__data__={hash:new Ci,map:new(wn||Gr),string:new Ci}}function Zp(e){var i=Qs(this,e).delete(e);return this.size-=i?1:0,i}function ed(e){return Qs(this,e).get(e)}function td(e){return Qs(this,e).has(e)}function rd(e,i){var o=Qs(this,e),u=o.size;return o.set(e,i),this.size+=o.size==u?0:1,this}Wr.prototype.clear=Xp,Wr.prototype.delete=Zp,Wr.prototype.get=ed,Wr.prototype.has=td,Wr.prototype.set=rd;function Ai(e){var i=-1,o=e==null?0:e.length;for(this.__data__=new Wr;++i<o;)this.add(e[i])}function id(e){return this.__data__.set(e,_),this}function nd(e){return this.__data__.has(e)}Ai.prototype.add=Ai.prototype.push=id,Ai.prototype.has=nd;function Cr(e){var i=this.__data__=new Gr(e);this.size=i.size}function sd(){this.__data__=new Gr,this.size=0}function od(e){var i=this.__data__,o=i.delete(e);return this.size=i.size,o}function ad(e){return this.__data__.get(e)}function cd(e){return this.__data__.has(e)}function ud(e,i){var o=this.__data__;if(o instanceof Gr){var u=o.__data__;if(!wn||u.length<s-1)return u.push([e,i]),this.size=++o.size,this;o=this.__data__=new Wr(u)}return o.set(e,i),this.size=o.size,this}Cr.prototype.clear=sd,Cr.prototype.delete=od,Cr.prototype.get=ad,Cr.prototype.has=cd,Cr.prototype.set=ud;function cu(e,i){var o=_e(e),u=!o&&ji(e),f=!o&&!u&&vi(e),g=!o&&!u&&!f&&on(e),m=o||u||f||g,b=m?Yo(e.length,mp):[],P=b.length;for(var q in e)(i||Ue.call(e,q))&&!(m&&(q=="length"||f&&(q=="offset"||q=="parent")||g&&(q=="buffer"||q=="byteLength"||q=="byteOffset")||Xr(q,P)))&&b.push(q);return b}function uu(e){var i=e.length;return i?e[da(0,i-1)]:t}function hd(e,i){return Ys(ir(e),$i(i,0,e.length))}function ld(e){return Ys(ir(e))}function na(e,i,o){(o!==t&&!Ar(e[i],o)||o===t&&!(i in e))&&Jr(e,i,o)}function In(e,i,o){var u=e[i];(!(Ue.call(e,i)&&Ar(u,o))||o===t&&!(i in e))&&Jr(e,i,o)}function qs(e,i){for(var o=e.length;o--;)if(Ar(e[o][0],i))return o;return-1}function fd(e,i,o,u){return pi(e,function(f,g,m){i(u,f,o(f),m)}),u}function hu(e,i){return e&&Ur(i,Mt(i),e)}function pd(e,i){return e&&Ur(i,sr(i),e)}function Jr(e,i,o){i=="__proto__"&&$s?$s(e,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[i]=o}function sa(e,i){for(var o=-1,u=i.length,f=A(u),g=e==null;++o<u;)f[o]=g?t:Ma(e,i[o]);return f}function $i(e,i,o){return e===e&&(o!==t&&(e=e<=o?e:o),i!==t&&(e=e>=i?e:i)),e}function wr(e,i,o,u,f,g){var m,b=i&L,P=i&R,q=i&F;if(o&&(m=f?o(e,u,f,g):o(e)),m!==t)return m;if(!at(e))return e;var M=_e(e);if(M){if(m=tg(e),!b)return ir(e,m)}else{var B=Vt(e),J=B==te||B==he;if(vi(e))return Du(e,b);if(B==Re||B==Ie||J&&!f){if(m=P||J?{}:Zu(e),!b)return P?kd(e,pd(m,e)):Bd(e,hu(m,e))}else{if(!He[B])return f?e:{};m=rg(e,B,b)}}g||(g=new Cr);var re=g.get(e);if(re)return re;g.set(e,m),Rh(e)?e.forEach(function(ce){m.add(wr(ce,i,o,ce,e,g))}):Ph(e)&&e.forEach(function(ce,Pe){m.set(Pe,wr(ce,i,o,Pe,e,g))});var ae=q?P?Sa:Ia:P?sr:Mt,be=M?t:ae(e);return vr(be||e,function(ce,Pe){be&&(Pe=ce,ce=e[Pe]),In(m,Pe,wr(ce,i,o,Pe,e,g))}),m}function dd(e){var i=Mt(e);return function(o){return lu(o,e,i)}}function lu(e,i,o){var u=o.length;if(e==null)return!u;for(e=We(e);u--;){var f=o[u],g=i[f],m=e[f];if(m===t&&!(f in e)||!g(m))return!1}return!0}function fu(e,i,o){if(typeof e!="function")throw new _r(l);return An(function(){e.apply(t,o)},i)}function Sn(e,i,o,u){var f=-1,g=bs,m=!0,b=e.length,P=[],q=i.length;if(!b)return P;o&&(i=it(i,hr(o))),u?(g=Vo,m=!1):i.length>=s&&(g=_n,m=!1,i=new Ai(i));e:for(;++f<b;){var M=e[f],B=o==null?M:o(M);if(M=u||M!==0?M:0,m&&B===B){for(var J=q;J--;)if(i[J]===B)continue e;P.push(M)}else g(i,B,u)||P.push(M)}return P}var pi=Mu(Mr),pu=Mu(aa,!0);function gd(e,i){var o=!0;return pi(e,function(u,f,g){return o=!!i(u,f,g),o}),o}function Ms(e,i,o){for(var u=-1,f=e.length;++u<f;){var g=e[u],m=i(g);if(m!=null&&(b===t?m===m&&!fr(m):o(m,b)))var b=m,P=g}return P}function yd(e,i,o,u){var f=e.length;for(o=me(o),o<0&&(o=-o>f?0:f+o),u=u===t||u>f?f:me(u),u<0&&(u+=f),u=o>u?0:Ch(u);o<u;)e[o++]=i;return e}function du(e,i){var o=[];return pi(e,function(u,f,g){i(u,f,g)&&o.push(u)}),o}function Ht(e,i,o,u,f){var g=-1,m=e.length;for(o||(o=ng),f||(f=[]);++g<m;){var b=e[g];i>0&&o(b)?i>1?Ht(b,i-1,o,u,f):hi(f,b):u||(f[f.length]=b)}return f}var oa=Uu(),gu=Uu(!0);function Mr(e,i){return e&&oa(e,i,Mt)}function aa(e,i){return e&&gu(e,i,Mt)}function Us(e,i){return ui(i,function(o){return Zr(e[o])})}function Ni(e,i){i=gi(i,e);for(var o=0,u=i.length;e!=null&&o<u;)e=e[zr(i[o++])];return o&&o==u?e:t}function yu(e,i,o){var u=i(e);return _e(e)?u:hi(u,o(e))}function Qt(e){return e==null?e===t?st:Fe:Ti&&Ti in We(e)?Xd(e):lg(e)}function ca(e,i){return e>i}function vd(e,i){return e!=null&&Ue.call(e,i)}function _d(e,i){return e!=null&&i in We(e)}function md(e,i,o){return e>=kt(i,o)&&e<jt(i,o)}function ua(e,i,o){for(var u=o?Vo:bs,f=e[0].length,g=e.length,m=g,b=A(g),P=1/0,q=[];m--;){var M=e[m];m&&i&&(M=it(M,hr(i))),P=kt(M.length,P),b[m]=!o&&(i||f>=120&&M.length>=120)?new Ai(m&&M):t}M=e[0];var B=-1,J=b[0];e:for(;++B<f&&q.length<P;){var re=M[B],ae=i?i(re):re;if(re=o||re!==0?re:0,!(J?_n(J,ae):u(q,ae,o))){for(m=g;--m;){var be=b[m];if(!(be?_n(be,ae):u(e[m],ae,o)))continue e}J&&J.push(ae),q.push(re)}}return q}function wd(e,i,o,u){return Mr(e,function(f,g,m){i(u,o(f),g,m)}),u}function Pn(e,i,o){i=gi(i,e),e=ih(e,i);var u=e==null?e:e[zr(Er(i))];return u==null?t:qt(u,e,o)}function vu(e){return yt(e)&&Qt(e)==Ie}function bd(e){return yt(e)&&Qt(e)==De}function Ed(e){return yt(e)&&Qt(e)==O}function On(e,i,o,u,f){return e===i?!0:e==null||i==null||!yt(e)&&!yt(i)?e!==e&&i!==i:xd(e,i,o,u,On,f)}function xd(e,i,o,u,f,g){var m=_e(e),b=_e(i),P=m?xt:Vt(e),q=b?xt:Vt(i);P=P==Ie?Re:P,q=q==Ie?Re:q;var M=P==Re,B=q==Re,J=P==q;if(J&&vi(e)){if(!vi(i))return!1;m=!0,M=!1}if(J&&!M)return g||(g=new Cr),m||on(e)?Qu(e,i,o,u,f,g):Qd(e,i,P,o,u,f,g);if(!(o&H)){var re=M&&Ue.call(e,"__wrapped__"),ae=B&&Ue.call(i,"__wrapped__");if(re||ae){var be=re?e.value():e,ce=ae?i.value():i;return g||(g=new Cr),f(be,ce,o,u,g)}}return J?(g||(g=new Cr),Yd(e,i,o,u,f,g)):!1}function Id(e){return yt(e)&&Vt(e)==we}function ha(e,i,o,u){var f=o.length,g=f,m=!u;if(e==null)return!g;for(e=We(e);f--;){var b=o[f];if(m&&b[2]?b[1]!==e[b[0]]:!(b[0]in e))return!1}for(;++f<g;){b=o[f];var P=b[0],q=e[P],M=b[1];if(m&&b[2]){if(q===t&&!(P in e))return!1}else{var B=new Cr;if(u)var J=u(q,M,P,e,i,B);if(!(J===t?On(M,q,H|K,u,B):J))return!1}}return!0}function _u(e){if(!at(e)||og(e))return!1;var i=Zr(e)?Ip:To;return i.test(Fi(e))}function Sd(e){return yt(e)&&Qt(e)==nt}function Pd(e){return yt(e)&&Vt(e)==Le}function Od(e){return yt(e)&&io(e.length)&&!!Ve[Qt(e)]}function mu(e){return typeof e=="function"?e:e==null?or:typeof e=="object"?_e(e)?Eu(e[0],e[1]):bu(e):zh(e)}function la(e){if(!Cn(e))return Cp(e);var i=[];for(var o in We(e))Ue.call(e,o)&&o!="constructor"&&i.push(o);return i}function Rd(e){if(!at(e))return hg(e);var i=Cn(e),o=[];for(var u in e)u=="constructor"&&(i||!Ue.call(e,u))||o.push(u);return o}function fa(e,i){return e<i}function wu(e,i){var o=-1,u=nr(e)?A(e.length):[];return pi(e,function(f,g,m){u[++o]=i(f,g,m)}),u}function bu(e){var i=Oa(e);return i.length==1&&i[0][2]?th(i[0][0],i[0][1]):function(o){return o===e||ha(o,e,i)}}function Eu(e,i){return Ta(e)&&eh(i)?th(zr(e),i):function(o){var u=Ma(o,e);return u===t&&u===i?Ua(o,e):On(i,u,H|K)}}function zs(e,i,o,u,f){e!==i&&oa(i,function(g,m){if(f||(f=new Cr),at(g))Td(e,i,m,o,zs,u,f);else{var b=u?u(Aa(e,m),g,m+"",e,i,f):t;b===t&&(b=g),na(e,m,b)}},sr)}function Td(e,i,o,u,f,g,m){var b=Aa(e,o),P=Aa(i,o),q=m.get(P);if(q){na(e,o,q);return}var M=g?g(b,P,o+"",e,i,m):t,B=M===t;if(B){var J=_e(P),re=!J&&vi(P),ae=!J&&!re&&on(P);M=P,J||re||ae?_e(b)?M=b:wt(b)?M=ir(b):re?(B=!1,M=Du(P,!0)):ae?(B=!1,M=Fu(P,!0)):M=[]:$n(P)||ji(P)?(M=b,ji(b)?M=Ah(b):(!at(b)||Zr(b))&&(M=Zu(P))):B=!1}B&&(m.set(P,M),f(M,P,u,g,m),m.delete(P)),na(e,o,M)}function xu(e,i){var o=e.length;if(o)return i+=i<0?o:0,Xr(i,o)?e[i]:t}function Iu(e,i,o){i.length?i=it(i,function(g){return _e(g)?function(m){return Ni(m,g.length===1?g[0]:g)}:g}):i=[or];var u=-1;i=it(i,hr(se()));var f=wu(e,function(g,m,b){var P=it(i,function(q){return q(g)});return{criteria:P,index:++u,value:g}});return rp(f,function(g,m){return Hd(g,m,o)})}function Cd(e,i){return Su(e,i,function(o,u){return Ua(e,u)})}function Su(e,i,o){for(var u=-1,f=i.length,g={};++u<f;){var m=i[u],b=Ni(e,m);o(b,m)&&Rn(g,gi(m,e),b)}return g}function Ad(e){return function(i){return Ni(i,e)}}function pa(e,i,o,u){var f=u?tp:Wi,g=-1,m=i.length,b=e;for(e===i&&(i=ir(i)),o&&(b=it(e,hr(o)));++g<m;)for(var P=0,q=i[g],M=o?o(q):q;(P=f(b,M,P,u))>-1;)b!==e&&As.call(b,P,1),As.call(e,P,1);return e}function Pu(e,i){for(var o=e?i.length:0,u=o-1;o--;){var f=i[o];if(o==u||f!==g){var g=f;Xr(f)?As.call(e,f,1):va(e,f)}}return e}function da(e,i){return e+Ds(ou()*(i-e+1))}function $d(e,i,o,u){for(var f=-1,g=jt(Ns((i-e)/(o||1)),0),m=A(g);g--;)m[u?g:++f]=e,e+=o;return m}function ga(e,i){var o="";if(!e||i<1||i>V)return o;do i%2&&(o+=e),i=Ds(i/2),i&&(e+=e);while(i);return o}function Se(e,i){return $a(rh(e,i,or),e+"")}function Nd(e){return uu(an(e))}function Dd(e,i){var o=an(e);return Ys(o,$i(i,0,o.length))}function Rn(e,i,o,u){if(!at(e))return e;i=gi(i,e);for(var f=-1,g=i.length,m=g-1,b=e;b!=null&&++f<g;){var P=zr(i[f]),q=o;if(P==="__proto__"||P==="constructor"||P==="prototype")return e;if(f!=m){var M=b[P];q=u?u(M,P,b):t,q===t&&(q=at(M)?M:Xr(i[f+1])?[]:{})}In(b,P,q),b=b[P]}return e}var Ou=Fs?function(e,i){return Fs.set(e,i),e}:or,Fd=$s?function(e,i){return $s(e,"toString",{configurable:!0,enumerable:!1,value:Ha(i),writable:!0})}:or;function jd(e){return Ys(an(e))}function br(e,i,o){var u=-1,f=e.length;i<0&&(i=-i>f?0:f+i),o=o>f?f:o,o<0&&(o+=f),f=i>o?0:o-i>>>0,i>>>=0;for(var g=A(f);++u<f;)g[u]=e[u+i];return g}function Ld(e,i){var o;return pi(e,function(u,f,g){return o=i(u,f,g),!o}),!!o}function Hs(e,i,o){var u=0,f=e==null?u:e.length;if(typeof i=="number"&&i===i&&f<=Be){for(;u<f;){var g=u+f>>>1,m=e[g];m!==null&&!fr(m)&&(o?m<=i:m<i)?u=g+1:f=g}return f}return ya(e,i,or,o)}function ya(e,i,o,u){var f=0,g=e==null?0:e.length;if(g===0)return 0;i=o(i);for(var m=i!==i,b=i===null,P=fr(i),q=i===t;f<g;){var M=Ds((f+g)/2),B=o(e[M]),J=B!==t,re=B===null,ae=B===B,be=fr(B);if(m)var ce=u||ae;else q?ce=ae&&(u||J):b?ce=ae&&J&&(u||!re):P?ce=ae&&J&&!re&&(u||!be):re||be?ce=!1:ce=u?B<=i:B<i;ce?f=M+1:g=M}return kt(g,ct)}function Ru(e,i){for(var o=-1,u=e.length,f=0,g=[];++o<u;){var m=e[o],b=i?i(m):m;if(!o||!Ar(b,P)){var P=b;g[f++]=m===0?0:m}}return g}function Tu(e){return typeof e=="number"?e:fr(e)?k:+e}function lr(e){if(typeof e=="string")return e;if(_e(e))return it(e,lr)+"";if(fr(e))return au?au.call(e):"";var i=e+"";return i=="0"&&1/e==-oe?"-0":i}function di(e,i,o){var u=-1,f=bs,g=e.length,m=!0,b=[],P=b;if(o)m=!1,f=Vo;else if(g>=s){var q=i?null:Wd(e);if(q)return xs(q);m=!1,f=_n,P=new Ai}else P=i?[]:b;e:for(;++u<g;){var M=e[u],B=i?i(M):M;if(M=o||M!==0?M:0,m&&B===B){for(var J=P.length;J--;)if(P[J]===B)continue e;i&&P.push(B),b.push(M)}else f(P,B,o)||(P!==b&&P.push(B),b.push(M))}return b}function va(e,i){return i=gi(i,e),e=ih(e,i),e==null||delete e[zr(Er(i))]}function Cu(e,i,o,u){return Rn(e,i,o(Ni(e,i)),u)}function Bs(e,i,o,u){for(var f=e.length,g=u?f:-1;(u?g--:++g<f)&&i(e[g],g,e););return o?br(e,u?0:g,u?g+1:f):br(e,u?g+1:0,u?f:g)}function Au(e,i){var o=e;return o instanceof Te&&(o=o.value()),Ko(i,function(u,f){return f.func.apply(f.thisArg,hi([u],f.args))},o)}function _a(e,i,o){var u=e.length;if(u<2)return u?di(e[0]):[];for(var f=-1,g=A(u);++f<u;)for(var m=e[f],b=-1;++b<u;)b!=f&&(g[f]=Sn(g[f]||m,e[b],i,o));return di(Ht(g,1),i,o)}function $u(e,i,o){for(var u=-1,f=e.length,g=i.length,m={};++u<f;){var b=u<g?i[u]:t;o(m,e[u],b)}return m}function ma(e){return wt(e)?e:[]}function wa(e){return typeof e=="function"?e:or}function gi(e,i){return _e(e)?e:Ta(e,i)?[e]:ah(qe(e))}var qd=Se;function yi(e,i,o){var u=e.length;return o=o===t?u:o,!i&&o>=u?e:br(e,i,o)}var Nu=Sp||function(e){return Ce.clearTimeout(e)};function Du(e,i){if(i)return e.slice();var o=e.length,u=tu?tu(o):new e.constructor(o);return e.copy(u),u}function ba(e){var i=new e.constructor(e.byteLength);return new Ts(i).set(new Ts(e)),i}function Md(e,i){var o=i?ba(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function Ud(e){var i=new e.constructor(e.source,gr.exec(e));return i.lastIndex=e.lastIndex,i}function zd(e){return xn?We(xn.call(e)):{}}function Fu(e,i){var o=i?ba(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function ju(e,i){if(e!==i){var o=e!==t,u=e===null,f=e===e,g=fr(e),m=i!==t,b=i===null,P=i===i,q=fr(i);if(!b&&!q&&!g&&e>i||g&&m&&P&&!b&&!q||u&&m&&P||!o&&P||!f)return 1;if(!u&&!g&&!q&&e<i||q&&o&&f&&!u&&!g||b&&o&&f||!m&&f||!P)return-1}return 0}function Hd(e,i,o){for(var u=-1,f=e.criteria,g=i.criteria,m=f.length,b=o.length;++u<m;){var P=ju(f[u],g[u]);if(P){if(u>=b)return P;var q=o[u];return P*(q=="desc"?-1:1)}}return e.index-i.index}function Lu(e,i,o,u){for(var f=-1,g=e.length,m=o.length,b=-1,P=i.length,q=jt(g-m,0),M=A(P+q),B=!u;++b<P;)M[b]=i[b];for(;++f<m;)(B||f<g)&&(M[o[f]]=e[f]);for(;q--;)M[b++]=e[f++];return M}function qu(e,i,o,u){for(var f=-1,g=e.length,m=-1,b=o.length,P=-1,q=i.length,M=jt(g-b,0),B=A(M+q),J=!u;++f<M;)B[f]=e[f];for(var re=f;++P<q;)B[re+P]=i[P];for(;++m<b;)(J||f<g)&&(B[re+o[m]]=e[f++]);return B}function ir(e,i){var o=-1,u=e.length;for(i||(i=A(u));++o<u;)i[o]=e[o];return i}function Ur(e,i,o,u){var f=!o;o||(o={});for(var g=-1,m=i.length;++g<m;){var b=i[g],P=u?u(o[b],e[b],b,o,e):t;P===t&&(P=e[b]),f?Jr(o,b,P):In(o,b,P)}return o}function Bd(e,i){return Ur(e,Ra(e),i)}function kd(e,i){return Ur(e,Yu(e),i)}function ks(e,i){return function(o,u){var f=_e(o)?Jf:fd,g=i?i():{};return f(o,e,se(u,2),g)}}function rn(e){return Se(function(i,o){var u=-1,f=o.length,g=f>1?o[f-1]:t,m=f>2?o[2]:t;for(g=e.length>3&&typeof g=="function"?(f--,g):t,m&&Yt(o[0],o[1],m)&&(g=f<3?t:g,f=1),i=We(i);++u<f;){var b=o[u];b&&e(i,b,u,g)}return i})}function Mu(e,i){return function(o,u){if(o==null)return o;if(!nr(o))return e(o,u);for(var f=o.length,g=i?f:-1,m=We(o);(i?g--:++g<f)&&u(m[g],g,m)!==!1;);return o}}function Uu(e){return function(i,o,u){for(var f=-1,g=We(i),m=u(i),b=m.length;b--;){var P=m[e?b:++f];if(o(g[P],P,g)===!1)break}return i}}function Vd(e,i,o){var u=i&ne,f=Tn(e);function g(){var m=this&&this!==Ce&&this instanceof g?f:e;return m.apply(u?o:this,arguments)}return g}function zu(e){return function(i){i=qe(i);var o=Ji(i)?Tr(i):t,u=o?o[0]:i.charAt(0),f=o?yi(o,1).join(""):i.slice(1);return u[e]()+f}}function nn(e){return function(i){return Ko(Mh(qh(i).replace(yn,"")),e,"")}}function Tn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=tn(e.prototype),u=e.apply(o,i);return at(u)?u:o}}function Kd(e,i,o){var u=Tn(e);function f(){for(var g=arguments.length,m=A(g),b=g,P=sn(f);b--;)m[b]=arguments[b];var q=g<3&&m[0]!==P&&m[g-1]!==P?[]:li(m,P);if(g-=q.length,g<o)return Ku(e,i,Vs,f.placeholder,t,m,q,t,t,o-g);var M=this&&this!==Ce&&this instanceof f?u:e;return qt(M,this,m)}return f}function Hu(e){return function(i,o,u){var f=We(i);if(!nr(i)){var g=se(o,3);i=Mt(i),o=function(b){return g(f[b],b,f)}}var m=e(i,o,u);return m>-1?f[g?i[m]:m]:t}}function Bu(e){return Yr(function(i){var o=i.length,u=o,f=mr.prototype.thru;for(e&&i.reverse();u--;){var g=i[u];if(typeof g!="function")throw new _r(l);if(f&&!m&&Js(g)=="wrapper")var m=new mr([],!0)}for(u=m?u:o;++u<o;){g=i[u];var b=Js(g),P=b=="wrapper"?Pa(g):t;P&&Ca(P[0])&&P[1]==(U|le|fe|Q)&&!P[4].length&&P[9]==1?m=m[Js(P[0])].apply(m,P[3]):m=g.length==1&&Ca(g)?m[b]():m.thru(g)}return function(){var q=arguments,M=q[0];if(m&&q.length==1&&_e(M))return m.plant(M).value();for(var B=0,J=o?i[B].apply(this,q):M;++B<o;)J=i[B].call(this,J);return J}})}function Vs(e,i,o,u,f,g,m,b,P,q){var M=i&U,B=i&ne,J=i&Ee,re=i&(le|ue),ae=i&ye,be=J?t:Tn(e);function ce(){for(var Pe=arguments.length,Ae=A(Pe),pr=Pe;pr--;)Ae[pr]=arguments[pr];if(re)var Xt=sn(ce),dr=np(Ae,Xt);if(u&&(Ae=Lu(Ae,u,f,re)),g&&(Ae=qu(Ae,g,m,re)),Pe-=dr,re&&Pe<q){var bt=li(Ae,Xt);return Ku(e,i,Vs,ce.placeholder,o,Ae,bt,b,P,q-Pe)}var $r=B?o:this,ti=J?$r[e]:e;return Pe=Ae.length,b?Ae=fg(Ae,b):ae&&Pe>1&&Ae.reverse(),M&&P<Pe&&(Ae.length=P),this&&this!==Ce&&this instanceof ce&&(ti=be||Tn(ti)),ti.apply($r,Ae)}return ce}function ku(e,i){return function(o,u){return wd(o,e,i(u),{})}}function Ks(e,i){return function(o,u){var f;if(o===t&&u===t)return i;if(o!==t&&(f=o),u!==t){if(f===t)return u;typeof o=="string"||typeof u=="string"?(o=lr(o),u=lr(u)):(o=Tu(o),u=Tu(u)),f=e(o,u)}return f}}function Ea(e){return Yr(function(i){return i=it(i,hr(se())),Se(function(o){var u=this;return e(i,function(f){return qt(f,u,o)})})})}function Gs(e,i){i=i===t?" ":lr(i);var o=i.length;if(o<2)return o?ga(i,e):i;var u=ga(i,Ns(e/Qi(i)));return Ji(i)?yi(Tr(u),0,e).join(""):u.slice(0,e)}function Gd(e,i,o,u){var f=i&ne,g=Tn(e);function m(){for(var b=-1,P=arguments.length,q=-1,M=u.length,B=A(M+P),J=this&&this!==Ce&&this instanceof m?g:e;++q<M;)B[q]=u[q];for(;P--;)B[q++]=arguments[++b];return qt(J,f?o:this,B)}return m}function Vu(e){return function(i,o,u){return u&&typeof u!="number"&&Yt(i,o,u)&&(o=u=t),i=ei(i),o===t?(o=i,i=0):o=ei(o),u=u===t?i<o?1:-1:ei(u),$d(i,o,u,e)}}function Ws(e){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=xr(i),o=xr(o)),e(i,o)}}function Ku(e,i,o,u,f,g,m,b,P,q){var M=i&le,B=M?m:t,J=M?t:m,re=M?g:t,ae=M?t:g;i|=M?fe:D,i&=~(M?D:fe),i&ge||(i&=~(ne|Ee));var be=[e,i,f,re,B,ae,J,b,P,q],ce=o.apply(t,be);return Ca(e)&&nh(ce,be),ce.placeholder=u,sh(ce,e,i)}function xa(e){var i=Ft[e];return function(o,u){if(o=xr(o),u=u==null?0:kt(me(u),292),u&&su(o)){var f=(qe(o)+"e").split("e"),g=i(f[0]+"e"+(+f[1]+u));return f=(qe(g)+"e").split("e"),+(f[0]+"e"+(+f[1]-u))}return i(o)}}var Wd=Zi&&1/xs(new Zi([,-0]))[1]==oe?function(e){return new Zi(e)}:Va;function Gu(e){return function(i){var o=Vt(i);return o==we?Zo(i):o==Le?lp(i):ip(i,e(i))}}function Qr(e,i,o,u,f,g,m,b){var P=i&Ee;if(!P&&typeof e!="function")throw new _r(l);var q=u?u.length:0;if(q||(i&=~(fe|D),u=f=t),m=m===t?m:jt(me(m),0),b=b===t?b:me(b),q-=f?f.length:0,i&D){var M=u,B=f;u=f=t}var J=P?t:Pa(e),re=[e,i,o,u,f,M,B,g,m,b];if(J&&ug(re,J),e=re[0],i=re[1],o=re[2],u=re[3],f=re[4],b=re[9]=re[9]===t?P?0:e.length:jt(re[9]-q,0),!b&&i&(le|ue)&&(i&=~(le|ue)),!i||i==ne)var ae=Vd(e,i,o);else i==le||i==ue?ae=Kd(e,i,b):(i==fe||i==(ne|fe))&&!f.length?ae=Gd(e,i,o,u):ae=Vs.apply(t,re);var be=J?Ou:nh;return sh(be(ae,re),e,i)}function Wu(e,i,o,u){return e===t||Ar(e,Xi[o])&&!Ue.call(u,o)?i:e}function Ju(e,i,o,u,f,g){return at(e)&&at(i)&&(g.set(i,e),zs(e,i,t,Ju,g),g.delete(i)),e}function Jd(e){return $n(e)?t:e}function Qu(e,i,o,u,f,g){var m=o&H,b=e.length,P=i.length;if(b!=P&&!(m&&P>b))return!1;var q=g.get(e),M=g.get(i);if(q&&M)return q==i&&M==e;var B=-1,J=!0,re=o&K?new Ai:t;for(g.set(e,i),g.set(i,e);++B<b;){var ae=e[B],be=i[B];if(u)var ce=m?u(be,ae,B,i,e,g):u(ae,be,B,e,i,g);if(ce!==t){if(ce)continue;J=!1;break}if(re){if(!Go(i,function(Pe,Ae){if(!_n(re,Ae)&&(ae===Pe||f(ae,Pe,o,u,g)))return re.push(Ae)})){J=!1;break}}else if(!(ae===be||f(ae,be,o,u,g))){J=!1;break}}return g.delete(e),g.delete(i),J}function Qd(e,i,o,u,f,g,m){switch(o){case ke:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case De:return!(e.byteLength!=i.byteLength||!g(new Ts(e),new Ts(i)));case $:case O:case Ne:return Ar(+e,+i);case E:return e.name==i.name&&e.message==i.message;case nt:case Qe:return e==i+"";case we:var b=Zo;case Le:var P=u&H;if(b||(b=xs),e.size!=i.size&&!P)return!1;var q=m.get(e);if(q)return q==i;u|=K,m.set(e,i);var M=Qu(b(e),b(i),u,f,g,m);return m.delete(e),M;case Ye:if(xn)return xn.call(e)==xn.call(i)}return!1}function Yd(e,i,o,u,f,g){var m=o&H,b=Ia(e),P=b.length,q=Ia(i),M=q.length;if(P!=M&&!m)return!1;for(var B=P;B--;){var J=b[B];if(!(m?J in i:Ue.call(i,J)))return!1}var re=g.get(e),ae=g.get(i);if(re&&ae)return re==i&&ae==e;var be=!0;g.set(e,i),g.set(i,e);for(var ce=m;++B<P;){J=b[B];var Pe=e[J],Ae=i[J];if(u)var pr=m?u(Ae,Pe,J,i,e,g):u(Pe,Ae,J,e,i,g);if(!(pr===t?Pe===Ae||f(Pe,Ae,o,u,g):pr)){be=!1;break}ce||(ce=J=="constructor")}if(be&&!ce){var Xt=e.constructor,dr=i.constructor;Xt!=dr&&"constructor"in e&&"constructor"in i&&!(typeof Xt=="function"&&Xt instanceof Xt&&typeof dr=="function"&&dr instanceof dr)&&(be=!1)}return g.delete(e),g.delete(i),be}function Yr(e){return $a(rh(e,t,lh),e+"")}function Ia(e){return yu(e,Mt,Ra)}function Sa(e){return yu(e,sr,Yu)}var Pa=Fs?function(e){return Fs.get(e)}:Va;function Js(e){for(var i=e.name+"",o=en[i],u=Ue.call(en,i)?o.length:0;u--;){var f=o[u],g=f.func;if(g==null||g==e)return f.name}return i}function sn(e){var i=Ue.call(p,"placeholder")?p:e;return i.placeholder}function se(){var e=p.iteratee||Ba;return e=e===Ba?mu:e,arguments.length?e(arguments[0],arguments[1]):e}function Qs(e,i){var o=e.__data__;return sg(i)?o[typeof i=="string"?"string":"hash"]:o.map}function Oa(e){for(var i=Mt(e),o=i.length;o--;){var u=i[o],f=e[u];i[o]=[u,f,eh(f)]}return i}function Di(e,i){var o=cp(e,i);return _u(o)?o:t}function Xd(e){var i=Ue.call(e,Ti),o=e[Ti];try{e[Ti]=t;var u=!0}catch{}var f=Os.call(e);return u&&(i?e[Ti]=o:delete e[Ti]),f}var Ra=ta?function(e){return e==null?[]:(e=We(e),ui(ta(e),function(i){return iu.call(e,i)}))}:Ka,Yu=ta?function(e){for(var i=[];e;)hi(i,Ra(e)),e=Cs(e);return i}:Ka,Vt=Qt;(ra&&Vt(new ra(new ArrayBuffer(1)))!=ke||wn&&Vt(new wn)!=we||ia&&Vt(ia.resolve())!=It||Zi&&Vt(new Zi)!=Le||bn&&Vt(new bn)!=ze)&&(Vt=function(e){var i=Qt(e),o=i==Re?e.constructor:t,u=o?Fi(o):"";if(u)switch(u){case Dp:return ke;case Fp:return we;case jp:return It;case Lp:return Le;case qp:return ze}return i});function Zd(e,i,o){for(var u=-1,f=o.length;++u<f;){var g=o[u],m=g.size;switch(g.type){case"drop":e+=m;break;case"dropRight":i-=m;break;case"take":i=kt(i,e+m);break;case"takeRight":e=jt(e,i-m);break}}return{start:e,end:i}}function eg(e){var i=e.match(Je);return i?i[1].split(Tt):[]}function Xu(e,i,o){i=gi(i,e);for(var u=-1,f=i.length,g=!1;++u<f;){var m=zr(i[u]);if(!(g=e!=null&&o(e,m)))break;e=e[m]}return g||++u!=f?g:(f=e==null?0:e.length,!!f&&io(f)&&Xr(m,f)&&(_e(e)||ji(e)))}function tg(e){var i=e.length,o=new e.constructor(i);return i&&typeof e[0]=="string"&&Ue.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function Zu(e){return typeof e.constructor=="function"&&!Cn(e)?tn(Cs(e)):{}}function rg(e,i,o){var u=e.constructor;switch(i){case De:return ba(e);case $:case O:return new u(+e);case ke:return Md(e,o);case ut:case Me:case St:case Dt:case Ut:case zt:case Lt:case Gt:case tr:return Fu(e,o);case we:return new u;case Ne:case Qe:return new u(e);case nt:return Ud(e);case Le:return new u;case Ye:return zd(e)}}function ig(e,i){var o=i.length;if(!o)return e;var u=o-1;return i[u]=(o>1?"& ":"")+i[u],i=i.join(o>2?", ":" "),e.replace(gt,`{
/* [wrapped with `+i+`] */
`)}function ng(e){return _e(e)||ji(e)||!!(nu&&e&&e[nu])}function Xr(e,i){var o=typeof e;return i=i??V,!!i&&(o=="number"||o!="symbol"&&Ao.test(e))&&e>-1&&e%1==0&&e<i}function Yt(e,i,o){if(!at(o))return!1;var u=typeof i;return(u=="number"?nr(o)&&Xr(i,o.length):u=="string"&&i in o)?Ar(o[i],e):!1}function Ta(e,i){if(_e(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||fr(e)?!0:Pt.test(e)||!rt.test(e)||i!=null&&e in We(i)}function sg(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function Ca(e){var i=Js(e),o=p[i];if(typeof o!="function"||!(i in Te.prototype))return!1;if(e===o)return!0;var u=Pa(o);return!!u&&e===u[0]}function og(e){return!!eu&&eu in e}var ag=Ss?Zr:Ga;function Cn(e){var i=e&&e.constructor,o=typeof i=="function"&&i.prototype||Xi;return e===o}function eh(e){return e===e&&!at(e)}function th(e,i){return function(o){return o==null?!1:o[e]===i&&(i!==t||e in We(o))}}function cg(e){var i=to(e,function(u){return o.size===y&&o.clear(),u}),o=i.cache;return i}function ug(e,i){var o=e[1],u=i[1],f=o|u,g=f<(ne|Ee|U),m=u==U&&o==le||u==U&&o==Q&&e[7].length<=i[8]||u==(U|Q)&&i[7].length<=i[8]&&o==le;if(!(g||m))return e;u&ne&&(e[2]=i[2],f|=o&ne?0:ge);var b=i[3];if(b){var P=e[3];e[3]=P?Lu(P,b,i[4]):b,e[4]=P?li(e[3],S):i[4]}return b=i[5],b&&(P=e[5],e[5]=P?qu(P,b,i[6]):b,e[6]=P?li(e[5],S):i[6]),b=i[7],b&&(e[7]=b),u&U&&(e[8]=e[8]==null?i[8]:kt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=f,e}function hg(e){var i=[];if(e!=null)for(var o in We(e))i.push(o);return i}function lg(e){return Os.call(e)}function rh(e,i,o){return i=jt(i===t?e.length-1:i,0),function(){for(var u=arguments,f=-1,g=jt(u.length-i,0),m=A(g);++f<g;)m[f]=u[i+f];f=-1;for(var b=A(i+1);++f<i;)b[f]=u[f];return b[i]=o(m),qt(e,this,b)}}function ih(e,i){return i.length<2?e:Ni(e,br(i,0,-1))}function fg(e,i){for(var o=e.length,u=kt(i.length,o),f=ir(e);u--;){var g=i[u];e[u]=Xr(g,o)?f[g]:t}return e}function Aa(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var nh=oh(Ou),An=Op||function(e,i){return Ce.setTimeout(e,i)},$a=oh(Fd);function sh(e,i,o){var u=i+"";return $a(e,ig(u,pg(eg(u),o)))}function oh(e){var i=0,o=0;return function(){var u=Ap(),f=T-(u-o);if(o=u,f>0){if(++i>=Oe)return arguments[0]}else i=0;return e.apply(t,arguments)}}function Ys(e,i){var o=-1,u=e.length,f=u-1;for(i=i===t?u:i;++o<i;){var g=da(o,f),m=e[g];e[g]=e[o],e[o]=m}return e.length=i,e}var ah=cg(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Ot,function(o,u,f,g){i.push(f?g.replace(So,"$1"):u||o)}),i});function zr(e){if(typeof e=="string"||fr(e))return e;var i=e+"";return i=="0"&&1/e==-oe?"-0":i}function Fi(e){if(e!=null){try{return Ps.call(e)}catch{}try{return e+""}catch{}}return""}function pg(e,i){return vr(Fr,function(o){var u="_."+o[0];i&o[1]&&!bs(e,u)&&e.push(u)}),e.sort()}function ch(e){if(e instanceof Te)return e.clone();var i=new mr(e.__wrapped__,e.__chain__);return i.__actions__=ir(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function dg(e,i,o){(o?Yt(e,i,o):i===t)?i=1:i=jt(me(i),0);var u=e==null?0:e.length;if(!u||i<1)return[];for(var f=0,g=0,m=A(Ns(u/i));f<u;)m[g++]=br(e,f,f+=i);return m}function gg(e){for(var i=-1,o=e==null?0:e.length,u=0,f=[];++i<o;){var g=e[i];g&&(f[u++]=g)}return f}function yg(){var e=arguments.length;if(!e)return[];for(var i=A(e-1),o=arguments[0],u=e;u--;)i[u-1]=arguments[u];return hi(_e(o)?ir(o):[o],Ht(i,1))}var vg=Se(function(e,i){return wt(e)?Sn(e,Ht(i,1,wt,!0)):[]}),_g=Se(function(e,i){var o=Er(i);return wt(o)&&(o=t),wt(e)?Sn(e,Ht(i,1,wt,!0),se(o,2)):[]}),mg=Se(function(e,i){var o=Er(i);return wt(o)&&(o=t),wt(e)?Sn(e,Ht(i,1,wt,!0),t,o):[]});function wg(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===t?1:me(i),br(e,i<0?0:i,u)):[]}function bg(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===t?1:me(i),i=u-i,br(e,0,i<0?0:i)):[]}function Eg(e,i){return e&&e.length?Bs(e,se(i,3),!0,!0):[]}function xg(e,i){return e&&e.length?Bs(e,se(i,3),!0):[]}function Ig(e,i,o,u){var f=e==null?0:e.length;return f?(o&&typeof o!="number"&&Yt(e,i,o)&&(o=0,u=f),yd(e,i,o,u)):[]}function uh(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=o==null?0:me(o);return f<0&&(f=jt(u+f,0)),Es(e,se(i,3),f)}function hh(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=u-1;return o!==t&&(f=me(o),f=o<0?jt(u+f,0):kt(f,u-1)),Es(e,se(i,3),f,!0)}function lh(e){var i=e==null?0:e.length;return i?Ht(e,1):[]}function Sg(e){var i=e==null?0:e.length;return i?Ht(e,oe):[]}function Pg(e,i){var o=e==null?0:e.length;return o?(i=i===t?1:me(i),Ht(e,i)):[]}function Og(e){for(var i=-1,o=e==null?0:e.length,u={};++i<o;){var f=e[i];u[f[0]]=f[1]}return u}function fh(e){return e&&e.length?e[0]:t}function Rg(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=o==null?0:me(o);return f<0&&(f=jt(u+f,0)),Wi(e,i,f)}function Tg(e){var i=e==null?0:e.length;return i?br(e,0,-1):[]}var Cg=Se(function(e){var i=it(e,ma);return i.length&&i[0]===e[0]?ua(i):[]}),Ag=Se(function(e){var i=Er(e),o=it(e,ma);return i===Er(o)?i=t:o.pop(),o.length&&o[0]===e[0]?ua(o,se(i,2)):[]}),$g=Se(function(e){var i=Er(e),o=it(e,ma);return i=typeof i=="function"?i:t,i&&o.pop(),o.length&&o[0]===e[0]?ua(o,t,i):[]});function Ng(e,i){return e==null?"":Tp.call(e,i)}function Er(e){var i=e==null?0:e.length;return i?e[i-1]:t}function Dg(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=u;return o!==t&&(f=me(o),f=f<0?jt(u+f,0):kt(f,u-1)),i===i?pp(e,i,f):Es(e,Kc,f,!0)}function Fg(e,i){return e&&e.length?xu(e,me(i)):t}var jg=Se(ph);function ph(e,i){return e&&e.length&&i&&i.length?pa(e,i):e}function Lg(e,i,o){return e&&e.length&&i&&i.length?pa(e,i,se(o,2)):e}function qg(e,i,o){return e&&e.length&&i&&i.length?pa(e,i,t,o):e}var Mg=Yr(function(e,i){var o=e==null?0:e.length,u=sa(e,i);return Pu(e,it(i,function(f){return Xr(f,o)?+f:f}).sort(ju)),u});function Ug(e,i){var o=[];if(!(e&&e.length))return o;var u=-1,f=[],g=e.length;for(i=se(i,3);++u<g;){var m=e[u];i(m,u,e)&&(o.push(m),f.push(u))}return Pu(e,f),o}function Na(e){return e==null?e:Np.call(e)}function zg(e,i,o){var u=e==null?0:e.length;return u?(o&&typeof o!="number"&&Yt(e,i,o)?(i=0,o=u):(i=i==null?0:me(i),o=o===t?u:me(o)),br(e,i,o)):[]}function Hg(e,i){return Hs(e,i)}function Bg(e,i,o){return ya(e,i,se(o,2))}function kg(e,i){var o=e==null?0:e.length;if(o){var u=Hs(e,i);if(u<o&&Ar(e[u],i))return u}return-1}function Vg(e,i){return Hs(e,i,!0)}function Kg(e,i,o){return ya(e,i,se(o,2),!0)}function Gg(e,i){var o=e==null?0:e.length;if(o){var u=Hs(e,i,!0)-1;if(Ar(e[u],i))return u}return-1}function Wg(e){return e&&e.length?Ru(e):[]}function Jg(e,i){return e&&e.length?Ru(e,se(i,2)):[]}function Qg(e){var i=e==null?0:e.length;return i?br(e,1,i):[]}function Yg(e,i,o){return e&&e.length?(i=o||i===t?1:me(i),br(e,0,i<0?0:i)):[]}function Xg(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===t?1:me(i),i=u-i,br(e,i<0?0:i,u)):[]}function Zg(e,i){return e&&e.length?Bs(e,se(i,3),!1,!0):[]}function ey(e,i){return e&&e.length?Bs(e,se(i,3)):[]}var ty=Se(function(e){return di(Ht(e,1,wt,!0))}),ry=Se(function(e){var i=Er(e);return wt(i)&&(i=t),di(Ht(e,1,wt,!0),se(i,2))}),iy=Se(function(e){var i=Er(e);return i=typeof i=="function"?i:t,di(Ht(e,1,wt,!0),t,i)});function ny(e){return e&&e.length?di(e):[]}function sy(e,i){return e&&e.length?di(e,se(i,2)):[]}function oy(e,i){return i=typeof i=="function"?i:t,e&&e.length?di(e,t,i):[]}function Da(e){if(!(e&&e.length))return[];var i=0;return e=ui(e,function(o){if(wt(o))return i=jt(o.length,i),!0}),Yo(i,function(o){return it(e,Wo(o))})}function dh(e,i){if(!(e&&e.length))return[];var o=Da(e);return i==null?o:it(o,function(u){return qt(i,t,u)})}var ay=Se(function(e,i){return wt(e)?Sn(e,i):[]}),cy=Se(function(e){return _a(ui(e,wt))}),uy=Se(function(e){var i=Er(e);return wt(i)&&(i=t),_a(ui(e,wt),se(i,2))}),hy=Se(function(e){var i=Er(e);return i=typeof i=="function"?i:t,_a(ui(e,wt),t,i)}),ly=Se(Da);function fy(e,i){return $u(e||[],i||[],In)}function py(e,i){return $u(e||[],i||[],Rn)}var dy=Se(function(e){var i=e.length,o=i>1?e[i-1]:t;return o=typeof o=="function"?(e.pop(),o):t,dh(e,o)});function gh(e){var i=p(e);return i.__chain__=!0,i}function gy(e,i){return i(e),e}function Xs(e,i){return i(e)}var yy=Yr(function(e){var i=e.length,o=i?e[0]:0,u=this.__wrapped__,f=function(g){return sa(g,e)};return i>1||this.__actions__.length||!(u instanceof Te)||!Xr(o)?this.thru(f):(u=u.slice(o,+o+(i?1:0)),u.__actions__.push({func:Xs,args:[f],thisArg:t}),new mr(u,this.__chain__).thru(function(g){return i&&!g.length&&g.push(t),g}))});function vy(){return gh(this)}function _y(){return new mr(this.value(),this.__chain__)}function my(){this.__values__===t&&(this.__values__=Th(this.value()));var e=this.__index__>=this.__values__.length,i=e?t:this.__values__[this.__index__++];return{done:e,value:i}}function wy(){return this}function by(e){for(var i,o=this;o instanceof Ls;){var u=ch(o);u.__index__=0,u.__values__=t,i?f.__wrapped__=u:i=u;var f=u;o=o.__wrapped__}return f.__wrapped__=e,i}function Ey(){var e=this.__wrapped__;if(e instanceof Te){var i=e;return this.__actions__.length&&(i=new Te(this)),i=i.reverse(),i.__actions__.push({func:Xs,args:[Na],thisArg:t}),new mr(i,this.__chain__)}return this.thru(Na)}function xy(){return Au(this.__wrapped__,this.__actions__)}var Iy=ks(function(e,i,o){Ue.call(e,o)?++e[o]:Jr(e,o,1)});function Sy(e,i,o){var u=_e(e)?kc:gd;return o&&Yt(e,i,o)&&(i=t),u(e,se(i,3))}function Py(e,i){var o=_e(e)?ui:du;return o(e,se(i,3))}var Oy=Hu(uh),Ry=Hu(hh);function Ty(e,i){return Ht(Zs(e,i),1)}function Cy(e,i){return Ht(Zs(e,i),oe)}function Ay(e,i,o){return o=o===t?1:me(o),Ht(Zs(e,i),o)}function yh(e,i){var o=_e(e)?vr:pi;return o(e,se(i,3))}function vh(e,i){var o=_e(e)?Qf:pu;return o(e,se(i,3))}var $y=ks(function(e,i,o){Ue.call(e,o)?e[o].push(i):Jr(e,o,[i])});function Ny(e,i,o,u){e=nr(e)?e:an(e),o=o&&!u?me(o):0;var f=e.length;return o<0&&(o=jt(f+o,0)),no(e)?o<=f&&e.indexOf(i,o)>-1:!!f&&Wi(e,i,o)>-1}var Dy=Se(function(e,i,o){var u=-1,f=typeof i=="function",g=nr(e)?A(e.length):[];return pi(e,function(m){g[++u]=f?qt(i,m,o):Pn(m,i,o)}),g}),Fy=ks(function(e,i,o){Jr(e,o,i)});function Zs(e,i){var o=_e(e)?it:wu;return o(e,se(i,3))}function jy(e,i,o,u){return e==null?[]:(_e(i)||(i=i==null?[]:[i]),o=u?t:o,_e(o)||(o=o==null?[]:[o]),Iu(e,i,o))}var Ly=ks(function(e,i,o){e[o?0:1].push(i)},function(){return[[],[]]});function qy(e,i,o){var u=_e(e)?Ko:Wc,f=arguments.length<3;return u(e,se(i,4),o,f,pi)}function My(e,i,o){var u=_e(e)?Yf:Wc,f=arguments.length<3;return u(e,se(i,4),o,f,pu)}function Uy(e,i){var o=_e(e)?ui:du;return o(e,ro(se(i,3)))}function zy(e){var i=_e(e)?uu:Nd;return i(e)}function Hy(e,i,o){(o?Yt(e,i,o):i===t)?i=1:i=me(i);var u=_e(e)?hd:Dd;return u(e,i)}function By(e){var i=_e(e)?ld:jd;return i(e)}function ky(e){if(e==null)return 0;if(nr(e))return no(e)?Qi(e):e.length;var i=Vt(e);return i==we||i==Le?e.size:la(e).length}function Vy(e,i,o){var u=_e(e)?Go:Ld;return o&&Yt(e,i,o)&&(i=t),u(e,se(i,3))}var Ky=Se(function(e,i){if(e==null)return[];var o=i.length;return o>1&&Yt(e,i[0],i[1])?i=[]:o>2&&Yt(i[0],i[1],i[2])&&(i=[i[0]]),Iu(e,Ht(i,1),[])}),eo=Pp||function(){return Ce.Date.now()};function Gy(e,i){if(typeof i!="function")throw new _r(l);return e=me(e),function(){if(--e<1)return i.apply(this,arguments)}}function _h(e,i,o){return i=o?t:i,i=e&&i==null?e.length:i,Qr(e,U,t,t,t,t,i)}function mh(e,i){var o;if(typeof i!="function")throw new _r(l);return e=me(e),function(){return--e>0&&(o=i.apply(this,arguments)),e<=1&&(i=t),o}}var Fa=Se(function(e,i,o){var u=ne;if(o.length){var f=li(o,sn(Fa));u|=fe}return Qr(e,u,i,o,f)}),wh=Se(function(e,i,o){var u=ne|Ee;if(o.length){var f=li(o,sn(wh));u|=fe}return Qr(i,u,e,o,f)});function bh(e,i,o){i=o?t:i;var u=Qr(e,le,t,t,t,t,t,i);return u.placeholder=bh.placeholder,u}function Eh(e,i,o){i=o?t:i;var u=Qr(e,ue,t,t,t,t,t,i);return u.placeholder=Eh.placeholder,u}function xh(e,i,o){var u,f,g,m,b,P,q=0,M=!1,B=!1,J=!0;if(typeof e!="function")throw new _r(l);i=xr(i)||0,at(o)&&(M=!!o.leading,B="maxWait"in o,g=B?jt(xr(o.maxWait)||0,i):g,J="trailing"in o?!!o.trailing:J);function re(bt){var $r=u,ti=f;return u=f=t,q=bt,m=e.apply(ti,$r),m}function ae(bt){return q=bt,b=An(Pe,i),M?re(bt):m}function be(bt){var $r=bt-P,ti=bt-q,Hh=i-$r;return B?kt(Hh,g-ti):Hh}function ce(bt){var $r=bt-P,ti=bt-q;return P===t||$r>=i||$r<0||B&&ti>=g}function Pe(){var bt=eo();if(ce(bt))return Ae(bt);b=An(Pe,be(bt))}function Ae(bt){return b=t,J&&u?re(bt):(u=f=t,m)}function pr(){b!==t&&Nu(b),q=0,u=P=f=b=t}function Xt(){return b===t?m:Ae(eo())}function dr(){var bt=eo(),$r=ce(bt);if(u=arguments,f=this,P=bt,$r){if(b===t)return ae(P);if(B)return Nu(b),b=An(Pe,i),re(P)}return b===t&&(b=An(Pe,i)),m}return dr.cancel=pr,dr.flush=Xt,dr}var Wy=Se(function(e,i){return fu(e,1,i)}),Jy=Se(function(e,i,o){return fu(e,xr(i)||0,o)});function Qy(e){return Qr(e,ye)}function to(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new _r(l);var o=function(){var u=arguments,f=i?i.apply(this,u):u[0],g=o.cache;if(g.has(f))return g.get(f);var m=e.apply(this,u);return o.cache=g.set(f,m)||g,m};return o.cache=new(to.Cache||Wr),o}to.Cache=Wr;function ro(e){if(typeof e!="function")throw new _r(l);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function Yy(e){return mh(2,e)}var Xy=qd(function(e,i){i=i.length==1&&_e(i[0])?it(i[0],hr(se())):it(Ht(i,1),hr(se()));var o=i.length;return Se(function(u){for(var f=-1,g=kt(u.length,o);++f<g;)u[f]=i[f].call(this,u[f]);return qt(e,this,u)})}),ja=Se(function(e,i){var o=li(i,sn(ja));return Qr(e,fe,t,i,o)}),Ih=Se(function(e,i){var o=li(i,sn(Ih));return Qr(e,D,t,i,o)}),Zy=Yr(function(e,i){return Qr(e,Q,t,t,t,i)});function e0(e,i){if(typeof e!="function")throw new _r(l);return i=i===t?i:me(i),Se(e,i)}function t0(e,i){if(typeof e!="function")throw new _r(l);return i=i==null?0:jt(me(i),0),Se(function(o){var u=o[i],f=yi(o,0,i);return u&&hi(f,u),qt(e,this,f)})}function r0(e,i,o){var u=!0,f=!0;if(typeof e!="function")throw new _r(l);return at(o)&&(u="leading"in o?!!o.leading:u,f="trailing"in o?!!o.trailing:f),xh(e,i,{leading:u,maxWait:i,trailing:f})}function i0(e){return _h(e,1)}function n0(e,i){return ja(wa(i),e)}function s0(){if(!arguments.length)return[];var e=arguments[0];return _e(e)?e:[e]}function o0(e){return wr(e,F)}function a0(e,i){return i=typeof i=="function"?i:t,wr(e,F,i)}function c0(e){return wr(e,L|F)}function u0(e,i){return i=typeof i=="function"?i:t,wr(e,L|F,i)}function h0(e,i){return i==null||lu(e,i,Mt(i))}function Ar(e,i){return e===i||e!==e&&i!==i}var l0=Ws(ca),f0=Ws(function(e,i){return e>=i}),ji=vu(function(){return arguments}())?vu:function(e){return yt(e)&&Ue.call(e,"callee")&&!iu.call(e,"callee")},_e=A.isArray,p0=Jt?hr(Jt):bd;function nr(e){return e!=null&&io(e.length)&&!Zr(e)}function wt(e){return yt(e)&&nr(e)}function d0(e){return e===!0||e===!1||yt(e)&&Qt(e)==$}var vi=Rp||Ga,g0=Rr?hr(Rr):Ed;function y0(e){return yt(e)&&e.nodeType===1&&!$n(e)}function v0(e){if(e==null)return!0;if(nr(e)&&(_e(e)||typeof e=="string"||typeof e.splice=="function"||vi(e)||on(e)||ji(e)))return!e.length;var i=Vt(e);if(i==we||i==Le)return!e.size;if(Cn(e))return!la(e).length;for(var o in e)if(Ue.call(e,o))return!1;return!0}function _0(e,i){return On(e,i)}function m0(e,i,o){o=typeof o=="function"?o:t;var u=o?o(e,i):t;return u===t?On(e,i,t,o):!!u}function La(e){if(!yt(e))return!1;var i=Qt(e);return i==E||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!$n(e)}function w0(e){return typeof e=="number"&&su(e)}function Zr(e){if(!at(e))return!1;var i=Qt(e);return i==te||i==he||i==N||i==vt}function Sh(e){return typeof e=="number"&&e==me(e)}function io(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=V}function at(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function yt(e){return e!=null&&typeof e=="object"}var Ph=yr?hr(yr):Id;function b0(e,i){return e===i||ha(e,i,Oa(i))}function E0(e,i,o){return o=typeof o=="function"?o:t,ha(e,i,Oa(i),o)}function x0(e){return Oh(e)&&e!=+e}function I0(e){if(ag(e))throw new de(c);return _u(e)}function S0(e){return e===null}function P0(e){return e==null}function Oh(e){return typeof e=="number"||yt(e)&&Qt(e)==Ne}function $n(e){if(!yt(e)||Qt(e)!=Re)return!1;var i=Cs(e);if(i===null)return!0;var o=Ue.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&Ps.call(o)==Ep}var qa=qr?hr(qr):Sd;function O0(e){return Sh(e)&&e>=-V&&e<=V}var Rh=vn?hr(vn):Pd;function no(e){return typeof e=="string"||!_e(e)&&yt(e)&&Qt(e)==Qe}function fr(e){return typeof e=="symbol"||yt(e)&&Qt(e)==Ye}var on=Ri?hr(Ri):Od;function R0(e){return e===t}function T0(e){return yt(e)&&Vt(e)==ze}function C0(e){return yt(e)&&Qt(e)==Xe}var A0=Ws(fa),$0=Ws(function(e,i){return e<=i});function Th(e){if(!e)return[];if(nr(e))return no(e)?Tr(e):ir(e);if(mn&&e[mn])return hp(e[mn]());var i=Vt(e),o=i==we?Zo:i==Le?xs:an;return o(e)}function ei(e){if(!e)return e===0?e:0;if(e=xr(e),e===oe||e===-oe){var i=e<0?-1:1;return i*G}return e===e?e:0}function me(e){var i=ei(e),o=i%1;return i===i?o?i-o:i:0}function Ch(e){return e?$i(me(e),0,W):0}function xr(e){if(typeof e=="number")return e;if(fr(e))return k;if(at(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=at(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=Jc(e);var o=Ro.test(e);return o||Co.test(e)?ve(e.slice(2),o?2:8):Oo.test(e)?k:+e}function Ah(e){return Ur(e,sr(e))}function N0(e){return e?$i(me(e),-V,V):e===0?e:0}function qe(e){return e==null?"":lr(e)}var D0=rn(function(e,i){if(Cn(i)||nr(i)){Ur(i,Mt(i),e);return}for(var o in i)Ue.call(i,o)&&In(e,o,i[o])}),$h=rn(function(e,i){Ur(i,sr(i),e)}),so=rn(function(e,i,o,u){Ur(i,sr(i),e,u)}),F0=rn(function(e,i,o,u){Ur(i,Mt(i),e,u)}),j0=Yr(sa);function L0(e,i){var o=tn(e);return i==null?o:hu(o,i)}var q0=Se(function(e,i){e=We(e);var o=-1,u=i.length,f=u>2?i[2]:t;for(f&&Yt(i[0],i[1],f)&&(u=1);++o<u;)for(var g=i[o],m=sr(g),b=-1,P=m.length;++b<P;){var q=m[b],M=e[q];(M===t||Ar(M,Xi[q])&&!Ue.call(e,q))&&(e[q]=g[q])}return e}),M0=Se(function(e){return e.push(t,Ju),qt(Nh,t,e)});function U0(e,i){return Vc(e,se(i,3),Mr)}function z0(e,i){return Vc(e,se(i,3),aa)}function H0(e,i){return e==null?e:oa(e,se(i,3),sr)}function B0(e,i){return e==null?e:gu(e,se(i,3),sr)}function k0(e,i){return e&&Mr(e,se(i,3))}function V0(e,i){return e&&aa(e,se(i,3))}function K0(e){return e==null?[]:Us(e,Mt(e))}function G0(e){return e==null?[]:Us(e,sr(e))}function Ma(e,i,o){var u=e==null?t:Ni(e,i);return u===t?o:u}function W0(e,i){return e!=null&&Xu(e,i,vd)}function Ua(e,i){return e!=null&&Xu(e,i,_d)}var J0=ku(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=Os.call(i)),e[i]=o},Ha(or)),Q0=ku(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=Os.call(i)),Ue.call(e,i)?e[i].push(o):e[i]=[o]},se),Y0=Se(Pn);function Mt(e){return nr(e)?cu(e):la(e)}function sr(e){return nr(e)?cu(e,!0):Rd(e)}function X0(e,i){var o={};return i=se(i,3),Mr(e,function(u,f,g){Jr(o,i(u,f,g),u)}),o}function Z0(e,i){var o={};return i=se(i,3),Mr(e,function(u,f,g){Jr(o,f,i(u,f,g))}),o}var ev=rn(function(e,i,o){zs(e,i,o)}),Nh=rn(function(e,i,o,u){zs(e,i,o,u)}),tv=Yr(function(e,i){var o={};if(e==null)return o;var u=!1;i=it(i,function(g){return g=gi(g,e),u||(u=g.length>1),g}),Ur(e,Sa(e),o),u&&(o=wr(o,L|R|F,Jd));for(var f=i.length;f--;)va(o,i[f]);return o});function rv(e,i){return Dh(e,ro(se(i)))}var iv=Yr(function(e,i){return e==null?{}:Cd(e,i)});function Dh(e,i){if(e==null)return{};var o=it(Sa(e),function(u){return[u]});return i=se(i),Su(e,o,function(u,f){return i(u,f[0])})}function nv(e,i,o){i=gi(i,e);var u=-1,f=i.length;for(f||(f=1,e=t);++u<f;){var g=e==null?t:e[zr(i[u])];g===t&&(u=f,g=o),e=Zr(g)?g.call(e):g}return e}function sv(e,i,o){return e==null?e:Rn(e,i,o)}function ov(e,i,o,u){return u=typeof u=="function"?u:t,e==null?e:Rn(e,i,o,u)}var Fh=Gu(Mt),jh=Gu(sr);function av(e,i,o){var u=_e(e),f=u||vi(e)||on(e);if(i=se(i,4),o==null){var g=e&&e.constructor;f?o=u?new g:[]:at(e)?o=Zr(g)?tn(Cs(e)):{}:o={}}return(f?vr:Mr)(e,function(m,b,P){return i(o,m,b,P)}),o}function cv(e,i){return e==null?!0:va(e,i)}function uv(e,i,o){return e==null?e:Cu(e,i,wa(o))}function hv(e,i,o,u){return u=typeof u=="function"?u:t,e==null?e:Cu(e,i,wa(o),u)}function an(e){return e==null?[]:Xo(e,Mt(e))}function lv(e){return e==null?[]:Xo(e,sr(e))}function fv(e,i,o){return o===t&&(o=i,i=t),o!==t&&(o=xr(o),o=o===o?o:0),i!==t&&(i=xr(i),i=i===i?i:0),$i(xr(e),i,o)}function pv(e,i,o){return i=ei(i),o===t?(o=i,i=0):o=ei(o),e=xr(e),md(e,i,o)}function dv(e,i,o){if(o&&typeof o!="boolean"&&Yt(e,i,o)&&(i=o=t),o===t&&(typeof i=="boolean"?(o=i,i=t):typeof e=="boolean"&&(o=e,e=t)),e===t&&i===t?(e=0,i=1):(e=ei(e),i===t?(i=e,e=0):i=ei(i)),e>i){var u=e;e=i,i=u}if(o||e%1||i%1){var f=ou();return kt(e+f*(i-e+Ke("1e-"+((f+"").length-1))),i)}return da(e,i)}var gv=nn(function(e,i,o){return i=i.toLowerCase(),e+(o?Lh(i):i)});function Lh(e){return za(qe(e).toLowerCase())}function qh(e){return e=qe(e),e&&e.replace(Vr,sp).replace(Bo,"")}function yv(e,i,o){e=qe(e),i=lr(i);var u=e.length;o=o===t?u:$i(me(o),0,u);var f=o;return o-=i.length,o>=0&&e.slice(o,f)==i}function vv(e){return e=qe(e),e&&tt.test(e)?e.replace(xi,op):e}function _v(e){return e=qe(e),e&&Rt.test(e)?e.replace(pt,"\\$&"):e}var mv=nn(function(e,i,o){return e+(o?"-":"")+i.toLowerCase()}),wv=nn(function(e,i,o){return e+(o?" ":"")+i.toLowerCase()}),bv=zu("toLowerCase");function Ev(e,i,o){e=qe(e),i=me(i);var u=i?Qi(e):0;if(!i||u>=i)return e;var f=(i-u)/2;return Gs(Ds(f),o)+e+Gs(Ns(f),o)}function xv(e,i,o){e=qe(e),i=me(i);var u=i?Qi(e):0;return i&&u<i?e+Gs(i-u,o):e}function Iv(e,i,o){e=qe(e),i=me(i);var u=i?Qi(e):0;return i&&u<i?Gs(i-u,o)+e:e}function Sv(e,i,o){return o||i==null?i=0:i&&(i=+i),$p(qe(e).replace(dt,""),i||0)}function Pv(e,i,o){return(o?Yt(e,i,o):i===t)?i=1:i=me(i),ga(qe(e),i)}function Ov(){var e=arguments,i=qe(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var Rv=nn(function(e,i,o){return e+(o?"_":"")+i.toLowerCase()});function Tv(e,i,o){return o&&typeof o!="number"&&Yt(e,i,o)&&(i=o=t),o=o===t?W:o>>>0,o?(e=qe(e),e&&(typeof i=="string"||i!=null&&!qa(i))&&(i=lr(i),!i&&Ji(e))?yi(Tr(e),0,o):e.split(i,o)):[]}var Cv=nn(function(e,i,o){return e+(o?" ":"")+za(i)});function Av(e,i,o){return e=qe(e),o=o==null?0:$i(me(o),0,e.length),i=lr(i),e.slice(o,o+i.length)==i}function $v(e,i,o){var u=p.templateSettings;o&&Yt(e,i,o)&&(i=t),e=qe(e),i=so({},i,u,Wu);var f=so({},i.imports,u.imports,Wu),g=Mt(f),m=Xo(f,g),b,P,q=0,M=i.interpolate||zi,B="__p += '",J=ea((i.escape||zi).source+"|"+M.source+"|"+(M===ot?Po:zi).source+"|"+(i.evaluate||zi).source+"|$","g"),re="//# sourceURL="+(Ue.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ko+"]")+`
`;e.replace(J,function(ce,Pe,Ae,pr,Xt,dr){return Ae||(Ae=pr),B+=e.slice(q,dr).replace($o,ap),Pe&&(b=!0,B+=`' +
__e(`+Pe+`) +
'`),Xt&&(P=!0,B+=`';
`+Xt+`;
__p += '`),Ae&&(B+=`' +
((__t = (`+Ae+`)) == null ? '' : __t) +
'`),q=dr+ce.length,ce}),B+=`';
`;var ae=Ue.call(i,"variable")&&i.variable;if(!ae)B=`with (obj) {
`+B+`
}
`;else if(Io.test(ae))throw new de(d);B=(P?B.replace(jr,""):B).replace(Wt,"$1").replace(kr,"$1;"),B="function("+(ae||"obj")+`) {
`+(ae?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(b?", __e = _.escape":"")+(P?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+B+`return __p
}`;var be=Uh(function(){return je(g,re+"return "+B).apply(t,m)});if(be.source=B,La(be))throw be;return be}function Nv(e){return qe(e).toLowerCase()}function Dv(e){return qe(e).toUpperCase()}function Fv(e,i,o){if(e=qe(e),e&&(o||i===t))return Jc(e);if(!e||!(i=lr(i)))return e;var u=Tr(e),f=Tr(i),g=Qc(u,f),m=Yc(u,f)+1;return yi(u,g,m).join("")}function jv(e,i,o){if(e=qe(e),e&&(o||i===t))return e.slice(0,Zc(e)+1);if(!e||!(i=lr(i)))return e;var u=Tr(e),f=Yc(u,Tr(i))+1;return yi(u,0,f).join("")}function Lv(e,i,o){if(e=qe(e),e&&(o||i===t))return e.replace(dt,"");if(!e||!(i=lr(i)))return e;var u=Tr(e),f=Qc(u,Tr(i));return yi(u,f).join("")}function qv(e,i){var o=Z,u=xe;if(at(i)){var f="separator"in i?i.separator:f;o="length"in i?me(i.length):o,u="omission"in i?lr(i.omission):u}e=qe(e);var g=e.length;if(Ji(e)){var m=Tr(e);g=m.length}if(o>=g)return e;var b=o-Qi(u);if(b<1)return u;var P=m?yi(m,0,b).join(""):e.slice(0,b);if(f===t)return P+u;if(m&&(b+=P.length-b),qa(f)){if(e.slice(b).search(f)){var q,M=P;for(f.global||(f=ea(f.source,qe(gr.exec(f))+"g")),f.lastIndex=0;q=f.exec(M);)var B=q.index;P=P.slice(0,B===t?b:B)}}else if(e.indexOf(lr(f),b)!=b){var J=P.lastIndexOf(f);J>-1&&(P=P.slice(0,J))}return P+u}function Mv(e){return e=qe(e),e&&ht.test(e)?e.replace(ai,dp):e}var Uv=nn(function(e,i,o){return e+(o?" ":"")+i.toUpperCase()}),za=zu("toUpperCase");function Mh(e,i,o){return e=qe(e),i=o?t:i,i===t?up(e)?vp(e):ep(e):e.match(i)||[]}var Uh=Se(function(e,i){try{return qt(e,t,i)}catch(o){return La(o)?o:new de(o)}}),zv=Yr(function(e,i){return vr(i,function(o){o=zr(o),Jr(e,o,Fa(e[o],e))}),e});function Hv(e){var i=e==null?0:e.length,o=se();return e=i?it(e,function(u){if(typeof u[1]!="function")throw new _r(l);return[o(u[0]),u[1]]}):[],Se(function(u){for(var f=-1;++f<i;){var g=e[f];if(qt(g[0],this,u))return qt(g[1],this,u)}})}function Bv(e){return dd(wr(e,L))}function Ha(e){return function(){return e}}function kv(e,i){return e==null||e!==e?i:e}var Vv=Bu(),Kv=Bu(!0);function or(e){return e}function Ba(e){return mu(typeof e=="function"?e:wr(e,L))}function Gv(e){return bu(wr(e,L))}function Wv(e,i){return Eu(e,wr(i,L))}var Jv=Se(function(e,i){return function(o){return Pn(o,e,i)}}),Qv=Se(function(e,i){return function(o){return Pn(e,o,i)}});function ka(e,i,o){var u=Mt(i),f=Us(i,u);o==null&&!(at(i)&&(f.length||!u.length))&&(o=i,i=e,e=this,f=Us(i,Mt(i)));var g=!(at(o)&&"chain"in o)||!!o.chain,m=Zr(e);return vr(f,function(b){var P=i[b];e[b]=P,m&&(e.prototype[b]=function(){var q=this.__chain__;if(g||q){var M=e(this.__wrapped__),B=M.__actions__=ir(this.__actions__);return B.push({func:P,args:arguments,thisArg:e}),M.__chain__=q,M}return P.apply(e,hi([this.value()],arguments))})}),e}function Yv(){return Ce._===this&&(Ce._=xp),this}function Va(){}function Xv(e){return e=me(e),Se(function(i){return xu(i,e)})}var Zv=Ea(it),e_=Ea(kc),t_=Ea(Go);function zh(e){return Ta(e)?Wo(zr(e)):Ad(e)}function r_(e){return function(i){return e==null?t:Ni(e,i)}}var i_=Vu(),n_=Vu(!0);function Ka(){return[]}function Ga(){return!1}function s_(){return{}}function o_(){return""}function a_(){return!0}function c_(e,i){if(e=me(e),e<1||e>V)return[];var o=W,u=kt(e,W);i=se(i),e-=W;for(var f=Yo(u,i);++o<e;)i(o);return f}function u_(e){return _e(e)?it(e,zr):fr(e)?[e]:ir(ah(qe(e)))}function h_(e){var i=++bp;return qe(e)+i}var l_=Ks(function(e,i){return e+i},0),f_=xa("ceil"),p_=Ks(function(e,i){return e/i},1),d_=xa("floor");function g_(e){return e&&e.length?Ms(e,or,ca):t}function y_(e,i){return e&&e.length?Ms(e,se(i,2),ca):t}function v_(e){return Gc(e,or)}function __(e,i){return Gc(e,se(i,2))}function m_(e){return e&&e.length?Ms(e,or,fa):t}function w_(e,i){return e&&e.length?Ms(e,se(i,2),fa):t}var b_=Ks(function(e,i){return e*i},1),E_=xa("round"),x_=Ks(function(e,i){return e-i},0);function I_(e){return e&&e.length?Qo(e,or):0}function S_(e,i){return e&&e.length?Qo(e,se(i,2)):0}return p.after=Gy,p.ary=_h,p.assign=D0,p.assignIn=$h,p.assignInWith=so,p.assignWith=F0,p.at=j0,p.before=mh,p.bind=Fa,p.bindAll=zv,p.bindKey=wh,p.castArray=s0,p.chain=gh,p.chunk=dg,p.compact=gg,p.concat=yg,p.cond=Hv,p.conforms=Bv,p.constant=Ha,p.countBy=Iy,p.create=L0,p.curry=bh,p.curryRight=Eh,p.debounce=xh,p.defaults=q0,p.defaultsDeep=M0,p.defer=Wy,p.delay=Jy,p.difference=vg,p.differenceBy=_g,p.differenceWith=mg,p.drop=wg,p.dropRight=bg,p.dropRightWhile=Eg,p.dropWhile=xg,p.fill=Ig,p.filter=Py,p.flatMap=Ty,p.flatMapDeep=Cy,p.flatMapDepth=Ay,p.flatten=lh,p.flattenDeep=Sg,p.flattenDepth=Pg,p.flip=Qy,p.flow=Vv,p.flowRight=Kv,p.fromPairs=Og,p.functions=K0,p.functionsIn=G0,p.groupBy=$y,p.initial=Tg,p.intersection=Cg,p.intersectionBy=Ag,p.intersectionWith=$g,p.invert=J0,p.invertBy=Q0,p.invokeMap=Dy,p.iteratee=Ba,p.keyBy=Fy,p.keys=Mt,p.keysIn=sr,p.map=Zs,p.mapKeys=X0,p.mapValues=Z0,p.matches=Gv,p.matchesProperty=Wv,p.memoize=to,p.merge=ev,p.mergeWith=Nh,p.method=Jv,p.methodOf=Qv,p.mixin=ka,p.negate=ro,p.nthArg=Xv,p.omit=tv,p.omitBy=rv,p.once=Yy,p.orderBy=jy,p.over=Zv,p.overArgs=Xy,p.overEvery=e_,p.overSome=t_,p.partial=ja,p.partialRight=Ih,p.partition=Ly,p.pick=iv,p.pickBy=Dh,p.property=zh,p.propertyOf=r_,p.pull=jg,p.pullAll=ph,p.pullAllBy=Lg,p.pullAllWith=qg,p.pullAt=Mg,p.range=i_,p.rangeRight=n_,p.rearg=Zy,p.reject=Uy,p.remove=Ug,p.rest=e0,p.reverse=Na,p.sampleSize=Hy,p.set=sv,p.setWith=ov,p.shuffle=By,p.slice=zg,p.sortBy=Ky,p.sortedUniq=Wg,p.sortedUniqBy=Jg,p.split=Tv,p.spread=t0,p.tail=Qg,p.take=Yg,p.takeRight=Xg,p.takeRightWhile=Zg,p.takeWhile=ey,p.tap=gy,p.throttle=r0,p.thru=Xs,p.toArray=Th,p.toPairs=Fh,p.toPairsIn=jh,p.toPath=u_,p.toPlainObject=Ah,p.transform=av,p.unary=i0,p.union=ty,p.unionBy=ry,p.unionWith=iy,p.uniq=ny,p.uniqBy=sy,p.uniqWith=oy,p.unset=cv,p.unzip=Da,p.unzipWith=dh,p.update=uv,p.updateWith=hv,p.values=an,p.valuesIn=lv,p.without=ay,p.words=Mh,p.wrap=n0,p.xor=cy,p.xorBy=uy,p.xorWith=hy,p.zip=ly,p.zipObject=fy,p.zipObjectDeep=py,p.zipWith=dy,p.entries=Fh,p.entriesIn=jh,p.extend=$h,p.extendWith=so,ka(p,p),p.add=l_,p.attempt=Uh,p.camelCase=gv,p.capitalize=Lh,p.ceil=f_,p.clamp=fv,p.clone=o0,p.cloneDeep=c0,p.cloneDeepWith=u0,p.cloneWith=a0,p.conformsTo=h0,p.deburr=qh,p.defaultTo=kv,p.divide=p_,p.endsWith=yv,p.eq=Ar,p.escape=vv,p.escapeRegExp=_v,p.every=Sy,p.find=Oy,p.findIndex=uh,p.findKey=U0,p.findLast=Ry,p.findLastIndex=hh,p.findLastKey=z0,p.floor=d_,p.forEach=yh,p.forEachRight=vh,p.forIn=H0,p.forInRight=B0,p.forOwn=k0,p.forOwnRight=V0,p.get=Ma,p.gt=l0,p.gte=f0,p.has=W0,p.hasIn=Ua,p.head=fh,p.identity=or,p.includes=Ny,p.indexOf=Rg,p.inRange=pv,p.invoke=Y0,p.isArguments=ji,p.isArray=_e,p.isArrayBuffer=p0,p.isArrayLike=nr,p.isArrayLikeObject=wt,p.isBoolean=d0,p.isBuffer=vi,p.isDate=g0,p.isElement=y0,p.isEmpty=v0,p.isEqual=_0,p.isEqualWith=m0,p.isError=La,p.isFinite=w0,p.isFunction=Zr,p.isInteger=Sh,p.isLength=io,p.isMap=Ph,p.isMatch=b0,p.isMatchWith=E0,p.isNaN=x0,p.isNative=I0,p.isNil=P0,p.isNull=S0,p.isNumber=Oh,p.isObject=at,p.isObjectLike=yt,p.isPlainObject=$n,p.isRegExp=qa,p.isSafeInteger=O0,p.isSet=Rh,p.isString=no,p.isSymbol=fr,p.isTypedArray=on,p.isUndefined=R0,p.isWeakMap=T0,p.isWeakSet=C0,p.join=Ng,p.kebabCase=mv,p.last=Er,p.lastIndexOf=Dg,p.lowerCase=wv,p.lowerFirst=bv,p.lt=A0,p.lte=$0,p.max=g_,p.maxBy=y_,p.mean=v_,p.meanBy=__,p.min=m_,p.minBy=w_,p.stubArray=Ka,p.stubFalse=Ga,p.stubObject=s_,p.stubString=o_,p.stubTrue=a_,p.multiply=b_,p.nth=Fg,p.noConflict=Yv,p.noop=Va,p.now=eo,p.pad=Ev,p.padEnd=xv,p.padStart=Iv,p.parseInt=Sv,p.random=dv,p.reduce=qy,p.reduceRight=My,p.repeat=Pv,p.replace=Ov,p.result=nv,p.round=E_,p.runInContext=I,p.sample=zy,p.size=ky,p.snakeCase=Rv,p.some=Vy,p.sortedIndex=Hg,p.sortedIndexBy=Bg,p.sortedIndexOf=kg,p.sortedLastIndex=Vg,p.sortedLastIndexBy=Kg,p.sortedLastIndexOf=Gg,p.startCase=Cv,p.startsWith=Av,p.subtract=x_,p.sum=I_,p.sumBy=S_,p.template=$v,p.times=c_,p.toFinite=ei,p.toInteger=me,p.toLength=Ch,p.toLower=Nv,p.toNumber=xr,p.toSafeInteger=N0,p.toString=qe,p.toUpper=Dv,p.trim=Fv,p.trimEnd=jv,p.trimStart=Lv,p.truncate=qv,p.unescape=Mv,p.uniqueId=h_,p.upperCase=Uv,p.upperFirst=za,p.each=yh,p.eachRight=vh,p.first=fh,ka(p,function(){var e={};return Mr(p,function(i,o){Ue.call(p.prototype,o)||(e[o]=i)}),e}(),{chain:!1}),p.VERSION=n,vr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){p[e].placeholder=p}),vr(["drop","take"],function(e,i){Te.prototype[e]=function(o){o=o===t?1:jt(me(o),0);var u=this.__filtered__&&!i?new Te(this):this.clone();return u.__filtered__?u.__takeCount__=kt(o,u.__takeCount__):u.__views__.push({size:kt(o,W),type:e+(u.__dir__<0?"Right":"")}),u},Te.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),vr(["filter","map","takeWhile"],function(e,i){var o=i+1,u=o==w||o==pe;Te.prototype[e]=function(f){var g=this.clone();return g.__iteratees__.push({iteratee:se(f,3),type:o}),g.__filtered__=g.__filtered__||u,g}}),vr(["head","last"],function(e,i){var o="take"+(i?"Right":"");Te.prototype[e]=function(){return this[o](1).value()[0]}}),vr(["initial","tail"],function(e,i){var o="drop"+(i?"":"Right");Te.prototype[e]=function(){return this.__filtered__?new Te(this):this[o](1)}}),Te.prototype.compact=function(){return this.filter(or)},Te.prototype.find=function(e){return this.filter(e).head()},Te.prototype.findLast=function(e){return this.reverse().find(e)},Te.prototype.invokeMap=Se(function(e,i){return typeof e=="function"?new Te(this):this.map(function(o){return Pn(o,e,i)})}),Te.prototype.reject=function(e){return this.filter(ro(se(e)))},Te.prototype.slice=function(e,i){e=me(e);var o=this;return o.__filtered__&&(e>0||i<0)?new Te(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),i!==t&&(i=me(i),o=i<0?o.dropRight(-i):o.take(i-e)),o)},Te.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Te.prototype.toArray=function(){return this.take(W)},Mr(Te.prototype,function(e,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),u=/^(?:head|last)$/.test(i),f=p[u?"take"+(i=="last"?"Right":""):i],g=u||/^find/.test(i);f&&(p.prototype[i]=function(){var m=this.__wrapped__,b=u?[1]:arguments,P=m instanceof Te,q=b[0],M=P||_e(m),B=function(Pe){var Ae=f.apply(p,hi([Pe],b));return u&&J?Ae[0]:Ae};M&&o&&typeof q=="function"&&q.length!=1&&(P=M=!1);var J=this.__chain__,re=!!this.__actions__.length,ae=g&&!J,be=P&&!re;if(!g&&M){m=be?m:new Te(this);var ce=e.apply(m,b);return ce.__actions__.push({func:Xs,args:[B],thisArg:t}),new mr(ce,J)}return ae&&be?e.apply(this,b):(ce=this.thru(B),ae?u?ce.value()[0]:ce.value():ce)})}),vr(["pop","push","shift","sort","splice","unshift"],function(e){var i=Is[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",u=/^(?:pop|shift)$/.test(e);p.prototype[e]=function(){var f=arguments;if(u&&!this.__chain__){var g=this.value();return i.apply(_e(g)?g:[],f)}return this[o](function(m){return i.apply(_e(m)?m:[],f)})}}),Mr(Te.prototype,function(e,i){var o=p[i];if(o){var u=o.name+"";Ue.call(en,u)||(en[u]=[]),en[u].push({name:i,func:o})}}),en[Vs(t,Ee).name]=[{name:"wrapper",func:t}],Te.prototype.clone=Mp,Te.prototype.reverse=Up,Te.prototype.value=zp,p.prototype.at=yy,p.prototype.chain=vy,p.prototype.commit=_y,p.prototype.next=my,p.prototype.plant=by,p.prototype.reverse=Ey,p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=xy,p.prototype.first=p.prototype.head,mn&&(p.prototype[mn]=wy),p},Yi=_p();mt?((mt.exports=Yi)._=Yi,Ge._=Yi):Ce._=Yi}).call(Hn)})(Oc,Oc.exports);var Kx=Object.defineProperty,Gx=Object.defineProperties,Wx=Object.getOwnPropertyDescriptors,kl=Object.getOwnPropertySymbols,Jx=Object.prototype.hasOwnProperty,Qx=Object.prototype.propertyIsEnumerable,Vl=(a,r,t)=>r in a?Kx(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,co=(a,r)=>{for(var t in r||(r={}))Jx.call(r,t)&&Vl(a,t,r[t]);if(kl)for(var t of kl(r))Qx.call(r,t)&&Vl(a,t,r[t]);return a},Yx=(a,r)=>Gx(a,Wx(r));function Sr(a,r,t){let n;const s=Rc(a);return r.rpcMap&&(n=r.rpcMap[s]),n||(n=`${Vx}?chainId=eip155:${s}&projectId=${t}`),n}function Rc(a){return a.includes("eip155")?Number(a.split(":")[1]):Number(a)}function Gf(a){return a.map(r=>`${r.split(":")[0]}:${r.split(":")[1]}`)}function Xx(a,r){const t=Object.keys(r.namespaces).filter(s=>s.includes(a));if(!t.length)return[];const n=[];return t.forEach(s=>{const c=r.namespaces[s].accounts;n.push(...c)}),n}function Zx(a={},r={}){const t=Kl(a),n=Kl(r);return Oc.exports.merge(t,n)}function Kl(a){var r,t,n,s;const c={};if(!lo(a))return c;for(const[l,d]of Object.entries(a)){const _=af(l)?[l]:d.chains,y=d.methods||[],S=d.events||[],L=d.rpcMap||{},R=Bn(l);c[R]=Yx(co(co({},c[R]),d),{chains:Ja(_,(r=c[R])==null?void 0:r.chains),methods:Ja(y,(t=c[R])==null?void 0:t.methods),events:Ja(S,(n=c[R])==null?void 0:n.events),rpcMap:co(co({},L),(s=c[R])==null?void 0:s.rpcMap)})}return c}function eI(a){return a.includes(":")?a.split(":")[2]:a}function tI(a){const r={};for(const[t,n]of Object.entries(a)){const s=n.methods||[],c=n.events||[],l=n.accounts||[],d=af(t)?[t]:n.chains?n.chains:Gf(n.accounts);r[t]={chains:d,methods:s,events:c,accounts:l}}return r}function oc(a){return typeof a=="number"?a:a.includes("0x")?parseInt(a,16):a.includes(":")?Number(a.split(":")[1]):Number(a)}const Wf={},Et=a=>Wf[a],ac=(a,r)=>{Wf[a]=r};class rI{constructor(r){this.name="polkadot",this.namespace=r.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){if(this.chainId=r,!this.httpProviders[r]){const n=t||Sr(`${this.name}:${r}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;r[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Sr(r,this.namespace);return typeof n>"u"?void 0:new bi(new Ui(n,Et("disableProviderPing")))}}class iI{constructor(r){this.name="eip155",this.namespace=r.namespace,this.events=Et("events"),this.client=Et("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(r){switch(r.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(r);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(r.request.method)?await this.client.request(r):this.getHttpProvider().request(r.request)}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}setDefaultChain(r,t){const n=Rc(r);if(!this.httpProviders[n]){const s=t||Sr(`${this.name}:${n}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${n}`);this.setHttpProvider(n,s)}this.chainId=n,this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}createHttpProvider(r,t){const n=t||Sr(`${this.name}:${r}`,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new bi(new Ui(n,Et("disableProviderPing")))}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;const s=Rc(t);r[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const r=this.chainId,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}async handleSwitchChain(r){var t,n;let s=r.request.params?(t=r.request.params[0])==null?void 0:t.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const c=parseInt(s,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:r.topic,request:{method:r.request.method,params:[{chainId:s}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(r){return this.namespace.chains.includes(`${this.name}:${r}`)}}class nI{constructor(r){this.name="solana",this.namespace=r.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){if(!this.httpProviders[r]){const n=t||Sr(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;r[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Sr(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new bi(new Ui(n,Et("disableProviderPing")))}}class sI{constructor(r){this.name="cosmos",this.namespace=r.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){if(this.chainId=r,!this.httpProviders[r]){const n=t||Sr(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;r[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Sr(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new bi(new Ui(n,Et("disableProviderPing")))}}class oI{constructor(r){this.name="cip34",this.namespace=r.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){if(this.chainId=r,!this.httpProviders[r]){const n=t||this.getCardanoRPCUrl(r);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{const n=this.getCardanoRPCUrl(t);r[t]=this.createHttpProvider(t,n)}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}getCardanoRPCUrl(r){const t=this.namespace.rpcMap;if(t)return t[r]}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||this.getCardanoRPCUrl(r);return typeof n>"u"?void 0:new bi(new Ui(n,Et("disableProviderPing")))}}class aI{constructor(r){this.name="elrond",this.namespace=r.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){if(!this.httpProviders[r]){const n=t||Sr(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;r[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Sr(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new bi(new Ui(n,Et("disableProviderPing")))}}class cI{constructor(r){this.name="multiversx",this.namespace=r.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){if(!this.httpProviders[r]){const n=t||Sr(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;r[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Sr(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new bi(new Ui(n,Et("disableProviderPing")))}}var uI=Object.defineProperty,hI=Object.defineProperties,lI=Object.getOwnPropertyDescriptors,Gl=Object.getOwnPropertySymbols,fI=Object.prototype.hasOwnProperty,pI=Object.prototype.propertyIsEnumerable,Wl=(a,r,t)=>r in a?uI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,uo=(a,r)=>{for(var t in r||(r={}))fI.call(r,t)&&Wl(a,t,r[t]);if(Gl)for(var t of Gl(r))pI.call(r,t)&&Wl(a,t,r[t]);return a},cc=(a,r)=>hI(a,lI(r));class Hc{constructor(r){this.events=new $c,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=r,this.logger=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:$e.pino($e.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||Hl})),this.disableProviderPing=(r==null?void 0:r.disableProviderPing)||!1}static async init(r){const t=new Hc(r);return await t.initialize(),t}async request(r,t){const[n,s]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:uo({},r),chainId:`${n}:${s}`,topic:this.session.topic})}sendAsync(r,t,n){this.request(r,n).then(s=>t(null,s)).catch(s=>t(s,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var r;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(r=this.session)==null?void 0:r.topic,reason:er("USER_DISCONNECTED")}),await this.cleanup()}async connect(r){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(r),await this.cleanupPendingPairings(),!r.skipPairing)return await this.pair(r.pairingTopic)}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}removeListener(r,t){this.events.removeListener(r,t)}off(r,t){this.events.off(r,t)}get isWalletConnect(){return!0}async pair(r){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:s}=await this.client.connect({pairingTopic:r,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await s().then(c=>{this.session=c,this.namespaces||(this.namespaces=tI(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==Vf)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(r,t){try{if(!this.session)return;const[n,s]=this.validateChain(r);this.getProvider(n).setDefaultChain(s,t)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(r={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(fn(t)){for(const n of t)r.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const r=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[r]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await qx.init({logger:this.providerOpts.logger||Hl,relayUrl:this.providerOpts.relayUrl||Hx,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const r=[...new Set(Object.keys(this.session.namespaces).map(t=>Bn(t)))];ac("client",this.client),ac("events",this.events),ac("disableProviderPing",this.disableProviderPing),r.forEach(t=>{if(!this.session)return;const n=Xx(t,this.session),s=Gf(n),c=Zx(this.namespaces,this.optionalNamespaces),l=cc(uo({},c[t]),{accounts:n,chains:s});switch(t){case"eip155":this.rpcProviders[t]=new iI({namespace:l});break;case"solana":this.rpcProviders[t]=new nI({namespace:l});break;case"cosmos":this.rpcProviders[t]=new sI({namespace:l});break;case"polkadot":this.rpcProviders[t]=new rI({namespace:l});break;case"cip34":this.rpcProviders[t]=new oI({namespace:l});break;case"elrond":this.rpcProviders[t]=new aI({namespace:l});break;case"multiversx":this.rpcProviders[t]=new cI({namespace:l});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",r=>{this.events.emit("session_ping",r)}),this.client.on("session_event",r=>{const{params:t}=r,{event:n}=t;if(n.name==="accountsChanged"){const s=n.data;s&&fn(s)&&this.events.emit("accountsChanged",s.map(eI))}else if(n.name==="chainChanged"){const s=t.chainId,c=t.event.data,l=Bn(s),d=oc(s)!==oc(c)?`${l}:${oc(c)}`:s;this.onChainChanged(d)}else this.events.emit(n.name,n.data);this.events.emit("session_event",r)}),this.client.on("session_update",({topic:r,params:t})=>{var n;const{namespaces:s}=t,c=(n=this.client)==null?void 0:n.session.get(r);this.session=cc(uo({},c),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:r,params:t})}),this.client.on("session_delete",async r=>{await this.cleanup(),this.events.emit("session_delete",r),this.events.emit("disconnect",cc(uo({},er("USER_DISCONNECTED")),{data:r.topic}))}),this.on(Ei.DEFAULT_CHAIN_CHANGED,r=>{this.onChainChanged(r,!0)})}getProvider(r){if(!this.rpcProviders[r])throw new Error(`Provider not found: ${r}`);return this.rpcProviders[r]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(r=>{var t;this.getProvider(r).updateNamespace((t=this.session)==null?void 0:t.namespaces[r])})}setNamespaces(r){const{namespaces:t,optionalNamespaces:n,sessionProperties:s}=r;t&&Object.keys(t).length&&(this.namespaces=t),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=s,this.persist("namespaces",t),this.persist("optionalNamespaces",n)}validateChain(r){const[t,n]=(r==null?void 0:r.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,n];if(t&&!Object.keys(this.namespaces||{}).map(l=>Bn(l)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&n)return[t,n];const s=Bn(Object.keys(this.namespaces)[0]),c=this.rpcProviders[s].getDefaultChain();return[s,c]}async requestAccounts(){const[r]=this.validateChain();return await this.getProvider(r).requestAccounts()}onChainChanged(r,t=!1){var n;if(!this.namespaces)return;const[s,c]=this.validateChain(r);t||this.getProvider(s).setDefaultChain(c),((n=this.namespaces[s])!=null?n:this.namespaces[`${s}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(r,t){this.client.core.storage.setItem(`${Bl}/${r}`,t)}async getFromStore(r){return await this.client.core.storage.getItem(`${Bl}/${r}`)}}const dI=Hc,gI="wc",yI="ethereum_provider",vI=`${gI}@2:${yI}:`,_I="https://rpc.walletconnect.com/v1/",Tc=["eth_sendTransaction","personal_sign"],mI=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Cc=["chainChanged","accountsChanged"],wI=["message","disconnect","connect"];var bI=Object.defineProperty,EI=Object.defineProperties,xI=Object.getOwnPropertyDescriptors,Jl=Object.getOwnPropertySymbols,II=Object.prototype.hasOwnProperty,SI=Object.prototype.propertyIsEnumerable,Ql=(a,r,t)=>r in a?bI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,kn=(a,r)=>{for(var t in r||(r={}))II.call(r,t)&&Ql(a,t,r[t]);if(Jl)for(var t of Jl(r))SI.call(r,t)&&Ql(a,t,r[t]);return a},Yl=(a,r)=>EI(a,xI(r));function yo(a){return Number(a[0].split(":")[1])}function uc(a){return`0x${a.toString(16)}`}function PI(a){const{chains:r,optionalChains:t,methods:n,optionalMethods:s,events:c,optionalEvents:l,rpcMap:d}=a;if(!fn(r))throw new Error("Invalid chains");const _={chains:r,methods:n||Tc,events:c||Cc,rpcMap:kn({},r.length?{[yo(r)]:d[yo(r)]}:{})},y=c==null?void 0:c.filter(F=>!Cc.includes(F)),S=n==null?void 0:n.filter(F=>!Tc.includes(F));if(!t&&!l&&!s&&!(y!=null&&y.length)&&!(S!=null&&S.length))return{required:r.length?_:void 0};const L=(y==null?void 0:y.length)&&(S==null?void 0:S.length)||!t,R={chains:[...new Set(L?_.chains.concat(t||[]):t)],methods:[...new Set(_.methods.concat(s!=null&&s.length?s:mI))],events:[...new Set(_.events.concat(l||wI))],rpcMap:d};return{required:r.length?_:void 0,optional:t.length?R:void 0}}class Bc{constructor(){this.events=new Pr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=vI,this.on=(r,t)=>(this.events.on(r,t),this),this.once=(r,t)=>(this.events.once(r,t),this),this.removeListener=(r,t)=>(this.events.removeListener(r,t),this),this.off=(r,t)=>(this.events.off(r,t),this),this.parseAccount=r=>this.isCompatibleChainId(r)?this.parseAccountId(r).address:r,this.signer={},this.rpc={}}static async init(r){const t=new Bc;return await t.initialize(r),t}async request(r){return await this.signer.request(r,this.formatChainId(this.chainId))}sendAsync(r,t){this.signer.sendAsync(r,t,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(r){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(r);const{required:t,optional:n}=PI(this.rpc);try{const s=await new Promise(async(l,d)=>{var _;this.rpc.showQrModal&&((_=this.modal)==null||_.subscribeModal(y=>{!y.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),d(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Yl(kn({namespaces:kn({},t&&{[this.namespace]:t})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:r==null?void 0:r.pairingTopic})).then(y=>{l(y)}).catch(y=>{d(new Error(y.message))})});if(!s)return;const c=hm(s.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:uc(this.chainId)})}catch(s){throw this.signer.logger.error(s),s}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",r=>{const{params:t}=r,{event:n}=t;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",r)}),this.signer.on("chainChanged",r=>{const t=parseInt(r);this.chainId=t,this.events.emit("chainChanged",uc(this.chainId)),this.persist()}),this.signer.on("session_update",r=>{this.events.emit("session_update",r)}),this.signer.on("session_delete",r=>{this.reset(),this.events.emit("session_delete",r),this.events.emit("disconnect",Yl(kn({},er("USER_DISCONNECTED")),{data:r.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",r=>{var t,n;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(n=this.modal)==null||n.openModal({uri:r})),this.events.emit("display_uri",r)})}switchEthereumChain(r){this.request({method:"wallet_switchEthereumChain",params:[{chainId:r.toString(16)}]})}isCompatibleChainId(r){return typeof r=="string"?r.startsWith(`${this.namespace}:`):!1}formatChainId(r){return`${this.namespace}:${r}`}parseChainId(r){return Number(r.split(":")[1])}setChainIds(r){const t=r.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",uc(this.chainId)),this.persist())}setChainId(r){if(this.isCompatibleChainId(r)){const t=this.parseChainId(r);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(r){const[t,n,s]=r.split(":");return{chainId:`${t}:${n}`,address:s}}setAccounts(r){this.accounts=r.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(r){var t,n;const s=(t=r==null?void 0:r.chains)!=null?t:[],c=(n=r==null?void 0:r.optionalChains)!=null?n:[],l=s.concat(c);if(!l.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const d=s.length?(r==null?void 0:r.methods)||Tc:[],_=s.length?(r==null?void 0:r.events)||Cc:[],y=(r==null?void 0:r.optionalMethods)||[],S=(r==null?void 0:r.optionalEvents)||[],L=(r==null?void 0:r.rpcMap)||this.buildRpcMap(l,r.projectId),R=(r==null?void 0:r.qrModalOptions)||void 0;return{chains:s==null?void 0:s.map(F=>this.formatChainId(F)),optionalChains:c.map(F=>this.formatChainId(F)),methods:d,events:_,optionalMethods:y,optionalEvents:S,rpcMap:L,showQrModal:!!(r!=null&&r.showQrModal),qrModalOptions:R,projectId:r.projectId,metadata:r.metadata}}buildRpcMap(r,t){const n={};return r.forEach(s=>{n[s]=this.getRpcUrl(s,t)}),n}async initialize(r){if(this.rpc=this.getRpcConfig(r),this.chainId=this.rpc.chains.length?yo(this.rpc.chains):yo(this.rpc.optionalChains),this.signer=await dI.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:r.disableProviderPing,relayUrl:r.relayUrl,storageOptions:r.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:n}=await lm(()=>import("./index-2ef15037.js").then(s=>s.i),["./index-2ef15037.js","./index-618ce91c.js"],import.meta.url);t=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(kn({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(r){if(!r)return;const{chains:t,optionalChains:n,rpcMap:s}=r;t&&fn(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=(s==null?void 0:s[c])||this.getRpcUrl(c)})),n&&fn(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(c=>this.formatChainId(c)),n.forEach(c=>{this.rpc.rpcMap[c]=(s==null?void 0:s[c])||this.getRpcUrl(c)}))}getRpcUrl(r,t){var n;return((n=this.rpc.rpcMap)==null?void 0:n[r])||`${_I}?chainId=eip155:${r}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const r=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${r}`]?this.session.namespaces[`${this.namespace}:${r}`]:this.session.namespaces[this.namespace];this.setChainIds(r?[this.formatChainId(r)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(r){return typeof r=="string"||r instanceof String?[this.parseAccount(r)]:r.map(t=>this.parseAccount(t))}}const LI=Bc;export{LI as EthereumProvider,wI as OPTIONAL_EVENTS,mI as OPTIONAL_METHODS,Cc as REQUIRED_EVENTS,Tc as REQUIRED_METHODS,Bc as default};
